var mr=Object.defineProperty;var wr=(Z,A,k)=>A in Z?mr(Z,A,{enumerable:!0,configurable:!0,writable:!0,value:k}):Z[A]=k;var Tt=(Z,A,k)=>wr(Z,typeof A!="symbol"?A+"":A,k);(function(){const A=document.createElement("link").relList;if(A&&A.supports&&A.supports("modulepreload"))return;for(const q of document.querySelectorAll('link[rel="modulepreload"]'))F(q);new MutationObserver(q=>{for(const P of q)if(P.type==="childList")for(const pt of P.addedNodes)pt.tagName==="LINK"&&pt.rel==="modulepreload"&&F(pt)}).observe(document,{childList:!0,subtree:!0});function k(q){const P={};return q.integrity&&(P.integrity=q.integrity),q.referrerPolicy&&(P.referrerPolicy=q.referrerPolicy),q.crossOrigin==="use-credentials"?P.credentials="include":q.crossOrigin==="anonymous"?P.credentials="omit":P.credentials="same-origin",P}function F(q){if(q.ep)return;q.ep=!0;const P=k(q);fetch(q.href,P)}})();function Sn(Z){return Z&&Z.__esModule&&Object.prototype.hasOwnProperty.call(Z,"default")?Z.default:Z}function yr(Z){if(Object.prototype.hasOwnProperty.call(Z,"__esModule"))return Z;var A=Z.default;if(typeof A=="function"){var k=function F(){return this instanceof F?Reflect.construct(A,arguments,this.constructor):A.apply(this,arguments)};k.prototype=A.prototype}else k={};return Object.defineProperty(k,"__esModule",{value:!0}),Object.keys(Z).forEach(function(F){var q=Object.getOwnPropertyDescriptor(Z,F);Object.defineProperty(k,F,q.get?q:{enumerable:!0,get:function(){return Z[F]}})}),k}function br(Z){throw new Error('Could not dynamically require "'+Z+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var hi={exports:{}};const Sr={},xr=Object.freeze(Object.defineProperty({__proto__:null,default:Sr},Symbol.toStringTag,{value:"Module"})),dn=yr(xr);/*!
 * Paper.js v0.12.18 - The Swiss Army Knife of Vector Graphics Scripting.
 * http://paperjs.org/
 *
 * Copyright (c) 2011 - 2020, Jürg Lehni & Jonathan Puckey
 * http://juerglehni.com/ & https://puckey.studio/
 *
 * Distributed under the MIT license. See LICENSE file for details.
 *
 * All rights reserved.
 *
 * Date: Wed Jul 17 14:57:24 2024 +0200
 *
 ***
 *
 * Straps.js - Class inheritance library with support for bean-style accessors
 *
 * Copyright (c) 2006 - 2020 Jürg Lehni
 * http://juerglehni.com/
 *
 * Distributed under the MIT license.
 *
 ***
 *
 * Acorn.js
 * https://marijnhaverbeke.nl/acorn/
 *
 * Acorn is a tiny, fast JavaScript parser written in JavaScript,
 * created by Marijn Haverbeke and released under an MIT license.
 *
 */var Cr=hi.exports,gn;function Pr(){return gn||(gn=1,function(Z){(function(A,k){A=A||dn;var F=A.window,q=A.document,P=new function(){var t=/^(statics|enumerable|beans|preserve)$/,e=[],i=e.slice,n=Object.create,r=Object.getOwnPropertyDescriptor,s=Object.defineProperty,u=e.forEach||function(c,f){for(var y=0,v=this.length;y<v;y++)c.call(f,this[y],y,this)},a=function(c,f){for(var y in this)this.hasOwnProperty(y)&&c.call(f,this[y],y,this)},o=Object.assign||function(c){for(var f=1,y=arguments.length;f<y;f++){var v=arguments[f];for(var b in v)v.hasOwnProperty(b)&&(c[b]=v[b])}return c},l=function(c,f,y){if(c){var v=r(c,"length");(v&&typeof v.value=="number"?u:a).call(c,f,y=y||c)}return y};function d(c,f,y,v,b){var g={};function m(w,C){C=C||(C=r(f,w))&&(C.get?C:C.value),typeof C=="string"&&C[0]==="#"&&(C=c[C.substring(1)]||C);var T=typeof C=="function",M=C,z=b||T&&!C.base?C&&C.get?w in c:c[w]:null,I;(!b||!z)&&(T&&z&&(C.base=z),T&&v!==!1&&(I=w.match(/^([gs]et|is)(([A-Z])(.*))$/))&&(g[I[3].toLowerCase()+I[4]]=I[2]),(!M||T||!M.get||typeof M.get!="function"||!_.isPlainObject(M))&&(M={value:M,writable:!0}),(r(c,w)||{configurable:!0}).configurable&&(M.configurable=!0,M.enumerable=y??!I),s(c,w,M))}if(f){for(var h in f)f.hasOwnProperty(h)&&!t.test(h)&&m(h);for(var h in g){var p=g[h],S=c["set"+p],x=c["get"+p]||S&&c["is"+p];x&&(v===!0||x.length===0)&&m(h,{get:x,set:S})}}return c}function _(){for(var c=0,f=arguments.length;c<f;c++){var y=arguments[c];y&&o(this,y)}return this}return d(_,{inject:function(c){if(c){var f=c.statics===!0?c:c.statics,y=c.beans,v=c.preserve;f!==c&&d(this.prototype,c,c.enumerable,y,v),d(this,f,null,y,v)}for(var b=1,g=arguments.length;b<g;b++)this.inject(arguments[b]);return this},extend:function(){for(var c=this,f,y,v=0,b,g=arguments.length;v<g&&!(f&&y);v++)b=arguments[v],f=f||b.initialize,y=y||b.prototype;return f=f||function(){c.apply(this,arguments)},y=f.prototype=y||n(this.prototype),s(y,"constructor",{value:f,writable:!0,configurable:!0}),d(f,this),arguments.length&&this.inject.apply(f,arguments),f.base=c,f}}).inject({enumerable:!1,initialize:_,set:_,inject:function(){for(var c=0,f=arguments.length;c<f;c++){var y=arguments[c];y&&d(this,y,y.enumerable,y.beans,y.preserve)}return this},extend:function(){var c=n(this);return c.inject.apply(c,arguments)},each:function(c,f){return l(this,c,f)},clone:function(){return new this.constructor(this)},statics:{set:o,each:l,create:n,define:s,describe:r,clone:function(c){return o(new c.constructor,c)},isPlainObject:function(c){var f=c!=null&&c.constructor;return f&&(f===Object||f===_||f.name==="Object")},pick:function(c,f){return c!==k?c:f},slice:function(c,f,y){return i.call(c,f,y)}}})};Z.exports=P,P.inject({enumerable:!1,toString:function(){return this._id!=null?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+P.each(this,function(t,e){if(!/^_/.test(e)){var i=typeof t;this.push(e+": "+(i==="number"?$t.instance.number(t):i==="string"?"'"+t+"'":t))}},[]).join(", ")+" }"},getClassName:function(){return this._class||""},importJSON:function(t){return P.importJSON(t,this)},exportJSON:function(t){return P.exportJSON(this,t)},toJSON:function(){return P.serialize(this)},set:function(t,e){return t&&P.filter(this,t,e,this._prioritize),this}},{beans:!1,statics:{exports:{},extend:function t(){var e=t.base.apply(this,arguments),i=e.prototype._class;return i&&!P.exports[i]&&(P.exports[i]=e),e},equals:function(t,e){if(t===e)return!0;if(t&&t.equals)return t.equals(e);if(e&&e.equals)return e.equals(t);if(t&&e&&typeof t=="object"&&typeof e=="object"){if(Array.isArray(t)&&Array.isArray(e)){var i=t.length;if(i!==e.length)return!1;for(;i--;)if(!P.equals(t[i],e[i]))return!1}else{var n=Object.keys(t),i=n.length;if(i!==Object.keys(e).length)return!1;for(;i--;){var r=n[i];if(!(e.hasOwnProperty(r)&&P.equals(t[r],e[r])))return!1}}return!0}return!1},read:function(t,e,i,n){if(this===P){var r=this.peek(t,e);return t.__index++,r}var s=this.prototype,u=s._readIndex,a=e||u&&t.__index||0,o=t.length,l=t[a];if(n=n||o-a,l instanceof this||i&&i.readNull&&l==null&&n<=1)return u&&(t.__index=a+1),l&&i&&i.clone?l.clone():l;if(l=P.create(s),u&&(l.__read=!0),l=l.initialize.apply(l,a>0||a+n<o?P.slice(t,a,a+n):t)||l,u){t.__index=a+l.__read;var d=l.__filtered;d&&(t.__filtered=d,l.__filtered=k),l.__read=k}return l},peek:function(t,e){return t[t.__index=e||t.__index||0]},remain:function(t){return t.length-(t.__index||0)},readList:function(t,e,i,n){for(var r=[],s,u=e||0,a=n?u+n:t.length,o=u;o<a;o++)r.push(Array.isArray(s=t[o])?this.read(s,0,i):this.read(t,o,i,1));return r},readNamed:function(t,e,i,n,r){var s=this.getNamed(t,e),u=s!==k;if(u){var a=t.__filtered;if(!a){var o=this.getSource(t);a=t.__filtered=P.create(o),a.__unfiltered=o}a[e]=k}return this.read(u?[s]:t,i,n,r)},readSupported:function(t,e){var i=this.getSource(t),n=this,r=!1;return i&&Object.keys(i).forEach(function(s){if(s in e){var u=n.readNamed(t,s);u!==k&&(e[s]=u),r=!0}}),r},getSource:function(t){var e=t.__source;if(e===k){var i=t.length===1&&t[0];e=t.__source=i&&P.isPlainObject(i)?i:null}return e},getNamed:function(t,e){var i=this.getSource(t);if(i)return e?i[e]:t.__filtered||i},hasNamed:function(t,e){return!!this.getNamed(t,e)},filter:function(t,e,i,n){var r;function s(d){if(!(i&&d in i)&&!(r&&d in r)){var _=e[d];_!==k&&(t[d]=_)}}if(n){for(var u={},a=0,o,l=n.length;a<l;a++)(o=n[a])in e&&(s(o),u[o]=!0);r=u}return Object.keys(e.__unfiltered||e).forEach(s),t},isPlainValue:function(t,e){return P.isPlainObject(t)||Array.isArray(t)||e&&typeof t=="string"},serialize:function(t,e,i,n){e=e||{};var r=!n,s;if(r&&(e.formatter=new $t(e.precision),n={length:0,definitions:{},references:{},add:function(_,c){var f="#"+_._id,y=this.references[f];if(!y){this.length++;var v=c.call(_),b=_._class;b&&v[0]!==b&&v.unshift(b),this.definitions[f]=v,y=this.references[f]=[f]}return y}}),t&&t._serialize){s=t._serialize(e,n);var u=t._class;u&&!t._compactSerialize&&(r||!i)&&s[0]!==u&&s.unshift(u)}else if(Array.isArray(t)){s=[];for(var a=0,o=t.length;a<o;a++)s[a]=P.serialize(t[a],e,i,n)}else if(P.isPlainObject(t)){s={};for(var l=Object.keys(t),a=0,o=l.length;a<o;a++){var d=l[a];s[d]=P.serialize(t[d],e,i,n)}}else typeof t=="number"?s=e.formatter.number(t,e.precision):s=t;return r&&n.length>0?[["dictionary",n.definitions],s]:s},deserialize:function(t,e,i,n,r){var s=t,u=!i,a=u&&t&&t.length&&t[0][0]==="dictionary";if(i=i||{},Array.isArray(t)){var o=t[0],l=o==="dictionary";if(t.length==1&&/^#/.test(o))return i.dictionary[o];o=P.exports[o],s=[];for(var d=o?1:0,_=t.length;d<_;d++)s.push(P.deserialize(t[d],e,i,l,a));if(o){var c=s;e?s=e(o,c,u||r):s=new o(c)}}else if(P.isPlainObject(t)){s={},n&&(i.dictionary=s);for(var f in t)s[f]=P.deserialize(t[f],e,i)}return a?s[1]:s},exportJSON:function(t,e){var i=P.serialize(t,e);return e&&e.asString==!1?i:JSON.stringify(i)},importJSON:function(t,e){return P.deserialize(typeof t=="string"?JSON.parse(t):t,function(i,n,r){var s=r&&e&&e.constructor===i,u=s?e:P.create(i.prototype);if(n.length===1&&u instanceof mt&&(s||!(u instanceof tt))){var a=n[0];P.isPlainObject(a)&&(a.insert=!1,s&&(n=n.concat([mt.INSERT])))}return(s?u.set:i).apply(u,n),s&&(e=null),u})},push:function(t,e){var i=e.length;if(i<4096)t.push.apply(t,e);else{var n=t.length;t.length+=i;for(var r=0;r<i;r++)t[n+r]=e[r]}return t},splice:function(t,e,i,n){var r=e&&e.length,s=i===k;i=s?t.length:i,i>t.length&&(i=t.length);for(var u=0;u<r;u++)e[u]._index=i+u;if(s)return P.push(t,e),[];var a=[i,n];e&&P.push(a,e);for(var o=t.splice.apply(t,a),u=0,l=o.length;u<l;u++)o[u]._index=k;for(var u=i+r,l=t.length;u<l;u++)t[u]._index=u;return o},capitalize:function(t){return t.replace(/\b[a-z]/g,function(e){return e.toUpperCase()})},camelize:function(t){return t.replace(/-(.)/g,function(e,i){return i.toUpperCase()})},hyphenate:function(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var pt={on:function(t,e){if(typeof t!="string")P.each(t,function(s,u){this.on(u,s)},this);else{var i=this._eventTypes,n=i&&i[t],r=this._callbacks=this._callbacks||{};r=r[t]=r[t]||[],r.indexOf(e)===-1&&(r.push(e),n&&n.install&&r.length===1&&n.install.call(this,t))}return this},off:function(t,e){if(typeof t!="string"){P.each(t,function(u,a){this.off(a,u)},this);return}var i=this._eventTypes,n=i&&i[t],r=this._callbacks&&this._callbacks[t],s;return r&&(!e||(s=r.indexOf(e))!==-1&&r.length===1?(n&&n.uninstall&&n.uninstall.call(this,t),delete this._callbacks[t]):s!==-1&&r.splice(s,1)),this},once:function(t,e){return this.on(t,function i(){e.apply(this,arguments),this.off(t,i)})},emit:function(t,e){var i=this._callbacks&&this._callbacks[t];if(!i)return!1;var n=P.slice(arguments,1),r=e&&e.target&&!e.currentTarget;i=i.slice(),r&&(e.currentTarget=this);for(var s=0,u=i.length;s<u;s++)if(i[s].apply(this,n)==!1){e&&e.stop&&e.stop();break}return r&&delete e.currentTarget,!0},responds:function(t){return!!(this._callbacks&&this._callbacks[t])},attach:"#on",detach:"#off",fire:"#emit",_installEvents:function(t){var e=this._eventTypes,i=this._callbacks,n=t?"install":"uninstall";if(e){for(var r in i)if(i[r].length>0){var s=e[r],u=s&&s[n];u&&u.call(this,r)}}},statics:{inject:function t(e){var i=e._events;if(i){var n={};P.each(i,function(r,s){var u=typeof r=="string",a=u?r:s,o=P.capitalize(a),l=a.substring(2).toLowerCase();n[l]=u?{}:r,a="_"+a,e["get"+o]=function(){return this[a]},e["set"+o]=function(d){var _=this[a];_&&this.off(l,_),d&&this.on(l,d),this[a]=d}}),e._eventTypes=n}return t.base.apply(this,arguments)}}},kt=P.extend({_class:"PaperScope",initialize:function t(){bt=this,this.settings=new P({applyMatrix:!0,insertItems:!0,handleSize:4,hitTolerance:0}),this.project=null,this.projects=[],this.tools=[],this._id=t._id++,t._scopes[this._id]=this;var e=t.prototype;if(!this.support){var i=Ut.getContext(1,1)||{};e.support={nativeDash:"setLineDash"in i||"mozDash"in i,nativeBlendModes:gi.nativeModes},Ut.release(i)}if(!this.agent){var n=A.navigator.userAgent.toLowerCase(),r=(/(darwin|win|mac|linux|freebsd|sunos)/.exec(n)||[])[0],s=r==="darwin"?"mac":r,u=e.agent=e.browser={platform:s};s&&(u[s]=!0),n.replace(/(opera|chrome|safari|webkit|firefox|msie|trident|atom|node|jsdom)\/?\s*([.\d]+)(?:.*version\/([.\d]+))?(?:.*rv\:v?([.\d]+))?/g,function(a,o,l,d,_){if(!u.chrome){var c=o==="opera"?d:/^(node|trident)$/.test(o)?_:l;u.version=c,u.versionNumber=parseFloat(c),o={trident:"msie",jsdom:"node"}[o]||o,u.name=o,u[o]=!0}}),u.chrome&&delete u.webkit,u.atom&&delete u.chrome}},version:"0.12.18",getView:function(){var t=this.project;return t&&t._view},getPaper:function(){return this},execute:function(t,e){var i=bt.PaperScript.execute(t,this,e);return zt.updateFocus(),i},install:function(t){var e=this;P.each(["project","view","tool"],function(n){P.define(t,n,{configurable:!0,get:function(){return e[n]}})});for(var i in this)!/^_/.test(i)&&this[i]&&(t[i]=this[i])},setup:function(t){return bt=this,this.project=new Ne(t),this},createCanvas:function(t,e){return Ut.getCanvas(t,e)},activate:function(){bt=this},clear:function(){for(var t=this.projects,e=this.tools,i=t.length-1;i>=0;i--)t[i].remove();for(var i=e.length-1;i>=0;i--)e[i].remove()},remove:function(){this.clear(),delete kt._scopes[this._id]},statics:new function(){function t(e){return e+="Attribute",function(i,n){return i[e](n)||i[e]("data-paper-"+n)}}return{_scopes:{},_id:0,get:function(e){return this._scopes[e]||null},getAttribute:t("get"),hasAttribute:t("has")}}}),jt=P.extend(pt,{initialize:function(t){this._scope=bt,this._index=this._scope[this._list].push(this)-1,(t||!this._scope[this._reference])&&this.activate()},activate:function(){if(!this._scope)return!1;var t=this._scope[this._reference];return t&&t!==this&&t.emit("deactivate"),this._scope[this._reference]=this,this.emit("activate",t),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){return this._index==null?!1:(P.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this&&(this._scope[this._reference]=null),this._scope=null,!0)},getView:function(){return this._scope.getView()}}),oe={findItemBoundsCollisions:function(t,e,i){function n(u){for(var a=new Array(u.length),o=0;o<u.length;o++){var l=u[o].getBounds();a[o]=[l.left,l.top,l.right,l.bottom]}return a}var r=n(t),s=!e||e===t?r:n(e);return this.findBoundsCollisions(r,s,i||0)},findCurveBoundsCollisions:function(t,e,i,n){function r(c){for(var f=Math.min,y=Math.max,v=new Array(c.length),b=0;b<c.length;b++){var g=c[b];v[b]=[f(g[0],g[2],g[4],g[6]),f(g[1],g[3],g[5],g[7]),y(g[0],g[2],g[4],g[6]),y(g[1],g[3],g[5],g[7])]}return v}var s=r(t),u=!e||e===t?s:r(e);if(n){for(var a=this.findBoundsCollisions(s,u,i||0,!1,!0),o=this.findBoundsCollisions(s,u,i||0,!0,!0),l=[],d=0,_=a.length;d<_;d++)l[d]={hor:a[d],ver:o[d]};return l}return this.findBoundsCollisions(s,u,i||0)},findBoundsCollisions:function(t,e,i,n,r){var s=!e||t===e,u=s?t:t.concat(e),a=t.length,o=u.length;function l(K,Q,et){for(var U=0,W=K.length;U<W;){var $=W+U>>>1;u[K[$]][Q]<et?U=$+1:W=$}return U-1}for(var d=n?1:0,_=d+2,c=n?0:1,f=c+2,y=new Array(o),v=0;v<o;v++)y[v]=v;y.sort(function(K,Q){return u[K][d]-u[Q][d]});for(var b=[],g=new Array(a),v=0;v<o;v++){var m=y[v],h=u[m],p=s?m:m-a,S=m<a,x=s||!S,w=S?[]:null;if(b.length){var C=l(b,_,h[d]-i)+1;if(b.splice(0,C),s&&r){w=w.concat(b);for(var T=0;T<b.length;T++){var M=b[T];g[M].push(p)}}else for(var z=h[f],I=h[c],T=0;T<b.length;T++){var M=b[T],E=u[M],L=M<a,D=s||M>=a;(r||(S&&D||x&&L)&&z>=E[c]-i&&I<=E[f]+i)&&(S&&D&&w.push(s?M:M-a),x&&L&&g[M].push(p))}}if(S&&(t===e&&w.push(m),g[m]=w),b.length){var B=h[_],V=l(b,_,B);b.splice(V+1,0,m)}else b.push(m)}for(var v=0;v<g.length;v++){var j=g[v];j&&j.sort(function(Q,et){return Q-et})}return g}},$t=P.extend({initialize:function(t){this.precision=P.pick(t,5),this.multiplier=Math.pow(10,this.precision)},number:function(t){return this.precision<16?Math.round(t*this.multiplier)/this.multiplier:t},pair:function(t,e,i){return this.number(t)+(i||",")+this.number(e)},point:function(t,e){return this.number(t.x)+(e||",")+this.number(t.y)},size:function(t,e){return this.number(t.width)+(e||",")+this.number(t.height)},rectangle:function(t,e){return this.point(t,e)+(e||",")+this.size(t,e)}});$t.instance=new $t;var St=new function(){var t=[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],e=[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]],i=Math.abs,n=Math.sqrt,r=Math.pow,s=Math.log2||function(_){return Math.log(_)*Math.LOG2E},u=1e-12,a=112e-18;function o(_,c,f){return _<c?c:_>f?f:_}function l(_,c,f){function y(C){var T=C*134217729,M=C-T,z=M+T,I=C-z;return[z,I]}var v=c*c-_*f,b=c*c+_*f;if(i(v)*3<b){var g=y(_),m=y(c),h=y(f),p=c*c,S=m[0]*m[0]-p+2*m[0]*m[1]+m[1]*m[1],x=_*f,w=g[0]*h[0]-x+g[0]*h[1]+g[1]*h[0]+g[1]*h[1];v=p-x+(S-w)}return v}function d(){var _=Math.max.apply(Math,arguments);return _&&(_<1e-8||_>1e8)?r(2,-Math.round(s(_))):0}return{EPSILON:u,MACHINE_EPSILON:a,CURVETIME_EPSILON:1e-8,GEOMETRIC_EPSILON:1e-7,TRIGONOMETRIC_EPSILON:1e-8,ANGULAR_EPSILON:1e-5,KAPPA:4*(n(2)-1)/3,isZero:function(_){return _>=-1e-12&&_<=u},isMachineZero:function(_){return _>=-112e-18&&_<=a},clamp:o,integrate:function(_,c,f,y){for(var v=t[y-2],b=e[y-2],g=(f-c)*.5,m=g+c,h=0,p=y+1>>1,S=y&1?b[h++]*_(m):0;h<p;){var x=g*v[h];S+=b[h++]*(_(m+x)+_(m-x))}return g*S},findRoot:function(_,c,f,y,v,b,g){for(var m=0;m<b;m++){var h=_(f),p=h/c(f),S=f-p;if(i(p)<g){f=S;break}h>0?(v=f,f=S<=y?(y+v)*.5:S):(y=f,f=S>=v?(y+v)*.5:S)}return o(f,y,v)},solveQuadratic:function(_,c,f,y,v,b){var g,m=1/0;if(i(_)<u){if(i(c)<u)return i(f)<u?-1:0;g=-f/c}else{c*=-.5;var h=l(_,c,f);if(h&&i(h)<a){var p=d(i(_),i(c),i(f));p&&(_*=p,c*=p,f*=p,h=l(_,c,f))}if(h>=-112e-18){var S=h<0?0:n(h),x=c+(c<0?-S:S);x===0?(g=f/_,m=-g):(g=x/_,m=f/x)}}var w=0,C=v==null,T=v-u,M=b+u;return isFinite(g)&&(C||g>T&&g<M)&&(y[w++]=C?g:o(g,v,b)),m!==g&&isFinite(m)&&(C||m>T&&m<M)&&(y[w++]=C?m:o(m,v,b)),w},solveCubic:function(_,c,f,y,v,b,g){var m=d(i(_),i(c),i(f),i(y)),h,p,S,x,w;m&&(_*=m,c*=m,f*=m,y*=m);function C(V){h=V;var j=_*h;p=j+c,S=p*h+f,x=(j+p)*h+S,w=S*h+y}if(i(_)<u)_=c,p=f,S=y,h=1/0;else if(i(y)<u)p=c,S=f,h=0;else{C(-(c/_)/3);var T=w/_,M=r(i(T),1/3),z=T<0?-1:1,I=-x/_,E=I>0?1.324717957244746*Math.max(M,n(I)):M,L=h-z*E;if(L!==h){do C(L),L=x===0?h:h-w/x/(1+a);while(z*L>z*h);i(_)*h*h>i(y/h)&&(S=-y/h,p=(S-f)/h)}}var D=St.solveQuadratic(_,p,S,v,b,g),B=b==null;return isFinite(h)&&(D===0||D>0&&h!==v[0]&&h!==v[1])&&(B||h>b-u&&h<g+u)&&(v[D++]=B?h:o(h,b,g)),D}}},ze={_id:1,_pools:{},get:function(t){if(t){var e=this._pools[t];return e||(e=this._pools[t]={_id:1}),e._id++}else return this._id++}},R=P.extend({_class:"Point",_readIndex:!0,initialize:function(e,i){var n=typeof e,r=this.__read,s=0;if(n==="number"){var u=typeof i=="number";this._set(e,u?i:e),r&&(s=u?2:1)}else if(n==="undefined"||e===null)this._set(0,0),r&&(s=e===null?1:0);else{var a=n==="string"?e.split(/[\s,]+/)||[]:e;s=1,Array.isArray(a)?this._set(+a[0],+(a.length>1?a[1]:a[0])):"x"in a?this._set(a.x||0,a.y||0):"width"in a?this._set(a.width||0,a.height||0):"angle"in a?(this._set(a.length||0,0),this.setAngle(a.angle||0)):(this._set(0,0),s=0)}return r&&(this.__read=s),this},set:"#initialize",_set:function(t,e){return this.x=t,this.y=e,this},equals:function(t){return this===t||t&&(this.x===t.x&&this.y===t.y||Array.isArray(t)&&this.x===t[0]&&this.y===t[1])||!1},clone:function(){return new R(this.x,this.y)},toString:function(){var t=$t.instance;return"{ x: "+t.number(this.x)+", y: "+t.number(this.y)+" }"},_serialize:function(t){var e=t.formatter;return[e.number(this.x),e.number(this.y)]},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setLength:function(t){if(this.isZero()){var e=this._angle||0;this._set(Math.cos(e)*t,Math.sin(e)*t)}else{var i=t/this.getLength();St.isZero(i)&&this.getAngle(),this._set(this.x*i,this.y*i)}},getAngle:function(){return this.getAngleInRadians.apply(this,arguments)*180/Math.PI},setAngle:function(t){this.setAngleInRadians.call(this,t*Math.PI/180)},getAngleInDegrees:"#getAngle",setAngleInDegrees:"#setAngle",getAngleInRadians:function(){if(arguments.length){var t=R.read(arguments),e=this.getLength()*t.getLength();if(St.isZero(e))return NaN;var i=this.dot(t)/e;return Math.acos(i<-1?-1:i>1?1:i)}else return this.isZero()?this._angle||0:this._angle=Math.atan2(this.y,this.x)},setAngleInRadians:function(t){if(this._angle=t,!this.isZero()){var e=this.getLength();this._set(Math.cos(t)*e,Math.sin(t)*e)}},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3}},{beans:!1,getDirectedAngle:function(){var t=R.read(arguments);return Math.atan2(this.cross(t),this.dot(t))*180/Math.PI},getDistance:function(){var t=arguments,e=R.read(t),i=e.x-this.x,n=e.y-this.y,r=i*i+n*n,s=P.read(t);return s?r:Math.sqrt(r)},normalize:function(t){t===k&&(t=1);var e=this.getLength(),i=e!==0?t/e:0,n=new R(this.x*i,this.y*i);return i>=0&&(n._angle=this._angle),n},rotate:function(t,e){if(t===0)return this.clone();t=t*Math.PI/180;var i=e?this.subtract(e):this,n=Math.sin(t),r=Math.cos(t);return i=new R(i.x*r-i.y*n,i.x*n+i.y*r),e?i.add(e):i},transform:function(t){return t?t._transformPoint(this):this},add:function(){var t=R.read(arguments);return new R(this.x+t.x,this.y+t.y)},subtract:function(){var t=R.read(arguments);return new R(this.x-t.x,this.y-t.y)},multiply:function(){var t=R.read(arguments);return new R(this.x*t.x,this.y*t.y)},divide:function(){var t=R.read(arguments);return new R(this.x/t.x,this.y/t.y)},modulo:function(){var t=R.read(arguments);return new R(this.x%t.x,this.y%t.y)},negate:function(){return new R(-this.x,-this.y)},isInside:function(){return ft.read(arguments).contains(this)},isClose:function(){var t=arguments,e=R.read(t),i=P.read(t);return this.getDistance(e)<=i},isCollinear:function(){var t=R.read(arguments);return R.isCollinear(this.x,this.y,t.x,t.y)},isColinear:"#isCollinear",isOrthogonal:function(){var t=R.read(arguments);return R.isOrthogonal(this.x,this.y,t.x,t.y)},isZero:function(){var t=St.isZero;return t(this.x)&&t(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},isInQuadrant:function(t){return this.x*(t>1&&t<4?-1:1)>=0&&this.y*(t>2?-1:1)>=0},dot:function(){var t=R.read(arguments);return this.x*t.x+this.y*t.y},cross:function(){var t=R.read(arguments);return this.x*t.y-this.y*t.x},project:function(){var t=R.read(arguments),e=t.isZero()?0:this.dot(t)/t.dot(t);return new R(t.x*e,t.y*e)},statics:{min:function(){var t=arguments,e=R.read(t),i=R.read(t);return new R(Math.min(e.x,i.x),Math.min(e.y,i.y))},max:function(){var t=arguments,e=R.read(t),i=R.read(t);return new R(Math.max(e.x,i.x),Math.max(e.y,i.y))},random:function(){return new R(Math.random(),Math.random())},isCollinear:function(t,e,i,n){return Math.abs(t*n-e*i)<=Math.sqrt((t*t+e*e)*(i*i+n*n))*1e-8},isOrthogonal:function(t,e,i,n){return Math.abs(t*i+e*n)<=Math.sqrt((t*t+e*e)*(i*i+n*n))*1e-8}}},P.each(["round","ceil","floor","abs"],function(t){var e=Math[t];this[t]=function(){return new R(e(this.x),e(this.y))}},{})),ee=R.extend({initialize:function(e,i,n,r){this._x=e,this._y=i,this._owner=n,this._setter=r},_set:function(t,e,i){return this._x=t,this._y=e,i||this._owner[this._setter](this),this},getX:function(){return this._x},setX:function(t){this._x=t,this._owner[this._setter](this)},getY:function(){return this._y},setY:function(t){this._y=t,this._owner[this._setter](this)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(t){this._owner._changeSelection(this._getSelection(),t)},_getSelection:function(){return this._setter==="setPosition"?4:0}}),ut=P.extend({_class:"Size",_readIndex:!0,initialize:function(e,i){var n=typeof e,r=this.__read,s=0;if(n==="number"){var u=typeof i=="number";this._set(e,u?i:e),r&&(s=u?2:1)}else if(n==="undefined"||e===null)this._set(0,0),r&&(s=e===null?1:0);else{var a=n==="string"?e.split(/[\s,]+/)||[]:e;s=1,Array.isArray(a)?this._set(+a[0],+(a.length>1?a[1]:a[0])):"width"in a?this._set(a.width||0,a.height||0):"x"in a?this._set(a.x||0,a.y||0):(this._set(0,0),s=0)}return r&&(this.__read=s),this},set:"#initialize",_set:function(t,e){return this.width=t,this.height=e,this},equals:function(t){return t===this||t&&(this.width===t.width&&this.height===t.height||Array.isArray(t)&&this.width===t[0]&&this.height===t[1])||!1},clone:function(){return new ut(this.width,this.height)},toString:function(){var t=$t.instance;return"{ width: "+t.number(this.width)+", height: "+t.number(this.height)+" }"},_serialize:function(t){var e=t.formatter;return[e.number(this.width),e.number(this.height)]},add:function(){var t=ut.read(arguments);return new ut(this.width+t.width,this.height+t.height)},subtract:function(){var t=ut.read(arguments);return new ut(this.width-t.width,this.height-t.height)},multiply:function(){var t=ut.read(arguments);return new ut(this.width*t.width,this.height*t.height)},divide:function(){var t=ut.read(arguments);return new ut(this.width/t.width,this.height/t.height)},modulo:function(){var t=ut.read(arguments);return new ut(this.width%t.width,this.height%t.height)},negate:function(){return new ut(-this.width,-this.height)},isZero:function(){var t=St.isZero;return t(this.width)&&t(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function(t,e){return new ut(Math.min(t.width,e.width),Math.min(t.height,e.height))},max:function(t,e){return new ut(Math.max(t.width,e.width),Math.max(t.height,e.height))},random:function(){return new ut(Math.random(),Math.random())}}},P.each(["round","ceil","floor","abs"],function(t){var e=Math[t];this[t]=function(){return new ut(e(this.width),e(this.height))}},{})),ne=ut.extend({initialize:function(e,i,n,r){this._width=e,this._height=i,this._owner=n,this._setter=r},_set:function(t,e,i){return this._width=t,this._height=e,i||this._owner[this._setter](this),this},getWidth:function(){return this._width},setWidth:function(t){this._width=t,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(t){this._height=t,this._owner[this._setter](this)}}),ft=P.extend({_class:"Rectangle",_readIndex:!0,beans:!0,initialize:function(e,i,n,r){var s=arguments,u=typeof e,a;if(u==="number"?(this._set(e,i,n,r),a=4):u==="undefined"||e===null?(this._set(0,0,0,0),a=e===null?1:0):s.length===1&&(Array.isArray(e)?(this._set.apply(this,e),a=1):e.x!==k||e.width!==k?(this._set(e.x||0,e.y||0,e.width||0,e.height||0),a=1):e.from===k&&e.to===k&&(this._set(0,0,0,0),P.readSupported(s,this)&&(a=1))),a===k){var o=R.readNamed(s,"from"),l=P.peek(s),d=o.x,_=o.y,c,f;if(l&&l.x!==k||P.hasNamed(s,"to")){var y=R.readNamed(s,"to");c=y.x-d,f=y.y-_,c<0&&(d=y.x,c=-c),f<0&&(_=y.y,f=-f)}else{var v=ut.read(s);c=v.width,f=v.height}this._set(d,_,c,f),a=s.__index}var b=s.__filtered;return b&&(this.__filtered=b),this.__read&&(this.__read=a),this},set:"#initialize",_set:function(t,e,i,n){return this.x=t,this.y=e,this.width=i,this.height=n,this},clone:function(){return new ft(this.x,this.y,this.width,this.height)},equals:function(t){var e=P.isPlainValue(t)?ft.read(arguments):t;return e===this||e&&this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height||!1},toString:function(){var t=$t.instance;return"{ x: "+t.number(this.x)+", y: "+t.number(this.y)+", width: "+t.number(this.width)+", height: "+t.number(this.height)+" }"},_serialize:function(t){var e=t.formatter;return[e.number(this.x),e.number(this.y),e.number(this.width),e.number(this.height)]},getPoint:function(t){var e=t?R:ee;return new e(this.x,this.y,this,"setPoint")},setPoint:function(){var t=R.read(arguments);this.x=t.x,this.y=t.y},getSize:function(t){var e=t?ut:ne;return new e(this.width,this.height,this,"setSize")},_fw:1,_fh:1,setSize:function(){var t=ut.read(arguments),e=this._sx,i=this._sy,n=t.width,r=t.height;e&&(this.x+=(this.width-n)*e),i&&(this.y+=(this.height-r)*i),this.width=n,this.height=r,this._fw=this._fh=1},getLeft:function(){return this.x},setLeft:function(t){if(!this._fw){var e=t-this.x;this.width-=this._sx===.5?e*2:e}this.x=t,this._sx=this._fw=0},getTop:function(){return this.y},setTop:function(t){if(!this._fh){var e=t-this.y;this.height-=this._sy===.5?e*2:e}this.y=t,this._sy=this._fh=0},getRight:function(){return this.x+this.width},setRight:function(t){if(!this._fw){var e=t-this.x;this.width=this._sx===.5?e*2:e}this.x=t-this.width,this._sx=1,this._fw=0},getBottom:function(){return this.y+this.height},setBottom:function(t){if(!this._fh){var e=t-this.y;this.height=this._sy===.5?e*2:e}this.y=t-this.height,this._sy=1,this._fh=0},getCenterX:function(){return this.x+this.width/2},setCenterX:function(t){this._fw||this._sx===.5?this.x=t-this.width/2:(this._sx&&(this.x+=(t-this.x)*2*this._sx),this.width=(t-this.x)*2),this._sx=.5,this._fw=0},getCenterY:function(){return this.y+this.height/2},setCenterY:function(t){this._fh||this._sy===.5?this.y=t-this.height/2:(this._sy&&(this.y+=(t-this.y)*2*this._sy),this.height=(t-this.y)*2),this._sy=.5,this._fh=0},getCenter:function(t){var e=t?R:ee;return new e(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(){var t=R.read(arguments);return this.setCenterX(t.x),this.setCenterY(t.y),this},getArea:function(){return this.width*this.height},isEmpty:function(){return this.width===0||this.height===0},contains:function(t){return t&&t.width!==k||(Array.isArray(t)?t:arguments).length===4?this._containsRectangle(ft.read(arguments)):this._containsPoint(R.read(arguments))},_containsPoint:function(t){var e=t.x,i=t.y;return e>=this.x&&i>=this.y&&e<=this.x+this.width&&i<=this.y+this.height},_containsRectangle:function(t){var e=t.x,i=t.y;return e>=this.x&&i>=this.y&&e+t.width<=this.x+this.width&&i+t.height<=this.y+this.height},intersects:function(){var t=ft.read(arguments),e=P.read(arguments)||0;return t.x+t.width>this.x-e&&t.y+t.height>this.y-e&&t.x<this.x+this.width+e&&t.y<this.y+this.height+e},intersect:function(){var t=ft.read(arguments),e=Math.max(this.x,t.x),i=Math.max(this.y,t.y),n=Math.min(this.x+this.width,t.x+t.width),r=Math.min(this.y+this.height,t.y+t.height);return new ft(e,i,n-e,r-i)},unite:function(){var t=ft.read(arguments),e=Math.min(this.x,t.x),i=Math.min(this.y,t.y),n=Math.max(this.x+this.width,t.x+t.width),r=Math.max(this.y+this.height,t.y+t.height);return new ft(e,i,n-e,r-i)},include:function(){var t=R.read(arguments),e=Math.min(this.x,t.x),i=Math.min(this.y,t.y),n=Math.max(this.x+this.width,t.x),r=Math.max(this.y+this.height,t.y);return new ft(e,i,n-e,r-i)},expand:function(){var t=ut.read(arguments),e=t.width,i=t.height;return new ft(this.x-e/2,this.y-i/2,this.width+e,this.height+i)},scale:function(t,e){return this.expand(this.width*t-this.width,this.height*(e===k?t:e)-this.height)}},P.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],function(t,e){var i=t.join(""),n=/^[RL]/.test(i);e>=4&&(t[1]+=n?"Y":"X");var r=t[n?0:1],s=t[n?1:0],u="get"+r,a="get"+s,o="set"+r,l="set"+s,d="get"+i,_="set"+i;this[d]=function(c){var f=c?R:ee;return new f(this[u](),this[a](),this,_)},this[_]=function(){var c=R.read(arguments);this[o](c.x),this[l](c.y)}},{beans:!0})),Le=ft.extend({initialize:function(e,i,n,r,s,u){this._set(e,i,n,r,!0),this._owner=s,this._setter=u},_set:function(t,e,i,n,r){return this._x=t,this._y=e,this._width=i,this._height=n,r||this._owner[this._setter](this),this}},new function(){var t=ft.prototype;return P.each(["x","y","width","height"],function(e){var i=P.capitalize(e),n="_"+e;this["get"+i]=function(){return this[n]},this["set"+i]=function(r){this[n]=r,this._dontNotify||this._owner[this._setter](this)}},P.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],function(e){var i="set"+e;this[i]=function(){this._dontNotify=!0,t[i].apply(this,arguments),this._dontNotify=!1,this._owner[this._setter](this)}},{isSelected:function(){return!!(this._owner._selection&2)},setSelected:function(e){var i=this._owner;i._changeSelection&&i._changeSelection(2,e)}}))}),Ot=P.extend({_class:"Matrix",initialize:function t(e,i){var n=arguments,r=n.length,s=!0;if(r>=6?this._set.apply(this,n):r===1||r===2?e instanceof t?this._set(e._a,e._b,e._c,e._d,e._tx,e._ty,i):Array.isArray(e)?this._set.apply(this,i?e.concat([i]):e):s=!1:r?s=!1:this.reset(),!s)throw new Error("Unsupported matrix parameters");return this},set:"#initialize",_set:function(t,e,i,n,r,s,u){return this._a=t,this._b=e,this._c=i,this._d=n,this._tx=r,this._ty=s,u||this._changed(),this},_serialize:function(t,e){return P.serialize(this.getValues(),t,!0,e)},_changed:function(){var t=this._owner;t&&(t._applyMatrix?t.transform(null,!0):t._changed(25))},clone:function(){return new Ot(this._a,this._b,this._c,this._d,this._tx,this._ty)},equals:function(t){return t===this||t&&this._a===t._a&&this._b===t._b&&this._c===t._c&&this._d===t._d&&this._tx===t._tx&&this._ty===t._ty},toString:function(){var t=$t.instance;return"[["+[t.number(this._a),t.number(this._c),t.number(this._tx)].join(", ")+"], ["+[t.number(this._b),t.number(this._d),t.number(this._ty)].join(", ")+"]]"},reset:function(t){return this._a=this._d=1,this._b=this._c=this._tx=this._ty=0,t||this._changed(),this},apply:function(t,e){var i=this._owner;return i?(i.transform(null,P.pick(t,!0),e),this.isIdentity()):!1},translate:function(){var t=R.read(arguments),e=t.x,i=t.y;return this._tx+=e*this._a+i*this._c,this._ty+=e*this._b+i*this._d,this._changed(),this},scale:function(){var t=arguments,e=R.read(t),i=R.read(t,0,{readNull:!0});return i&&this.translate(i),this._a*=e.x,this._b*=e.x,this._c*=e.y,this._d*=e.y,i&&this.translate(i.negate()),this._changed(),this},rotate:function(t){t*=Math.PI/180;var e=R.read(arguments,1),i=e.x,n=e.y,r=Math.cos(t),s=Math.sin(t),u=i-i*r+n*s,a=n-i*s-n*r,o=this._a,l=this._b,d=this._c,_=this._d;return this._a=r*o+s*d,this._b=r*l+s*_,this._c=-s*o+r*d,this._d=-s*l+r*_,this._tx+=u*o+a*d,this._ty+=u*l+a*_,this._changed(),this},shear:function(){var t=arguments,e=R.read(t),i=R.read(t,0,{readNull:!0});i&&this.translate(i);var n=this._a,r=this._b;return this._a+=e.y*this._c,this._b+=e.y*this._d,this._c+=e.x*n,this._d+=e.x*r,i&&this.translate(i.negate()),this._changed(),this},skew:function(){var t=arguments,e=R.read(t),i=R.read(t,0,{readNull:!0}),n=Math.PI/180,r=new R(Math.tan(e.x*n),Math.tan(e.y*n));return this.shear(r,i)},append:function(t,e){if(t){var i=this._a,n=this._b,r=this._c,s=this._d,u=t._a,a=t._c,o=t._b,l=t._d,d=t._tx,_=t._ty;this._a=u*i+o*r,this._c=a*i+l*r,this._b=u*n+o*s,this._d=a*n+l*s,this._tx+=d*i+_*r,this._ty+=d*n+_*s,e||this._changed()}return this},prepend:function(t,e){if(t){var i=this._a,n=this._b,r=this._c,s=this._d,u=this._tx,a=this._ty,o=t._a,l=t._c,d=t._b,_=t._d,c=t._tx,f=t._ty;this._a=o*i+l*n,this._c=o*r+l*s,this._b=d*i+_*n,this._d=d*r+_*s,this._tx=o*u+l*a+c,this._ty=d*u+_*a+f,e||this._changed()}return this},appended:function(t){return this.clone().append(t)},prepended:function(t){return this.clone().prepend(t)},invert:function(){var t=this._a,e=this._b,i=this._c,n=this._d,r=this._tx,s=this._ty,u=t*n-e*i,a=null;return u&&!isNaN(u)&&isFinite(r)&&isFinite(s)&&(this._a=n/u,this._b=-e/u,this._c=-i/u,this._d=t/u,this._tx=(i*s-n*r)/u,this._ty=(e*r-t*s)/u,a=this),a},inverted:function(){return this.clone().invert()},concatenate:"#append",preConcatenate:"#prepend",chain:"#appended",_shiftless:function(){return new Ot(this._a,this._b,this._c,this._d,0,0)},_orNullIfIdentity:function(){return this.isIdentity()?null:this},isIdentity:function(){return this._a===1&&this._b===0&&this._c===0&&this._d===1&&this._tx===0&&this._ty===0},isInvertible:function(){var t=this._a*this._d-this._c*this._b;return t&&!isNaN(t)&&isFinite(this._tx)&&isFinite(this._ty)},isSingular:function(){return!this.isInvertible()},transform:function(t,e,i){return arguments.length<3?this._transformPoint(R.read(arguments)):this._transformCoordinates(t,e,i)},_transformPoint:function(t,e,i){var n=t.x,r=t.y;return e||(e=new R),e._set(n*this._a+r*this._c+this._tx,n*this._b+r*this._d+this._ty,i)},_transformCoordinates:function(t,e,i){for(var n=0,r=2*i;n<r;n+=2){var s=t[n],u=t[n+1];e[n]=s*this._a+u*this._c+this._tx,e[n+1]=s*this._b+u*this._d+this._ty}return e},_transformCorners:function(t){var e=t.x,i=t.y,n=e+t.width,r=i+t.height,s=[e,i,n,i,n,r,e,r];return this._transformCoordinates(s,s,4)},_transformBounds:function(t,e,i){for(var n=this._transformCorners(t),r=n.slice(0,2),s=r.slice(),u=2;u<8;u++){var a=n[u],o=u&1;a<r[o]?r[o]=a:a>s[o]&&(s[o]=a)}return e||(e=new ft),e._set(r[0],r[1],s[0]-r[0],s[1]-r[1],i)},inverseTransform:function(){return this._inverseTransform(R.read(arguments))},_inverseTransform:function(t,e,i){var n=this._a,r=this._b,s=this._c,u=this._d,a=this._tx,o=this._ty,l=n*u-r*s,d=null;if(l&&!isNaN(l)&&isFinite(a)&&isFinite(o)){var _=t.x-this._tx,c=t.y-this._ty;e||(e=new R),d=e._set((_*u-c*s)/l,(c*n-_*r)/l,i)}return d},decompose:function(){var t=this._a,e=this._b,i=this._c,n=this._d,r=t*n-e*i,s=Math.sqrt,u=Math.atan2,a=180/Math.PI,o,l,d;if(t!==0||e!==0){var _=s(t*t+e*e);o=Math.acos(t/_)*(e>0?1:-1),l=[_,r/_],d=[u(t*i+e*n,_*_),0]}else if(i!==0||n!==0){var c=s(i*i+n*n);o=Math.asin(i/c)*(n>0?1:-1),l=[r/c,c],d=[0,u(t*i+e*n,c*c)]}else o=0,d=l=[0,0];return{translation:this.getTranslation(),rotation:o*a,scaling:new R(l),skewing:new R(d[0]*a,d[1]*a)}},getValues:function(){return[this._a,this._b,this._c,this._d,this._tx,this._ty]},getTranslation:function(){return new R(this._tx,this._ty)},getScaling:function(){return this.decompose().scaling},getRotation:function(){return this.decompose().rotation},applyToContext:function(t){this.isIdentity()||t.transform(this._a,this._b,this._c,this._d,this._tx,this._ty)}},P.each(["a","b","c","d","tx","ty"],function(t){var e=P.capitalize(t),i="_"+t;this["get"+e]=function(){return this[i]},this["set"+e]=function(n){this[i]=n,this._changed()}},{})),Bt=P.extend({_class:"Line",initialize:function(e,i,n,r,s){var u=!1;arguments.length>=4?(this._px=e,this._py=i,this._vx=n,this._vy=r,u=s):(this._px=e.x,this._py=e.y,this._vx=i.x,this._vy=i.y,u=n),u||(this._vx-=this._px,this._vy-=this._py)},getPoint:function(){return new R(this._px,this._py)},getVector:function(){return new R(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function(t,e){return Bt.intersect(this._px,this._py,this._vx,this._vy,t._px,t._py,t._vx,t._vy,!0,e)},getSide:function(t,e){return Bt.getSide(this._px,this._py,this._vx,this._vy,t.x,t.y,!0,e)},getDistance:function(t){return Math.abs(this.getSignedDistance(t))},getSignedDistance:function(t){return Bt.getSignedDistance(this._px,this._py,this._vx,this._vy,t.x,t.y,!0)},isCollinear:function(t){return R.isCollinear(this._vx,this._vy,t._vx,t._vy)},isOrthogonal:function(t){return R.isOrthogonal(this._vx,this._vy,t._vx,t._vy)},statics:{intersect:function(t,e,i,n,r,s,u,a,o,l){o||(i-=t,n-=e,u-=r,a-=s);var d=i*a-n*u;if(!St.isMachineZero(d)){var _=t-r,c=e-s,f=(u*c-a*_)/d,y=(i*c-n*_)/d,v=1e-12,b=-v,g=1+v;if(l||b<f&&f<g&&b<y&&y<g)return l||(f=f<=0?0:f>=1?1:f),new R(t+f*i,e+f*n)}},getSide:function(t,e,i,n,r,s,u,a){u||(i-=t,n-=e);var o=r-t,l=s-e,d=o*n-l*i;return!a&&St.isMachineZero(d)&&(d=(o*i+o*i)/(i*i+n*n),d>=0&&d<=1&&(d=0)),d<0?-1:d>0?1:0},getSignedDistance:function(t,e,i,n,r,s,u){return u||(i-=t,n-=e),i===0?n>0?r-t:t-r:n===0?i<0?s-e:e-s:((r-t)*n-(s-e)*i)/(n>i?n*Math.sqrt(1+i*i/(n*n)):i*Math.sqrt(1+n*n/(i*i)))},getDistance:function(t,e,i,n,r,s,u){return Math.abs(Bt.getSignedDistance(t,e,i,n,r,s,u))}}}),Ne=jt.extend({_class:"Project",_list:"projects",_reference:"project",_compactSerialize:!0,initialize:function(e){jt.call(this,!0),this._children=[],this._namedChildren={},this._activeLayer=null,this._currentStyle=new di(null,null,this),this._view=zt.create(this,e||Ut.getCanvas(1,1)),this._selectionItems={},this._selectionCount=0,this._updateVersion=0},_serialize:function(t,e){return P.serialize(this._children,t,!0,e)},_changed:function(t,e){if(t&1){var i=this._view;i&&(i._needsUpdate=!0,!i._requested&&i._autoUpdate&&i.requestUpdate())}var n=this._changes;if(n&&e){var r=this._changesById,s=e._id,u=r[s];u?u.flags|=t:n.push(r[s]={item:e,flags:t})}},clear:function(){for(var t=this._children,e=t.length-1;e>=0;e--)t[e].remove()},isEmpty:function(){return!this._children.length},remove:function t(){return t.base.call(this)?(this._view&&this._view.remove(),!0):!1},getView:function(){return this._view},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(t){this._currentStyle.set(t)},getIndex:function(){return this._index},getOptions:function(){return this._scope.settings},getLayers:function(){return this._children},getActiveLayer:function(){return this._activeLayer||new tt({project:this,insert:!0})},getSymbolDefinitions:function(){var t=[],e={};return this.getItems({class:lt,match:function(i){var n=i._definition,r=n._id;return e[r]||(e[r]=!0,t.push(n)),!1}}),t},getSymbols:"getSymbolDefinitions",getSelectedItems:function(){var t=this._selectionItems,e=[];for(var i in t){var n=t[i],r=n._selection;r&1&&n.isInserted()?e.push(n):r||this._updateSelection(n)}return e},_updateSelection:function(t){var e=t._id,i=this._selectionItems;t._selection?i[e]!==t&&(this._selectionCount++,i[e]=t):i[e]===t&&(this._selectionCount--,delete i[e])},selectAll:function(){for(var t=this._children,e=0,i=t.length;e<i;e++)t[e].setFullySelected(!0)},deselectAll:function(){var t=this._selectionItems;for(var e in t)t[e].setFullySelected(!1)},addLayer:function(t){return this.insertLayer(k,t)},insertLayer:function(t,e){if(e instanceof tt){e._remove(!1,!0),P.splice(this._children,[e],t,0),e._setProject(this,!0);var i=e._name;i&&e.setName(i),this._changes&&e._changed(5),this._activeLayer||(this._activeLayer=e)}else e=null;return e},_insertItem:function(t,e,i){return e=this.insertLayer(t,e)||(this._activeLayer||this._insertItem(k,new tt(mt.NO_INSERT),!0)).insertChild(t,e),i&&e.activate&&e.activate(),e},getItems:function(t){return mt._getItems(this,t)},getItem:function(t){return mt._getItems(this,t,null,null,!0)[0]||null},importJSON:function(t){this.activate();var e=this._activeLayer;return P.importJSON(t,e&&e.isEmpty()&&e)},removeOn:function(t){var e=this._removeSets;if(e){t==="mouseup"&&(e.mousedrag=null);var i=e[t];if(i){for(var n in i){var r=i[n];for(var s in e){var u=e[s];u&&u!=i&&delete u[r._id]}r.remove()}e[t]=null}}},draw:function(t,e,i){this._updateVersion++,t.save(),e.applyToContext(t);for(var n=this._children,r=new P({offset:new R(0,0),pixelRatio:i,viewMatrix:e.isIdentity()?null:e,matrices:[new Ot],updateMatrix:!0}),s=0,u=n.length;s<u;s++)n[s].draw(t,r);if(t.restore(),this._selectionCount>0){t.save(),t.strokeWidth=1;var a=this._selectionItems,o=this._scope.settings.handleSize,l=this._updateVersion;for(var d in a)a[d]._drawSelection(t,e,o,a,l);t.restore()}}}),mt=P.extend(pt,{statics:{extend:function t(e){return e._serializeFields&&(e._serializeFields=P.set({},this.prototype._serializeFields,e._serializeFields)),t.base.apply(this,arguments)},INSERT:{insert:!0},NO_INSERT:{insert:!1}},_class:"Item",_name:null,_applyMatrix:!0,_canApplyMatrix:!0,_canScaleStroke:!1,_pivot:null,_visible:!0,_blendMode:"normal",_opacity:1,_locked:!1,_guide:!1,_clipMask:!1,_selection:0,_selectBounds:!0,_selectChildren:!1,_serializeFields:{name:null,applyMatrix:null,matrix:new Ot,pivot:null,visible:!0,blendMode:"normal",opacity:1,locked:!1,guide:!1,clipMask:!1,selected:!1,data:{}},_prioritize:["applyMatrix"]},new function(){var t=["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"];return P.each(t,function(e){this._events[e]={install:function(i){this.getView()._countItemEvent(i,1)},uninstall:function(i){this.getView()._countItemEvent(i,-1)}}},{_events:{onFrame:{install:function(){this.getView()._animateItem(this,!0)},uninstall:function(){this.getView()._animateItem(this,!1)}},onLoad:{},onError:{}},statics:{_itemHandlers:t}})},{initialize:function(){},_initialize:function(t,e){var i=t&&P.isPlainObject(t),n=i&&t.internal===!0,r=this._matrix=new Ot,s=i&&t.project||bt.project,u=bt.settings;return this._id=n?null:ze.get(),this._parent=this._index=null,this._applyMatrix=this._canApplyMatrix&&u.applyMatrix,e&&r.translate(e),r._owner=this,this._style=new di(s._currentStyle,this,s),n||i&&t.insert==!1||!u.insertItems&&!(i&&t.insert==!0)?this._setProject(s):(i&&t.parent||s)._insertItem(k,this,!0),i&&t!==mt.NO_INSERT&&t!==mt.INSERT&&this.set(t,{internal:!0,insert:!0,project:!0,parent:!0}),i},_serialize:function(t,e){var i={},n=this;function r(s){for(var u in s){var a=n[u];P.equals(a,u==="leading"?s.fontSize*1.2:s[u])||(i[u]=P.serialize(a,t,u!=="data",e))}}return r(this._serializeFields),this instanceof X||r(this._style._defaults),[this._class,i]},_changed:function(t){var e=this._symbol,i=this._parent||e,n=this._project;t&8&&(this._bounds=this._position=this._decomposed=k),t&16&&(this._globalMatrix=k),i&&t&72&&mt._clearBoundsCache(i),t&2&&mt._clearBoundsCache(this),n&&n._changed(t,this),e&&e._changed(t)},getId:function(){return this._id},getName:function(){return this._name},setName:function(t){if(this._name&&this._removeNamed(),t===+t+"")throw new Error("Names consisting only of numbers are not supported.");var e=this._getOwner();if(t&&e){var i=e._children,n=e._namedChildren;(n[t]=n[t]||[]).push(this),t in i||(i[t]=this)}this._name=t||k,this._changed(256)},getStyle:function(){return this._style},setStyle:function(t){this.getStyle().set(t)}},P.each(["locked","visible","blendMode","opacity","guide"],function(t){var e=P.capitalize(t),i="_"+t,n={locked:256,visible:265};this["get"+e]=function(){return this[i]},this["set"+e]=function(r){r!=this[i]&&(this[i]=r,this._changed(n[t]||257))}},{}),{beans:!0,getSelection:function(){return this._selection},setSelection:function(t){if(t!==this._selection){this._selection=t;var e=this._project;e&&(e._updateSelection(this),this._changed(257))}},_changeSelection:function(t,e){var i=this._selection;this.setSelection(e?i|t:i&~t)},isSelected:function(){if(this._selectChildren){for(var t=this._children,e=0,i=t.length;e<i;e++)if(t[e].isSelected())return!0}return!!(this._selection&1)},setSelected:function(t){if(this._selectChildren)for(var e=this._children,i=0,n=e.length;i<n;i++)e[i].setSelected(t);this._changeSelection(1,t)},isFullySelected:function(){var t=this._children,e=!!(this._selection&1);if(t&&e){for(var i=0,n=t.length;i<n;i++)if(!t[i].isFullySelected())return!1;return!0}return e},setFullySelected:function(t){var e=this._children;if(e)for(var i=0,n=e.length;i<n;i++)e[i].setFullySelected(t);this._changeSelection(1,t)},isClipMask:function(){return this._clipMask},setClipMask:function(t){this._clipMask!=(t=!!t)&&(this._clipMask=t,t&&(this.setFillColor(null),this.setStrokeColor(null)),this._changed(257),this._parent&&this._parent._changed(2048))},getData:function(){return this._data||(this._data={}),this._data},setData:function(t){this._data=t},getPosition:function(t){var e=t?R:ee,i=this._position||(this._position=this._getPositionFromBounds());return new e(i.x,i.y,this,"setPosition")},setPosition:function(){this.translate(R.read(arguments).subtract(this.getPosition(!0)))},_getPositionFromBounds:function(t){return this._pivot?this._matrix._transformPoint(this._pivot):(t||this.getBounds()).getCenter(!0)},getPivot:function(){var t=this._pivot;return t?new ee(t.x,t.y,this,"setPivot"):null},setPivot:function(){this._pivot=R.read(arguments,0,{clone:!0,readNull:!0}),this._position=k}},P.each({getStrokeBounds:{stroke:!0},getHandleBounds:{handle:!0},getInternalBounds:{internal:!0}},function(t,e){this[e]=function(i){return this.getBounds(i,t)}},{beans:!0,getBounds:function(t,e){var i=e||t instanceof Ot,n=P.set({},i?e:t,this._boundsOptions);(!n.stroke||this.getStrokeScaling())&&(n.cacheItem=this);var r=this._getCachedBounds(i&&t,n).rect;return arguments.length?r:new Le(r.x,r.y,r.width,r.height,this,"setBounds")},setBounds:function(){var t=ft.read(arguments),e=this.getBounds(),i=this._matrix,n=new Ot,r=t.getCenter();n.translate(r),(t.width!=e.width||t.height!=e.height)&&(i.isInvertible()||(i.set(i._backup||new Ot().translate(i.getTranslation())),e=this.getBounds()),n.scale(e.width!==0?t.width/e.width:0,e.height!==0?t.height/e.height:0)),r=e.getCenter(),n.translate(-r.x,-r.y),this.transform(n)},_getBounds:function(t,e){var i=this._children;return!i||!i.length?new ft:(mt._updateBoundsCache(this,e.cacheItem),mt._getBounds(i,t,e))},_getBoundsCacheKey:function(t,e){return[t.stroke?1:0,t.handle?1:0,e?1:0].join("")},_getCachedBounds:function(t,e,i){t=t&&t._orNullIfIdentity();var n=e.internal&&!i,r=e.cacheItem,s=n?null:this._matrix._orNullIfIdentity(),u=r&&(!t||t.equals(s))&&this._getBoundsCacheKey(e,n),a=this._bounds;if(mt._updateBoundsCache(this._parent||this._symbol,r),u&&a&&u in a){var o=a[u];return{rect:o.rect.clone(),nonscaling:o.nonscaling}}var l=this._getBounds(t||s,e),d=l.rect||l,_=this._style,c=l.nonscaling||_.hasStroke()&&!_.getStrokeScaling();if(u){a||(this._bounds=a={});var o=a[u]={rect:d.clone(),nonscaling:c,internal:n}}return{rect:d,nonscaling:c}},_getStrokeMatrix:function(t,e){var i=this.getStrokeScaling()?null:e&&e.internal?this:this._parent||this._symbol&&this._symbol._item,n=i?i.getViewMatrix().invert():t;return n&&n._shiftless()},statics:{_updateBoundsCache:function(t,e){if(t&&e){var i=e._id,n=t._boundsCache=t._boundsCache||{ids:{},list:[]};n.ids[i]||(n.list.push(e),n.ids[i]=e)}},_clearBoundsCache:function(t){var e=t._boundsCache;if(e){t._bounds=t._position=t._boundsCache=k;for(var i=0,n=e.list,r=n.length;i<r;i++){var s=n[i];s!==t&&(s._bounds=s._position=k,s._boundsCache&&mt._clearBoundsCache(s))}}},_getBounds:function(t,e,i){var n=1/0,r=-n,s=n,u=r,a=!1;i=i||{};for(var o=0,l=t.length;o<l;o++){var d=t[o];if(d._visible&&!d.isEmpty(!0)){var _=d._getCachedBounds(e&&e.appended(d._matrix),i,!0),c=_.rect;n=Math.min(c.x,n),s=Math.min(c.y,s),r=Math.max(c.x+c.width,r),u=Math.max(c.y+c.height,u),_.nonscaling&&(a=!0)}}return{rect:isFinite(n)?new ft(n,s,r-n,u-s):new ft,nonscaling:a}}}}),{beans:!0,_decompose:function(){return this._applyMatrix?null:this._decomposed||(this._decomposed=this._matrix.decompose())},getRotation:function(){var t=this._decompose();return t?t.rotation:0},setRotation:function(t){var e=this.getRotation();if(e!=null&&t!=null){var i=this._decomposed;this.rotate(t-e),i&&(i.rotation=t,this._decomposed=i)}},getScaling:function(){var t=this._decompose(),e=t&&t.scaling;return new ee(e?e.x:1,e?e.y:1,this,"setScaling")},setScaling:function(){var t=this.getScaling(),e=R.read(arguments,0,{clone:!0,readNull:!0});if(t&&e&&!t.equals(e)){var i=this.getRotation(),n=this._decomposed,r=new Ot,s=St.isZero;if(s(t.x)||s(t.y))r.translate(n.translation),i&&r.rotate(i),r.scale(e.x,e.y),this._matrix.set(r);else{var u=this.getPosition(!0);r.translate(u),i&&r.rotate(i),r.scale(e.x/t.x,e.y/t.y),i&&r.rotate(-i),r.translate(u.negate()),this.transform(r)}n&&(n.scaling=e,this._decomposed=n)}},getMatrix:function(){return this._matrix},setMatrix:function(){var t=this._matrix;t.set.apply(t,arguments)},getGlobalMatrix:function(t){var e=this._globalMatrix;if(e)for(var i=this._parent,n=[];i;){if(!i._globalMatrix){e=null;for(var r=0,s=n.length;r<s;r++)n[r]._globalMatrix=null;break}n.push(i),i=i._parent}if(!e){e=this._globalMatrix=this._matrix.clone();var i=this._parent;i&&e.prepend(i.getGlobalMatrix(!0))}return t?e:e.clone()},getViewMatrix:function(){return this.getGlobalMatrix().prepend(this.getView()._matrix)},getApplyMatrix:function(){return this._applyMatrix},setApplyMatrix:function(t){(this._applyMatrix=this._canApplyMatrix&&!!t)&&this.transform(null,!0)},getTransformContent:"#getApplyMatrix",setTransformContent:"#setApplyMatrix"},{getProject:function(){return this._project},_setProject:function(t,e){if(this._project!==t){this._project&&this._installEvents(!1),this._project=t;for(var i=this._children,n=0,r=i&&i.length;n<r;n++)i[n]._setProject(t);e=!0}e&&this._installEvents(!0)},getView:function(){return this._project._view},_installEvents:function t(e){t.base.call(this,e);for(var i=this._children,n=0,r=i&&i.length;n<r;n++)i[n]._installEvents(e)},getLayer:function(){for(var t=this;t=t._parent;)if(t instanceof tt)return t;return null},getParent:function(){return this._parent},setParent:function(t){return t.addChild(this)},_getOwner:"#getParent",getChildren:function(){return this._children},setChildren:function(t){this.removeChildren(),this.addChildren(t)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){var t=this._getOwner();return t&&t._children[this._index+1]||null},getPreviousSibling:function(){var t=this._getOwner();return t&&t._children[this._index-1]||null},getIndex:function(){return this._index},setIndex:function(t){var e=this._parent,i=e&&e._children;i&&e.insertChildren(t in i?t:k,[this])},equals:function(t){return t===this||t&&this._class===t._class&&this._style.equals(t._style)&&this._matrix.equals(t._matrix)&&this._locked===t._locked&&this._visible===t._visible&&this._blendMode===t._blendMode&&this._opacity===t._opacity&&this._clipMask===t._clipMask&&this._guide===t._guide&&this._equals(t)||!1},_equals:function(t){return P.equals(this._children,t._children)},clone:function(t){var e=new this.constructor(mt.NO_INSERT),i=this._children,n=P.pick(t?t.insert:k,t===k||t===!0),r=P.pick(t?t.deep:k,!0);i&&e.copyAttributes(this),(!i||r)&&e.copyContent(this),i||e.copyAttributes(this),n&&e.insertAbove(this);var s=this._name,u=this._parent;if(s&&u){for(var i=u._children,a=s,o=1;i[s];)s=a+" "+o++;s!==a&&e.setName(s)}return e},copyContent:function(t){for(var e=t._children,i=0,n=e&&e.length;i<n;i++)this.addChild(e[i].clone(!1),!0)},copyAttributes:function(t,e){this.setStyle(t._style);for(var i=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide"],n=0,r=i.length;n<r;n++){var s=i[n];t.hasOwnProperty(s)&&(this[s]=t[s])}e||this._matrix.set(t._matrix,!0),this.setApplyMatrix(t._applyMatrix),this.setPivot(t._pivot),this.setSelection(t._selection);var u=t._data,a=t._name;this._data=u?P.clone(u):null,a&&this.setName(a)},rasterize:function(t,e){var i,n,r;P.isPlainObject(t)?(i=t.resolution,n=t.insert,r=t.raster):(i=t,n=e),r||(r=new st(mt.NO_INSERT));var s=this.getStrokeBounds(),u=(i||this.getView().getResolution())/72,a=s.getTopLeft().floor(),o=s.getBottomRight().ceil(),l=new ut(o.subtract(a)),d=l.multiply(u);if(r.setSize(d,!0),!d.isZero()){var _=r.getContext(!0),c=new Ot().scale(u).translate(a.negate());_.save(),c.applyToContext(_),this.draw(_,new P({matrices:[c]})),_.restore()}return r._matrix.set(new Ot().translate(a.add(l.divide(2))).scale(1/u)),(n===k||n)&&r.insertAbove(this),r},contains:function(){var t=this._matrix;return t.isInvertible()&&!!this._contains(t._inverseTransform(R.read(arguments)))},_contains:function(t){var e=this._children;if(e){for(var i=e.length-1;i>=0;i--)if(e[i].contains(t))return!0;return!1}return t.isInside(this.getInternalBounds())},isInside:function(){return ft.read(arguments).contains(this.getBounds())},_asPathItem:function(){return new Pt.Rectangle({rectangle:this.getInternalBounds(),matrix:this._matrix,insert:!1})},intersects:function(t,e){return t instanceof mt?this._asPathItem().getIntersections(t._asPathItem(),null,e,!0).length>0:!1}},new function(){function t(){var n=arguments;return this._hitTest(R.read(n),Ct.getOptions(n))}function e(){var n=arguments,r=R.read(n),s=Ct.getOptions(n),u=[];return this._hitTest(r,new P({all:u},s)),u}function i(n,r,s,u){var a=this._children;if(a)for(var o=a.length-1;o>=0;o--){var l=a[o],d=l!==u&&l._hitTest(n,r,s);if(d&&!r.all)return d}return null}return Ne.inject({hitTest:t,hitTestAll:e,_hitTest:i}),{hitTest:t,hitTestAll:e,_hitTestChildren:i}},{_hitTest:function(t,e,i){if(this._locked||!this._visible||this._guide&&!e.guides||this.isEmpty())return null;var n=this._matrix,r=i?i.appended(n):this.getGlobalMatrix().prepend(this.getView()._matrix),s=Math.max(e.tolerance,1e-12),u=e._tolerancePadding=new ut(Pt._getStrokePadding(s,n._shiftless().invert()));if(t=n._inverseTransform(t),!t||!this._children&&!this.getBounds({internal:!0,stroke:!0,handle:!0}).expand(u.multiply(2))._containsPoint(t))return null;var a=!(e.guides&&!this._guide||e.selected&&!this.isSelected()||e.type&&e.type!==P.hyphenate(this._class)||e.class&&!(this instanceof e.class)),o=e.match,l=this,d,_;function c(h){return h&&o&&!o(h)&&(h=null),h&&e.all&&e.all.push(h),h}function f(h,p){var S=p?d["get"+p]():l.getPosition();if(t.subtract(S).divide(u).length<=1)return new Ct(h,l,{name:p?P.hyphenate(p):h,point:S})}var y=e.position,v=e.center,b=e.bounds;if(a&&this._parent&&(y||v||b)){if((v||b)&&(d=this.getInternalBounds()),_=y&&f("position")||v&&f("center","Center"),!_&&b)for(var g=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],m=0;m<8&&!_;m++)_=f("bounds",g[m]);_=c(_)}return _||(_=this._hitTestChildren(t,e,r)||a&&c(this._hitTestSelf(t,e,r,this.getStrokeScaling()?null:r._shiftless().invert()))||null),_&&_.point&&(_.point=n.transform(_.point)),_},_hitTestSelf:function(t,e){if(e.fill&&this.hasFill()&&this._contains(t))return new Ct("fill",this)},matches:function(t,e){function i(u,a){for(var o in u)if(u.hasOwnProperty(o)){var l=u[o],d=a[o];if(P.isPlainObject(l)&&P.isPlainObject(d)){if(!i(l,d))return!1}else if(!P.equals(l,d))return!1}return!0}var n=typeof t;if(n==="object"){for(var r in t)if(t.hasOwnProperty(r)&&!this.matches(r,t[r]))return!1;return!0}else{if(n==="function")return t(this);if(t==="match")return e(this);var s=/^(empty|editable)$/.test(t)?this["is"+P.capitalize(t)]():t==="type"?P.hyphenate(this._class):this[t];if(t==="class"){if(typeof e=="function")return this instanceof e;s=this._class}if(typeof e=="function")return!!e(s);if(e){if(e.test)return e.test(s);if(P.isPlainObject(e))return i(e,s)}return P.equals(s,e)}},getItems:function(t){return mt._getItems(this,t,this._matrix)},getItem:function(t){return mt._getItems(this,t,this._matrix,null,!0)[0]||null},statics:{_getItems:function t(e,i,n,r,s){if(!r){var u=typeof i=="object"&&i,a=u&&u.overlapping,o=u&&u.inside,l=a||o,c=l&&ft.read([l]);r={items:[],recursive:u&&u.recursive!==!1,inside:!!o,overlapping:!!a,rect:c,path:a&&new Pt.Rectangle({rectangle:c,insert:!1})},u&&(i=P.filter({},i,{recursive:!0,inside:!0,overlapping:!0}))}var d=e._children,_=r.items,c=r.rect;n=c&&(n||new Ot);for(var f=0,y=d&&d.length;f<y;f++){var v=d[f],b=n&&n.appended(v._matrix),g=!0;if(c){var l=v.getBounds(b);if(!c.intersects(l))continue;c.contains(l)||r.overlapping&&(l.contains(c)||r.path.intersects(v,b))||(g=!1)}if(g&&v.matches(i)&&(_.push(v),s)||(r.recursive!==!1&&t(v,i,b,r,s),s&&_.length>0))break}return _}}},{importJSON:function(t){var e=P.importJSON(t,this);return e!==this?this.addChild(e):e},addChild:function(t){return this.insertChild(k,t)},insertChild:function(t,e){var i=e?this.insertChildren(t,[e]):null;return i&&i[0]},addChildren:function(t){return this.insertChildren(this._children.length,t)},insertChildren:function(t,e){var i=this._children;if(i&&e&&e.length>0){e=P.slice(e);for(var n={},r=e.length-1;r>=0;r--){var s=e[r],u=s&&s._id;!s||n[u]?e.splice(r,1):(s._remove(!1,!0),n[u]=!0)}P.splice(i,e,t,0);for(var a=this._project,o=a._changes,r=0,l=e.length;r<l;r++){var s=e[r],d=s._name;s._parent=this,s._setProject(a,!0),d&&s.setName(d),o&&s._changed(5)}this._changed(11)}else e=null;return e},_insertItem:"#insertChild",_insertAt:function(t,e){var i=t&&t._getOwner(),n=t!==this&&i?this:null;return n&&(n._remove(!1,!0),i._insertItem(t._index+e,n)),n},insertAbove:function(t){return this._insertAt(t,1)},insertBelow:function(t){return this._insertAt(t,0)},sendToBack:function(){var t=this._getOwner();return t?t._insertItem(0,this):null},bringToFront:function(){var t=this._getOwner();return t?t._insertItem(k,this):null},appendTop:"#addChild",appendBottom:function(t){return this.insertChild(0,t)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",addTo:function(t){return t._insertItem(k,this)},copyTo:function(t){return this.clone(!1).addTo(t)},reduce:function(t){var e=this._children;if(e&&e.length===1){var i=e[0].reduce(t);return this._parent?(i.insertAbove(this),this.remove()):i.remove(),i}return this},_removeNamed:function(){var t=this._getOwner();if(t){var e=t._children,i=t._namedChildren,n=this._name,r=i[n],s=r?r.indexOf(this):-1;s!==-1&&(e[n]==this&&delete e[n],r.splice(s,1),r.length?e[n]=r[0]:delete i[n])}},_remove:function(t,e){var i=this._getOwner(),n=this._project,r=this._index;return this._style&&this._style._dispose(),i?(this._name&&this._removeNamed(),r!=null&&(n._activeLayer===this&&(n._activeLayer=this.getNextSibling()||this.getPreviousSibling()),P.splice(i._children,null,r,1)),this._installEvents(!1),t&&n._changes&&this._changed(5),e&&i._changed(11,this),this._parent=null,!0):!1},remove:function(){return this._remove(!0,!0)},replaceWith:function(t){var e=t&&t.insertBelow(this);return e&&this.remove(),e},removeChildren:function(t,e){if(!this._children)return null;t=t||0,e=P.pick(e,this._children.length);for(var i=P.splice(this._children,null,t,e-t),n=i.length-1;n>=0;n--)i[n]._remove(!0,!1);return i.length>0&&this._changed(11),i},clear:"#removeChildren",reverseChildren:function(){if(this._children){this._children.reverse();for(var t=0,e=this._children.length;t<e;t++)this._children[t]._index=t;this._changed(11)}},isEmpty:function(t){var e=this._children,i=e?e.length:0;if(t){for(var n=0;n<i;n++)if(!e[n].isEmpty(t))return!1;return!0}return!i},isEditable:function(){for(var t=this;t;){if(!t._visible||t._locked)return!1;t=t._parent}return!0},hasFill:function(){return this.getStyle().hasFill()},hasStroke:function(){return this.getStyle().hasStroke()},hasShadow:function(){return this.getStyle().hasShadow()},_getOrder:function(t){function e(u){var a=[];do a.unshift(u);while(u=u._parent);return a}for(var i=e(this),n=e(t),r=0,s=Math.min(i.length,n.length);r<s;r++)if(i[r]!=n[r])return i[r]._index<n[r]._index?1:-1;return 0},hasChildren:function(){return this._children&&this._children.length>0},isInserted:function(){return this._parent?this._parent.isInserted():!1},isAbove:function(t){return this._getOrder(t)===-1},isBelow:function(t){return this._getOrder(t)===1},isParent:function(t){return this._parent===t},isChild:function(t){return t&&t._parent===this},isDescendant:function(t){for(var e=this;e=e._parent;)if(e===t)return!0;return!1},isAncestor:function(t){return t?t.isDescendant(this):!1},isSibling:function(t){return this._parent===t._parent},isGroupedWith:function(t){for(var e=this._parent;e;){if(e._parent&&/^(Group|Layer|CompoundPath)$/.test(e._class)&&t.isDescendant(e))return!0;e=e._parent}return!1}},P.each(["rotate","scale","shear","skew"],function(t){var e=t==="rotate";this[t]=function(){var i=arguments,n=(e?P:R).read(i),r=R.read(i,0,{readNull:!0});return this.transform(new Ot()[t](n,r||this.getPosition(!0)))}},{translate:function(){var t=new Ot;return this.transform(t.translate.apply(t,arguments))},transform:function(t,e,i){var n=this._matrix,r=t&&!t.isIdentity(),s=i&&this._canApplyMatrix||this._applyMatrix&&(r||!n.isIdentity()||e&&this._children);if(!r&&!s)return this;if(r){!t.isInvertible()&&n.isInvertible()&&(n._backup=n.getValues()),n.prepend(t,!0);var u=this._style,a=u.getFillColor(!0),o=u.getStrokeColor(!0);a&&a.transform(t),o&&o.transform(t)}if(s&&(s=this._transformContent(n,e,i))){var l=this._pivot;l&&n._transformPoint(l,l,!0),n.reset(!0),i&&this._canApplyMatrix&&(this._applyMatrix=!0)}var d=this._bounds,_=this._position;(r||s)&&this._changed(25);var c=r&&d&&t.decompose();if(c&&c.skewing.isZero()&&c.rotation%90===0){for(var f in d){var y=d[f];if(y.nonscaling)delete d[f];else if(s||!y.internal){var v=y.rect;t._transformBounds(v,v)}}this._bounds=d;var b=d[this._getBoundsCacheKey(this._boundsOptions||{})];b&&(this._position=this._getPositionFromBounds(b.rect))}else r&&_&&this._pivot&&(this._position=t._transformPoint(_,_));return this},_transformContent:function(t,e,i){var n=this._children;if(n){for(var r=0,s=n.length;r<s;r++)n[r].transform(t,e,i);return!0}},globalToLocal:function(){return this.getGlobalMatrix(!0)._inverseTransform(R.read(arguments))},localToGlobal:function(){return this.getGlobalMatrix(!0)._transformPoint(R.read(arguments))},parentToLocal:function(){return this._matrix._inverseTransform(R.read(arguments))},localToParent:function(){return this._matrix._transformPoint(R.read(arguments))},fitBounds:function(t,e){t=ft.read(arguments);var i=this.getBounds(),n=i.height/i.width,r=t.height/t.width,s=(e?n>r:n<r)?t.width/i.width:t.height/i.height,u=new ft(new R,new ut(i.width*s,i.height*s));u.setCenter(t.getCenter()),this.setBounds(u)}}),{_setStyles:function(t,e,i){var n=this._style,r=this._matrix;if(n.hasFill()&&(t.fillStyle=n.getFillColor().toCanvasStyle(t,r)),n.hasStroke()){t.strokeStyle=n.getStrokeColor().toCanvasStyle(t,r),t.lineWidth=n.getStrokeWidth();var s=n.getStrokeJoin(),u=n.getStrokeCap(),a=n.getMiterLimit();if(s&&(t.lineJoin=s),u&&(t.lineCap=u),a&&(t.miterLimit=a),bt.support.nativeDash){var o=n.getDashArray(),l=n.getDashOffset();o&&o.length&&("setLineDash"in t?(t.setLineDash(o),t.lineDashOffset=l):(t.mozDash=o,t.mozDashOffset=l))}}if(n.hasShadow()){var d=e.pixelRatio||1,_=i._shiftless().prepend(new Ot().scale(d,d)),c=_.transform(new R(n.getShadowBlur(),0)),f=_.transform(this.getShadowOffset());t.shadowColor=n.getShadowColor().toCanvasStyle(t),t.shadowBlur=c.getLength(),t.shadowOffsetX=f.x,t.shadowOffsetY=f.y}},draw:function(t,e,i){if(this._updateVersion=this._project._updateVersion,!(!this._visible||this._opacity===0)){var n=e.matrices,r=e.viewMatrix,s=this._matrix,u=n[n.length-1].appended(s);if(u.isInvertible()){r=r?r.appended(u):u,n.push(u),e.updateMatrix&&(this._globalMatrix=u);var a=this._blendMode,o=St.clamp(this._opacity,0,1),l=a==="normal",d=gi.nativeModes[a],_=l&&o===1||e.dontStart||e.clip||(d||l&&o<1)&&this._canComposite(),c=e.pixelRatio||1,f,y,v;if(!_){var b=this.getStrokeBounds(r);if(!b.width||!b.height){n.pop();return}v=e.offset,y=e.offset=b.getTopLeft().floor(),f=t,t=Ut.getContext(b.getSize().ceil().add(1).multiply(c)),c!==1&&t.scale(c,c)}t.save();var g=i?i.appended(s):this._canScaleStroke&&!this.getStrokeScaling(!0)&&r,m=!_&&e.clipItem,h=!g||m;if(_?(t.globalAlpha=o,d&&(t.globalCompositeOperation=a)):h&&t.translate(-y.x,-y.y),h&&(_?s:r).applyToContext(t),m&&e.clipItem.draw(t,e.extend({clip:!0})),g){t.setTransform(c,0,0,c,0,0);var p=e.offset;p&&t.translate(-p.x,-p.y)}this._draw(t,e,r,g),t.restore(),n.pop(),e.clip&&!e.dontFinish&&t.clip(this.getFillRule()),_||(gi.process(a,t,f,o,y.subtract(v).multiply(c)),Ut.release(t),e.offset=v)}}},_isUpdated:function(t){var e=this._parent;if(e instanceof pe)return e._isUpdated(t);var i=this._updateVersion===t;return!i&&e&&e._visible&&e._isUpdated(t)&&(this._updateVersion=t,i=!0),i},_drawSelection:function(t,e,i,n,r){var s=this._selection,u=s&1,a=s&2||u&&this._selectBounds,o=s&4;if(this._drawSelected||(u=!1),(u||a||o)&&this._isUpdated(r)){var l,d=this.getSelectedColor(!0)||(l=this.getLayer())&&l.getSelectedColor(!0),_=e.appended(this.getGlobalMatrix(!0)),c=i/2;if(t.strokeStyle=t.fillStyle=d?d.toCanvasStyle(t):"#009dec",u&&this._drawSelected(t,_,n),o){var f=this.getPosition(!0),y=this._parent,v=y?y.localToGlobal(f):f,b=v.x,g=v.y;t.beginPath(),t.arc(b,g,c,0,Math.PI*2,!0),t.stroke();for(var m=[[0,-1],[1,0],[0,1],[-1,0]],h=c,p=i+1,S=0;S<4;S++){var x=m[S],w=x[0],C=x[1];t.moveTo(b+w*h,g+C*h),t.lineTo(b+w*p,g+C*p),t.stroke()}}if(a){var T=_._transformCorners(this.getInternalBounds());t.beginPath();for(var S=0;S<8;S++)t[S?"lineTo":"moveTo"](T[S],T[++S]);t.closePath(),t.stroke();for(var S=0;S<8;S++)t.fillRect(T[S]-c,T[++S]-c,i,i)}}},_canComposite:function(){return!1}},P.each(["down","drag","up","move"],function(t){this["removeOn"+P.capitalize(t)]=function(){var e={};return e[t]=!0,this.removeOn(e)}},{removeOn:function(t){for(var e in t)if(t[e]){var i="mouse"+e,n=this._project,r=n._removeSets=n._removeSets||{};r[i]=r[i]||{},r[i][this._id]=this}return this}}),{tween:function(t,e,i){i||(i=e,e=t,t=null,i||(i=e,e=null));var n=i&&i.easing,r=i&&i.start,s=i!=null&&(typeof i=="number"?i:i.duration),u=new Rn(this,t,e,s,n,r);function a(o){u._handleFrame(o.time*1e3),u.running||this.off("frame",a)}return s&&this.on("frame",a),u},tweenTo:function(t,e){return this.tween(null,t,e)},tweenFrom:function(t,e){return this.tween(t,null,e)}}),X=mt.extend({_class:"Group",_selectBounds:!1,_selectChildren:!0,_serializeFields:{children:[]},initialize:function(e){this._children=[],this._namedChildren={},this._initialize(e)||this.addChildren(Array.isArray(e)?e:arguments)},_changed:function t(e){t.base.call(this,e),e&2050&&(this._clipItem=k)},_getClipItem:function(){var t=this._clipItem;if(t===k){t=null;for(var e=this._children,i=0,n=e.length;i<n;i++)if(e[i]._clipMask){t=e[i];break}this._clipItem=t}return t},isClipped:function(){return!!this._getClipItem()},setClipped:function(t){var e=this.getFirstChild();e&&e.setClipMask(t)},_getBounds:function t(e,i){var n=this._getClipItem();return n?n._getCachedBounds(n._matrix.prepended(e),P.set({},i,{stroke:!1})):t.base.call(this,e,i)},_hitTestChildren:function t(e,i,n){var r=this._getClipItem();return(!r||r.contains(e))&&t.base.call(this,e,i,n,r)},_draw:function(t,e){var i=e.clip,n=!i&&this._getClipItem();e=e.extend({clipItem:n,clip:!1}),i?(t.beginPath(),e.dontStart=e.dontFinish=!0):n&&n.draw(t,e.extend({clip:!0}));for(var r=this._children,s=0,u=r.length;s<u;s++){var a=r[s];a!==n&&a.draw(t,e)}}}),tt=X.extend({_class:"Layer",initialize:function(){X.apply(this,arguments)},_getOwner:function(){return this._parent||this._index!=null&&this._project},isInserted:function t(){return this._parent?t.base.call(this):this._index!=null},activate:function(){this._project._activeLayer=this},_hitTestSelf:function(){}}),Y=mt.extend({_class:"Shape",_applyMatrix:!1,_canApplyMatrix:!1,_canScaleStroke:!0,_serializeFields:{type:null,size:null,radius:null},initialize:function(e,i){this._initialize(e,i)},_equals:function(t){return this._type===t._type&&this._size.equals(t._size)&&P.equals(this._radius,t._radius)},copyContent:function(t){this.setType(t._type),this.setSize(t._size),this.setRadius(t._radius)},getType:function(){return this._type},setType:function(t){this._type=t},getShape:"#getType",setShape:"#setType",getSize:function(){var t=this._size;return new ne(t.width,t.height,this,"setSize")},setSize:function(){var t=ut.read(arguments);if(!this._size)this._size=t.clone();else if(!this._size.equals(t)){var e=this._type,i=t.width,n=t.height;e==="rectangle"?this._radius.set(ut.min(this._radius,t.divide(2).abs())):e==="circle"?(i=n=(i+n)/2,this._radius=i/2):e==="ellipse"&&this._radius._set(i/2,n/2),this._size._set(i,n),this._changed(9)}},getRadius:function(){var t=this._radius;return this._type==="circle"?t:new ne(t.width,t.height,this,"setRadius")},setRadius:function(t){var e=this._type;if(e==="circle"){if(t===this._radius)return;var i=t*2;this._radius=t,this._size._set(i,i)}else if(t=ut.read(arguments),!this._radius)this._radius=t.clone();else{if(this._radius.equals(t))return;if(this._radius.set(t),e==="rectangle"){var i=ut.max(this._size,t.multiply(2));this._size.set(i)}else e==="ellipse"&&this._size._set(t.width*2,t.height*2)}this._changed(9)},isEmpty:function(){return!1},toPath:function(t){var e=new Pt[P.capitalize(this._type)]({center:new R,size:this._size,radius:this._radius,insert:!1});return e.copyAttributes(this),bt.settings.applyMatrix&&e.setApplyMatrix(!0),(t===k||t)&&e.insertAbove(this),e},toShape:"#clone",_asPathItem:function(){return this.toPath(!1)},_draw:function(t,e,i,n){var r=this._style,s=r.hasFill(),u=r.hasStroke(),a=e.dontFinish||e.clip,o=!n;if(s||u||a){var l=this._type,d=this._radius,_=l==="circle";if(e.dontStart||t.beginPath(),o&&_)t.arc(0,0,d,0,Math.PI*2,!0);else{var c=_?d:d.width,f=_?d:d.height,y=this._size,v=y.width,b=y.height;if(o&&l==="rectangle"&&c===0&&f===0)t.rect(-v/2,-b/2,v,b);else{var g=v/2,m=b/2,h=1-.5522847498307936,p=c*h,S=f*h,x=[-g,-m+f,-g,-m+S,-g+p,-m,-g+c,-m,g-c,-m,g-p,-m,g,-m+S,g,-m+f,g,m-f,g,m-S,g-p,m,g-c,m,-g+c,m,-g+p,m,-g,m-S,-g,m-f];n&&n.transform(x,x,32),t.moveTo(x[0],x[1]),t.bezierCurveTo(x[2],x[3],x[4],x[5],x[6],x[7]),g!==c&&t.lineTo(x[8],x[9]),t.bezierCurveTo(x[10],x[11],x[12],x[13],x[14],x[15]),m!==f&&t.lineTo(x[16],x[17]),t.bezierCurveTo(x[18],x[19],x[20],x[21],x[22],x[23]),g!==c&&t.lineTo(x[24],x[25]),t.bezierCurveTo(x[26],x[27],x[28],x[29],x[30],x[31])}}t.closePath()}!a&&(s||u)&&(this._setStyles(t,e,i),s&&(t.fill(r.getFillRule()),t.shadowColor="rgba(0,0,0,0)"),u&&t.stroke())},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_getBounds:function(t,e){var i=new ft(this._size).setCenter(0,0),n=this._style,r=e.stroke&&n.hasStroke()&&n.getStrokeWidth();return t&&(i=t._transformBounds(i)),r?i.expand(Pt._getStrokePadding(r,this._getStrokeMatrix(t,e))):i}},new function(){function t(i,n,r){var s=i._radius;if(!s.isZero())for(var u=i._size.divide(2),a=1;a<=4;a++){var o=new R(a>1&&a<4?-1:1,a>2?-1:1),l=o.multiply(u),d=l.subtract(o.multiply(s)),_=new ft(r?l.add(o.multiply(r)):l,d);if(_.contains(n))return{point:d,quadrant:a}}}function e(i,n,r,s){var u=i.divide(n);return(!s||u.isInQuadrant(s))&&u.subtract(u.normalize()).multiply(n).divide(r).length<=1}return{_contains:function i(n){if(this._type==="rectangle"){var r=t(this,n);return r?n.subtract(r.point).divide(this._radius).getLength()<=1:i.base.call(this,n)}else return n.divide(this.size).getLength()<=.5},_hitTestSelf:function i(n,r,s,u){var a=!1,o=this._style,l=r.stroke&&o.hasStroke(),d=r.fill&&o.hasFill();if(l||d){var _=this._type,c=this._radius,f=l?o.getStrokeWidth()/2:0,y=r._tolerancePadding.add(Pt._getStrokePadding(f,!o.getStrokeScaling()&&u));if(_==="rectangle"){var v=y.multiply(2),b=t(this,n,v);if(b)a=e(n.subtract(b.point),c,y,b.quadrant);else{var g=new ft(this._size).setCenter(0,0),m=g.expand(v),h=g.expand(v.negate());a=m._containsPoint(n)&&!h._containsPoint(n)}}else a=e(n,c,y)}return a?new Ct(l?"stroke":"fill",this):i.base.apply(this,arguments)}}},{statics:new function(){function t(e,i,n,r,s){var u=P.create(Y.prototype);return u._type=e,u._size=n,u._radius=r,u._initialize(P.getNamed(s),i),u}return{Circle:function(){var e=arguments,i=R.readNamed(e,"center"),n=P.readNamed(e,"radius");return t("circle",i,new ut(n*2),n,e)},Rectangle:function(){var e=arguments,i=ft.readNamed(e,"rectangle"),n=ut.min(ut.readNamed(e,"radius"),i.getSize(!0).divide(2));return t("rectangle",i.getCenter(!0),i.getSize(!0),n,e)},Ellipse:function(){var e=arguments,i=Y._readEllipse(e),n=i.radius;return t("ellipse",i.center,n.multiply(2),n,e)},_readEllipse:function(e){var i,n;if(P.hasNamed(e,"radius"))i=R.readNamed(e,"center"),n=ut.readNamed(e,"radius");else{var r=ft.readNamed(e,"rectangle");i=r.getCenter(!0),n=r.getSize(!0).divide(2)}return{center:i,radius:n}}}}}),st=mt.extend({_class:"Raster",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!1,handle:!1},_serializeFields:{crossOrigin:null,source:null},_prioritize:["crossOrigin"],_smoothing:"low",beans:!0,initialize:function(e,i){if(!this._initialize(e,i!==k&&R.read(arguments))){var n,r=typeof e,s=r==="string"?q.getElementById(e):r==="object"?e:null;if(s&&s!==mt.NO_INSERT){if(s.getContext||s.naturalHeight!=null)n=s;else if(s){var u=ut.read(arguments);u.isZero()||(n=Ut.getCanvas(u))}}n?this.setImage(n):this.setSource(e)}this._size||(this._size=new ut,this._loaded=!1)},_equals:function(t){return this.getSource()===t.getSource()},copyContent:function(t){var e=t._image,i=t._canvas;if(e)this._setImage(e);else if(i){var n=Ut.getCanvas(t._size);n.getContext("2d").drawImage(i,0,0),this._setImage(n)}this._crossOrigin=t._crossOrigin},getSize:function(){var t=this._size;return new ne(t?t.width:0,t?t.height:0,this,"setSize")},setSize:function(t,e){var i=ut.read(arguments);if(i.equals(this._size))e&&this.clear();else if(i.width>0&&i.height>0){var n=!e&&this.getElement();this._setImage(Ut.getCanvas(i)),n&&this.getContext(!0).drawImage(n,0,0,i.width,i.height)}else this._canvas&&Ut.release(this._canvas),this._size=i.clone()},getWidth:function(){return this._size?this._size.width:0},setWidth:function(t){this.setSize(t,this.getHeight())},getHeight:function(){return this._size?this._size.height:0},setHeight:function(t){this.setSize(this.getWidth(),t)},getLoaded:function(){return this._loaded},isEmpty:function(){var t=this._size;return!t||t.width===0&&t.height===0},getResolution:function(){var t=this._matrix,e=new R(0,0).transform(t),i=new R(1,0).transform(t).subtract(e),n=new R(0,1).transform(t).subtract(e);return new ut(72/i.getLength(),72/n.getLength())},getPpi:"#getResolution",getImage:function(){return this._image},setImage:function(t){var e=this;function i(n){var r=e.getView(),s=n&&n.type||"load";r&&e.responds(s)&&(bt=r._scope,e.emit(s,new Ye(n)))}this._setImage(t),this._loaded?setTimeout(i,0):t&&Ht.add(t,{load:function(n){e._setImage(t),i(n)},error:i})},_setImage:function(t){this._canvas&&Ut.release(this._canvas),t&&t.getContext?(this._image=null,this._canvas=t,this._loaded=!0):(this._image=t,this._canvas=null,this._loaded=!!(t&&t.src&&t.complete)),this._size=new ut(t?t.naturalWidth||t.width:0,t?t.naturalHeight||t.height:0),this._context=null,this._changed(1033)},getCanvas:function(){if(!this._canvas){var t=Ut.getContext(this._size);try{this._image&&t.drawImage(this._image,0,0),this._canvas=t.canvas}catch{Ut.release(t)}}return this._canvas},setCanvas:"#setImage",getContext:function(t){return this._context||(this._context=this.getCanvas().getContext("2d")),t&&(this._image=null,this._changed(1025)),this._context},setContext:function(t){this._context=t},getSource:function(){var t=this._image;return t&&t.src||this.toDataURL()},setSource:function(t){var e=new A.Image,i=this._crossOrigin;i&&(e.crossOrigin=i),t&&(e.src=t),this.setImage(e)},getCrossOrigin:function(){var t=this._image;return t&&t.crossOrigin||this._crossOrigin||""},setCrossOrigin:function(t){this._crossOrigin=t;var e=this._image;e&&(e.crossOrigin=t)},getSmoothing:function(){return this._smoothing},setSmoothing:function(t){this._smoothing=typeof t=="string"?t:t?"low":"off",this._changed(257)},getElement:function(){return this._canvas||this._loaded&&this._image}},{beans:!1,getSubCanvas:function(){var t=ft.read(arguments),e=Ut.getContext(t.getSize());return e.drawImage(this.getCanvas(),t.x,t.y,t.width,t.height,0,0,t.width,t.height),e.canvas},getSubRaster:function(){var t=ft.read(arguments),e=new st(mt.NO_INSERT);return e._setImage(this.getSubCanvas(t)),e.translate(t.getCenter().subtract(this.getSize().divide(2))),e._matrix.prepend(this._matrix),e.insertAbove(this),e},toDataURL:function(){var t=this._image,e=t&&t.src;if(/^data:/.test(e))return e;var i=this.getCanvas();return i?i.toDataURL.apply(i,arguments):null},drawImage:function(t){var e=R.read(arguments,1);this.getContext(!0).drawImage(t,e.x,e.y)},getAverageColor:function(t){var e,i;if(t?t instanceof re?(i=t,e=t.getBounds()):typeof t=="object"&&("width"in t?e=new ft(t):"x"in t&&(e=new ft(t.x-.5,t.y-.5,1,1))):e=this.getBounds(),!e)return null;var n=32,r=Math.min(e.width,n),s=Math.min(e.height,n),u=st._sampleContext;u?u.clearRect(0,0,n+1,n+1):u=st._sampleContext=Ut.getContext(new ut(n)),u.save();var a=new Ot().scale(r/e.width,s/e.height).translate(-e.x,-e.y);a.applyToContext(u),i&&i.draw(u,new P({clip:!0,matrices:[a]})),this._matrix.applyToContext(u);var o=this.getElement(),l=this._size;o&&u.drawImage(o,-l.width/2,-l.height/2),u.restore();for(var d=u.getImageData(.5,.5,Math.ceil(r),Math.ceil(s)).data,_=[0,0,0],c=0,f=0,y=d.length;f<y;f+=4){var v=d[f+3];c+=v,v/=255,_[0]+=d[f]*v,_[1]+=d[f+1]*v,_[2]+=d[f+2]*v}for(var f=0;f<3;f++)_[f]/=c;return c?Vt.read(_):null},getPixel:function(){var t=R.read(arguments),e=this.getContext().getImageData(t.x,t.y,1,1).data;return new Vt("rgb",[e[0]/255,e[1]/255,e[2]/255],e[3]/255)},setPixel:function(){var t=arguments,e=R.read(t),i=Vt.read(t),n=i._convert("rgb"),r=i._alpha,s=this.getContext(!0),u=s.createImageData(1,1),a=u.data;a[0]=n[0]*255,a[1]=n[1]*255,a[2]=n[2]*255,a[3]=r!=null?r*255:255,s.putImageData(u,e.x,e.y)},clear:function(){var t=this._size;this.getContext(!0).clearRect(0,0,t.width+1,t.height+1)},createImageData:function(){var t=ut.read(arguments);return this.getContext().createImageData(t.width,t.height)},getImageData:function(){var t=ft.read(arguments);return t.isEmpty()&&(t=new ft(this._size)),this.getContext().getImageData(t.x,t.y,t.width,t.height)},putImageData:function(t){var e=R.read(arguments,1);this.getContext(!0).putImageData(t,e.x,e.y)},setImageData:function(t){this.setSize(t),this.getContext(!0).putImageData(t,0,0)},_getBounds:function(t,e){var i=new ft(this._size).setCenter(0,0);return t?t._transformBounds(i):i},_hitTestSelf:function(t){if(this._contains(t)){var e=this;return new Ct("pixel",e,{offset:t.add(e._size.divide(2)).round(),color:{get:function(){return e.getPixel(this.offset)}}})}},_draw:function(t,e,i){var n=this.getElement();if(n&&n.width>0&&n.height>0){t.globalAlpha=St.clamp(this._opacity,0,1),this._setStyles(t,e,i);var r=this._smoothing,s=r==="off";Lt.setPrefixed(t,s?"imageSmoothingEnabled":"imageSmoothingQuality",s?!1:r),t.drawImage(n,-this._size.width/2,-this._size.height/2)}},_canComposite:function(){return!0}}),lt=mt.extend({_class:"SymbolItem",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!0},_serializeFields:{symbol:null},initialize:function(e,i){this._initialize(e,i!==k&&R.read(arguments,1))||this.setDefinition(e instanceof xt?e:new xt(e))},_equals:function(t){return this._definition===t._definition},copyContent:function(t){this.setDefinition(t._definition)},getDefinition:function(){return this._definition},setDefinition:function(t){this._definition=t,this._changed(9)},getSymbol:"#getDefinition",setSymbol:"#setDefinition",isEmpty:function(){return this._definition._item.isEmpty()},_getBounds:function(t,e){var i=this._definition._item;return i._getCachedBounds(i._matrix.prepended(t),e)},_hitTestSelf:function(t,e,i){var n=e.extend({all:!1}),r=this._definition._item._hitTest(t,n,i);return r&&(r.item=this),r},_draw:function(t,e){this._definition._item.draw(t,e)}}),xt=P.extend({_class:"SymbolDefinition",initialize:function(e,i){this._id=ze.get(),this.project=bt.project,e&&this.setItem(e,i)},_serialize:function(t,e){return e.add(this,function(){return P.serialize([this._class,this._item],t,!1,e)})},_changed:function(t){t&8&&mt._clearBoundsCache(this),t&1&&this.project._changed(t)},getItem:function(){return this._item},setItem:function(t,e){t._symbol&&(t=t.clone()),this._item&&(this._item._symbol=null),this._item=t,t.remove(),t.setSelected(!1),e||t.setPosition(new R),t._symbol=this,this._changed(9)},getDefinition:"#getItem",setDefinition:"#setItem",place:function(t){return new lt(this,t)},clone:function(){return new xt(this._item.clone(!1))},equals:function(t){return t===this||t&&this._item.equals(t._item)||!1}}),Ct=P.extend({_class:"HitResult",initialize:function(e,i,n){this.type=e,this.item=i,n&&this.inject(n)},statics:{getOptions:function(t){var e=t&&P.read(t);return new P({type:null,tolerance:bt.settings.hitTolerance,fill:!e,stroke:!e,segments:!e,handles:!1,ends:!1,position:!1,center:!1,bounds:!1,guides:!1,selected:!1},e)}}}),at=P.extend({_class:"Segment",beans:!0,_selection:0,initialize:function(e,i,n,r,s,u){var a=arguments.length,o,l,d,_;a>0&&(e==null||typeof e=="object"?a===1&&e&&"point"in e?(o=e.point,l=e.handleIn,d=e.handleOut,_=e.selection):(o=e,l=i,d=n,_=r):(o=[e,i],l=n!==k?[n,r]:null,d=s!==k?[s,u]:null)),new ve(o,this,"_point"),new ve(l,this,"_handleIn"),new ve(d,this,"_handleOut"),_&&this.setSelection(_)},_serialize:function(t,e){var i=this._point,n=this._selection,r=n||this.hasHandles()?[i,this._handleIn,this._handleOut]:i;return n&&r.push(n),P.serialize(r,t,!0,e)},_changed:function(t){var e=this._path;if(e){var i=e._curves,n=this._index,r;i&&((!t||t===this._point||t===this._handleIn)&&(r=n>0?i[n-1]:e._closed?i[i.length-1]:null)&&r._changed(),(!t||t===this._point||t===this._handleOut)&&(r=i[n])&&r._changed()),e._changed(41)}},getPoint:function(){return this._point},setPoint:function(){this._point.set(R.read(arguments))},getHandleIn:function(){return this._handleIn},setHandleIn:function(){this._handleIn.set(R.read(arguments))},getHandleOut:function(){return this._handleOut},setHandleOut:function(){this._handleOut.set(R.read(arguments))},hasHandles:function(){return!this._handleIn.isZero()||!this._handleOut.isZero()},isSmooth:function(){var t=this._handleIn,e=this._handleOut;return!t.isZero()&&!e.isZero()&&t.isCollinear(e)},clearHandles:function(){this._handleIn._set(0,0),this._handleOut._set(0,0)},getSelection:function(){return this._selection},setSelection:function(t){var e=this._selection,i=this._path;this._selection=t=t||0,i&&t!==e&&(i._updateSelection(this,e,t),i._changed(257))},_changeSelection:function(t,e){var i=this._selection;this.setSelection(e?i|t:i&~t)},isSelected:function(){return!!(this._selection&7)},setSelected:function(t){this._changeSelection(7,t)},getIndex:function(){return this._index!==k?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var t=this._path,e=this._index;return t?(e>0&&!t._closed&&e===t._segments.length-1&&e--,t.getCurves()[e]||null):null},getLocation:function(){var t=this.getCurve();return t?new Xt(t,this===t._segment1?0:1):null},getNext:function(){var t=this._path&&this._path._segments;return t&&(t[this._index+1]||this._path._closed&&t[0])||null},smooth:function(t,e,i){var n=t||{},r=n.type,s=n.factor,u=this.getPrevious(),a=this.getNext(),o=(u||this)._point,l=this._point,d=(a||this)._point,_=o.getDistance(l),c=l.getDistance(d);if(!r||r==="catmull-rom"){var f=s===k?.5:s,y=Math.pow(_,f),v=y*y,b=Math.pow(c,f),g=b*b;if(!e&&u){var m=2*g+3*b*y+v,h=3*b*(b+y);this.setHandleIn(h!==0?new R((g*o._x+m*l._x-v*d._x)/h-l._x,(g*o._y+m*l._y-v*d._y)/h-l._y):new R)}if(!i&&a){var m=2*v+3*y*b+g,h=3*y*(y+b);this.setHandleOut(h!==0?new R((v*d._x+m*l._x-g*o._x)/h-l._x,(v*d._y+m*l._y-g*o._y)/h-l._y):new R)}}else if(r==="geometric"){if(u&&a){var p=o.subtract(d),S=s===k?.4:s,x=S*_/(_+c);e||this.setHandleIn(p.multiply(x)),i||this.setHandleOut(p.multiply(x-S))}}else throw new Error("Smoothing method '"+r+"' not supported.")},getPrevious:function(){var t=this._path&&this._path._segments;return t&&(t[this._index-1]||this._path._closed&&t[t.length-1])||null},isFirst:function(){return!this._index},isLast:function(){var t=this._path;return t&&this._index===t._segments.length-1||!1},reverse:function(){var t=this._handleIn,e=this._handleOut,i=t.clone();t.set(e),e.set(i)},reversed:function(){return new at(this._point,this._handleOut,this._handleIn)},remove:function(){return this._path?!!this._path.removeSegment(this._index):!1},clone:function(){return new at(this._point,this._handleIn,this._handleOut)},equals:function(t){return t===this||t&&this._class===t._class&&this._point.equals(t._point)&&this._handleIn.equals(t._handleIn)&&this._handleOut.equals(t._handleOut)||!1},toString:function(){var t=["point: "+this._point];return this._handleIn.isZero()||t.push("handleIn: "+this._handleIn),this._handleOut.isZero()||t.push("handleOut: "+this._handleOut),"{ "+t.join(", ")+" }"},transform:function(t){this._transformCoordinates(t,new Array(6),!0),this._changed()},interpolate:function(t,e,i){var n=1-i,r=i,s=t._point,u=e._point,a=t._handleIn,o=e._handleIn,l=e._handleOut,d=t._handleOut;this._point._set(n*s._x+r*u._x,n*s._y+r*u._y,!0),this._handleIn._set(n*a._x+r*o._x,n*a._y+r*o._y,!0),this._handleOut._set(n*d._x+r*l._x,n*d._y+r*l._y,!0),this._changed()},_transformCoordinates:function(t,e,i){var n=this._point,r=!i||!this._handleIn.isZero()?this._handleIn:null,s=!i||!this._handleOut.isZero()?this._handleOut:null,u=n._x,a=n._y,o=2;return e[0]=u,e[1]=a,r&&(e[o++]=r._x+u,e[o++]=r._y+a),s&&(e[o++]=s._x+u,e[o++]=s._y+a),t&&(t._transformCoordinates(e,e,o/2),u=e[0],a=e[1],i?(n._x=u,n._y=a,o=2,r&&(r._x=e[o++]-u,r._y=e[o++]-a),s&&(s._x=e[o++]-u,s._y=e[o++]-a)):(r||(e[o++]=u,e[o++]=a),s||(e[o++]=u,e[o++]=a))),e}}),ve=R.extend({initialize:function(e,i,n){var r,s,u;if(!e)r=s=0;else if((r=e[0])!==k)s=e[1];else{var a=e;(r=a.x)===k&&(a=R.read(arguments),r=a.x),s=a.y,u=a.selected}this._x=r,this._y=s,this._owner=i,i[n]=this,u&&this.setSelected(!0)},_set:function(t,e){return this._x=t,this._y=e,this._owner._changed(this),this},getX:function(){return this._x},setX:function(t){this._x=t,this._owner._changed(this)},getY:function(){return this._y},setY:function(t){this._y=t,this._owner._changed(this)},isZero:function(){var t=St.isZero;return t(this._x)&&t(this._y)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(t){this._owner._changeSelection(this._getSelection(),t)},_getSelection:function(){var t=this._owner;return this===t._point?1:this===t._handleIn?2:this===t._handleOut?4:0}}),J=P.extend({_class:"Curve",beans:!0,initialize:function(e,i,n,r,s,u,a,o){var l=arguments.length,d,_,c,f,y,v;l===3?(this._path=e,d=i,_=n):l?l===1?"segment1"in e?(d=new at(e.segment1),_=new at(e.segment2)):"point1"in e?(c=e.point1,y=e.handle1,v=e.handle2,f=e.point2):Array.isArray(e)&&(c=[e[0],e[1]],f=[e[6],e[7]],y=[e[2]-e[0],e[3]-e[1]],v=[e[4]-e[6],e[5]-e[7]]):l===2?(d=new at(e),_=new at(i)):l===4?(c=e,y=i,v=n,f=r):l===8&&(c=[e,i],f=[a,o],y=[n-e,r-i],v=[s-a,u-o]):(d=new at,_=new at),this._segment1=d||new at(c,null,y),this._segment2=_||new at(f,v,null)},_serialize:function(t,e){return P.serialize(this.hasHandles()?[this.getPoint1(),this.getHandle1(),this.getHandle2(),this.getPoint2()]:[this.getPoint1(),this.getPoint2()],t,!0,e)},_changed:function(){this._length=this._bounds=k},clone:function(){return new J(this._segment1,this._segment2)},toString:function(){var t=["point1: "+this._segment1._point];return this._segment1._handleOut.isZero()||t.push("handle1: "+this._segment1._handleOut),this._segment2._handleIn.isZero()||t.push("handle2: "+this._segment2._handleIn),t.push("point2: "+this._segment2._point),"{ "+t.join(", ")+" }"},classify:function(){return J.classify(this.getValues())},remove:function(){var t=!1;if(this._path){var e=this._segment2,i=e._handleOut;t=e.remove(),t&&this._segment1._handleOut.set(i)}return t},getPoint1:function(){return this._segment1._point},setPoint1:function(){this._segment1._point.set(R.read(arguments))},getPoint2:function(){return this._segment2._point},setPoint2:function(){this._segment2._point.set(R.read(arguments))},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(){this._segment1._handleOut.set(R.read(arguments))},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(){this._segment2._handleIn.set(R.read(arguments))},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var t=this._path&&this._path._curves;return t&&(t[this._segment1._index+1]||this._path._closed&&t[0])||null},getPrevious:function(){var t=this._path&&this._path._curves;return t&&(t[this._segment1._index-1]||this._path._closed&&t[t.length-1])||null},isFirst:function(){return!this._segment1._index},isLast:function(){var t=this._path;return t&&this._segment1._index===t._curves.length-1||!1},isSelected:function(){return this.getPoint1().isSelected()&&this.getHandle1().isSelected()&&this.getHandle2().isSelected()&&this.getPoint2().isSelected()},setSelected:function(t){this.getPoint1().setSelected(t),this.getHandle1().setSelected(t),this.getHandle2().setSelected(t),this.getPoint2().setSelected(t)},getValues:function(t){return J.getValues(this._segment1,this._segment2,t)},getPoints:function(){for(var t=this.getValues(),e=[],i=0;i<8;i+=2)e.push(new R(t[i],t[i+1]));return e}},{getLength:function(){return this._length==null&&(this._length=J.getLength(this.getValues(),0,1)),this._length},getArea:function(){return J.getArea(this.getValues())},getLine:function(){return new Bt(this._segment1._point,this._segment2._point)},getPart:function(t,e){return new J(J.getPart(this.getValues(),t,e))},getPartLength:function(t,e){return J.getLength(this.getValues(),t,e)},divideAt:function(t){return this.divideAtTime(t&&t.curve===this?t.time:this.getTimeAt(t))},divideAtTime:function(t,e){var i=1e-8,n=1-i,r=null;if(t>=i&&t<=n){var s=J.subdivide(this.getValues(),t),u=s[0],a=s[1],o=e||this.hasHandles(),l=this._segment1,d=this._segment2,_=this._path;o&&(l._handleOut._set(u[2]-u[0],u[3]-u[1]),d._handleIn._set(a[4]-a[6],a[5]-a[7]));var c=u[6],f=u[7],y=new at(new R(c,f),o&&new R(u[4]-c,u[5]-f),o&&new R(a[2]-c,a[3]-f));_?(_.insert(l._index+1,y),r=this.getNext()):(this._segment2=y,this._changed(),r=new J(y,d))}return r},splitAt:function(t){var e=this._path;return e?e.splitAt(t):null},splitAtTime:function(t){return this.splitAt(this.getLocationAtTime(t))},divide:function(t,e){return this.divideAtTime(t===k?.5:e?t:this.getTimeAt(t))},split:function(t,e){return this.splitAtTime(t===k?.5:e?t:this.getTimeAt(t))},reversed:function(){return new J(this._segment2.reversed(),this._segment1.reversed())},clearHandles:function(){this._segment1._handleOut._set(0,0),this._segment2._handleIn._set(0,0)},statics:{getValues:function(t,e,i,n){var r=t._point,s=t._handleOut,u=e._handleIn,a=e._point,o=r.x,l=r.y,d=a.x,_=a.y,c=n?[o,l,o,l,d,_,d,_]:[o,l,o+s._x,l+s._y,d+u._x,_+u._y,d,_];return i&&i._transformCoordinates(c,c,4),c},subdivide:function(t,e){var i=t[0],n=t[1],r=t[2],s=t[3],u=t[4],a=t[5],o=t[6],l=t[7];e===k&&(e=.5);var d=1-e,_=d*i+e*r,c=d*n+e*s,f=d*r+e*u,y=d*s+e*a,v=d*u+e*o,b=d*a+e*l,g=d*_+e*f,m=d*c+e*y,h=d*f+e*v,p=d*y+e*b,S=d*g+e*h,x=d*m+e*p;return[[i,n,_,c,g,m,S,x],[S,x,h,p,v,b,o,l]]},getMonoCurves:function(t,e){var i=[],n=e?0:1,r=t[n+0],s=t[n+2],u=t[n+4],a=t[n+6];if(r>=s==s>=u&&s>=u==u>=a||J.isStraight(t))i.push(t);else{var o=3*(s-u)-r+a,l=2*(r+u)-4*s,d=s-r,_=1e-8,c=1-_,f=[],y=St.solveQuadratic(o,l,d,f,_,c);if(!y)i.push(t);else{f.sort();var v=f[0],b=J.subdivide(t,v);i.push(b[0]),y>1&&(v=(f[1]-v)/(1-v),b=J.subdivide(b[1],v),i.push(b[0])),i.push(b[1])}}return i},solveCubic:function(t,e,i,n,r,s){var u=t[e],a=t[e+2],o=t[e+4],l=t[e+6],d=0;if(!(u<i&&l<i&&a<i&&o<i||u>i&&l>i&&a>i&&o>i)){var _=3*(a-u),c=3*(o-a)-_,f=l-u-_-c;d=St.solveCubic(f,c,_,u-i,n,r,s)}return d},getTimeOf:function(t,e){var i=new R(t[0],t[1]),n=new R(t[6],t[7]),r=1e-12,s=1e-7,u=e.isClose(i,r)?0:e.isClose(n,r)?1:null;if(u===null)for(var a=[e.x,e.y],o=[],l=0;l<2;l++)for(var d=J.solveCubic(t,l,a[l],o,0,1),_=0;_<d;_++){var c=o[_];if(e.isClose(J.getPoint(t,c),s))return c}return e.isClose(i,s)?0:e.isClose(n,s)?1:null},getNearestTime:function(t,e){if(J.isStraight(t)){var i=t[0],n=t[1],r=t[6],s=t[7],u=r-i,a=s-n,o=u*u+a*a;if(o===0)return 0;var l=((e.x-i)*u+(e.y-n)*a)/o;return l<1e-12?0:l>.999999999999?1:J.getTimeOf(t,new R(i+l*u,n+l*a))}var d=100,_=1/0,c=0;function f(b){if(b>=0&&b<=1){var g=e.getDistance(J.getPoint(t,b),!0);if(g<_)return _=g,c=b,!0}}for(var y=0;y<=d;y++)f(y/d);for(var v=1/(d*2);v>1e-8;)!f(c-v)&&!f(c+v)&&(v/=2);return c},getPart:function(t,e,i){var n=e>i;if(n){var r=e;e=i,i=r}return e>0&&(t=J.subdivide(t,e)[1]),i<1&&(t=J.subdivide(t,(i-e)/(1-e))[0]),n?[t[6],t[7],t[4],t[5],t[2],t[3],t[0],t[1]]:t},isFlatEnough:function(t,e){var i=t[0],n=t[1],r=t[2],s=t[3],u=t[4],a=t[5],o=t[6],l=t[7],d=3*r-2*i-o,_=3*s-2*n-l,c=3*u-2*o-i,f=3*a-2*l-n;return Math.max(d*d,c*c)+Math.max(_*_,f*f)<=16*e*e},getArea:function(t){var e=t[0],i=t[1],n=t[2],r=t[3],s=t[4],u=t[5],a=t[6],o=t[7];return 3*((o-i)*(n+s)-(a-e)*(r+u)+r*(e-s)-n*(i-u)+o*(s+e/3)-a*(u+i/3))/20},getBounds:function(t){for(var e=t.slice(0,2),i=e.slice(),n=[0,0],r=0;r<2;r++)J._addBounds(t[r],t[r+2],t[r+4],t[r+6],r,0,e,i,n);return new ft(e[0],e[1],i[0]-e[0],i[1]-e[1])},_addBounds:function(t,e,i,n,r,s,u,a,o){function l(S,x){var w=S-x,C=S+x;w<u[r]&&(u[r]=w),C>a[r]&&(a[r]=C)}s/=2;var d=u[r]+s,_=a[r]-s;if(t<d||e<d||i<d||n<d||t>_||e>_||i>_||n>_)if(e<t!=e<n&&i<t!=i<n)l(t,0),l(n,0);else{var c=3*(e-i)-t+n,f=2*(t+i)-4*e,y=e-t,v=St.solveQuadratic(c,f,y,o),b=1e-8,g=1-b;l(n,0);for(var m=0;m<v;m++){var h=o[m],p=1-h;b<=h&&h<=g&&l(p*p*p*t+3*p*p*h*e+3*p*h*h*i+h*h*h*n,s)}}}}},P.each(["getBounds","getStrokeBounds","getHandleBounds"],function(t){this[t]=function(){this._bounds||(this._bounds={});var e=this._bounds[t];return e||(e=this._bounds[t]=Pt[t]([this._segment1,this._segment2],!1,this._path)),e.clone()}},{}),P.each({isStraight:function(t,e,i,n){if(e.isZero()&&i.isZero())return!0;var r=n.subtract(t);if(r.isZero())return!1;if(r.isCollinear(e)&&r.isCollinear(i)){var s=new Bt(t,n),u=1e-7;if(s.getDistance(t.add(e))<u&&s.getDistance(n.add(i))<u){var a=r.dot(r),o=r.dot(e)/a,l=r.dot(i)/a;return o>=0&&o<=1&&l<=0&&l>=-1}}return!1},isLinear:function(t,e,i,n){var r=n.subtract(t).divide(3);return e.equals(r)&&i.negate().equals(r)}},function(t,e){this[e]=function(i){var n=this._segment1,r=this._segment2;return t(n._point,n._handleOut,r._handleIn,r._point,i)},this.statics[e]=function(i,n){var r=i[0],s=i[1],u=i[6],a=i[7];return t(new R(r,s),new R(i[2]-r,i[3]-s),new R(i[4]-u,i[5]-a),new R(u,a),n)}},{statics:{},hasHandles:function(){return!this._segment1._handleOut.isZero()||!this._segment2._handleIn.isZero()},hasLength:function(t){return(!this.getPoint1().equals(this.getPoint2())||this.hasHandles())&&this.getLength()>(t||0)},isCollinear:function(t){return t&&this.isStraight()&&t.isStraight()&&this.getLine().isCollinear(t.getLine())},isHorizontal:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).y)<1e-8},isVertical:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).x)<1e-8}}),{beans:!1,getLocationAt:function(t,e){return this.getLocationAtTime(e?t:this.getTimeAt(t))},getLocationAtTime:function(t){return t!=null&&t>=0&&t<=1?new Xt(this,t):null},getTimeAt:function(t,e){return J.getTimeAt(this.getValues(),t,e)},getParameterAt:"#getTimeAt",getTimesWithTangent:function(){var t=R.read(arguments);return t.isZero()?[]:J.getTimesWithTangent(this.getValues(),t)},getOffsetAtTime:function(t){return this.getPartLength(0,t)},getLocationOf:function(){return this.getLocationAtTime(this.getTimeOf(R.read(arguments)))},getOffsetOf:function(){var t=this.getLocationOf.apply(this,arguments);return t?t.getOffset():null},getTimeOf:function(){return J.getTimeOf(this.getValues(),R.read(arguments))},getParameterOf:"#getTimeOf",getNearestLocation:function(){var t=R.read(arguments),e=this.getValues(),i=J.getNearestTime(e,t),n=J.getPoint(e,i);return new Xt(this,i,n,null,t.getDistance(n))},getNearestPoint:function(){var t=this.getNearestLocation.apply(this,arguments);return t&&t.getPoint()}},new function(){var t=["getPoint","getTangent","getNormal","getWeightedTangent","getWeightedNormal","getCurvature"];return P.each(t,function(e){this[e+"At"]=function(i,n){var r=this.getValues();return J[e](r,n?i:J.getTimeAt(r,i))},this[e+"AtTime"]=function(i){return J[e](this.getValues(),i)}},{statics:{_evaluateMethods:t}})},new function(){function t(n){var r=n[0],s=n[1],u=n[2],a=n[3],o=n[4],l=n[5],d=n[6],_=n[7],c=9*(u-o)+3*(d-r),f=6*(r+o)-12*u,y=3*(u-r),v=9*(a-l)+3*(_-s),b=6*(s+l)-12*a,g=3*(a-s);return function(m){var h=(c*m+f)*m+y,p=(v*m+b)*m+g;return Math.sqrt(h*h+p*p)}}function e(n,r){return Math.max(2,Math.min(16,Math.ceil(Math.abs(r-n)*32)))}function i(n,r,s,u){if(r==null||r<0||r>1)return null;var a=n[0],o=n[1],l=n[2],d=n[3],_=n[4],c=n[5],f=n[6],y=n[7],v=St.isZero;v(l-a)&&v(d-o)&&(l=a,d=o),v(_-f)&&v(c-y)&&(_=f,c=y);var b=3*(l-a),g=3*(_-l)-b,m=f-a-b-g,h=3*(d-o),p=3*(c-d)-h,S=y-o-h-p,x,w;if(s===0)x=r===0?a:r===1?f:((m*r+g)*r+b)*r+a,w=r===0?o:r===1?y:((S*r+p)*r+h)*r+o;else{var C=1e-8,T=1-C;if(r<C?(x=b,w=h):r>T?(x=3*(f-_),w=3*(y-c)):(x=(3*m*r+2*g)*r+b,w=(3*S*r+2*p)*r+h),u){x===0&&w===0&&(r<C||r>T)&&(x=_-l,w=c-d);var M=Math.sqrt(x*x+w*w);M&&(x/=M,w/=M)}if(s===3){var _=6*m*r+2*g,c=6*S*r+2*p,z=Math.pow(x*x+w*w,3/2);x=z!==0?(x*c-w*_)/z:0,w=0}}return s===2?new R(w,-x):new R(x,w)}return{statics:{classify:function(n){var r=n[0],s=n[1],u=n[2],a=n[3],o=n[4],l=n[5],d=n[6],_=n[7],c=r*(_-l)+s*(o-d)+d*l-_*o,f=u*(s-_)+a*(d-r)+r*_-s*d,y=o*(a-s)+l*(r-u)+u*s-a*r,v=3*y,b=v-f,g=b-f+c,m=Math.sqrt(g*g+b*b+v*v),h=m!==0?1/m:0,p=St.isZero,S="serpentine";g*=h,b*=h,v*=h;function x(M,z,I){var E=z!==k,L=E&&z>0&&z<1,D=E&&I>0&&I<1;return E&&(!(L||D)||M==="loop"&&!(L&&D))&&(M="arch",L=D=!1),{type:M,roots:L||D?L&&D?z<I?[z,I]:[I,z]:[L?z:I]:null}}if(p(g))return p(b)?x(p(v)?"line":"quadratic"):x(S,v/(3*b));var w=3*b*b-4*g*v;if(p(w))return x("cusp",b/(2*g));var C=w>0?Math.sqrt(w/3):Math.sqrt(-w),T=2*g;return x(w>0?S:"loop",(b+C)/T,(b-C)/T)},getLength:function(n,r,s,u){if(r===k&&(r=0),s===k&&(s=1),J.isStraight(n)){var a=n;s<1&&(a=J.subdivide(a,s)[0],r/=s),r>0&&(a=J.subdivide(a,r)[1]);var o=a[6]-a[0],l=a[7]-a[1];return Math.sqrt(o*o+l*l)}return St.integrate(u||t(n),r,s,e(r,s))},getTimeAt:function(n,r,s){if(s===k&&(s=r<0?1:0),r===0)return s;var u=Math.abs,a=1e-12,o=r>0,l=o?s:0,d=o?1:s,_=t(n),c=J.getLength(n,l,d,_),f=u(r)-c;if(u(f)<a)return o?d:l;if(f>a)return null;var y=r/c,v=0;function b(g){return v+=St.integrate(_,s,g,e(s,g)),s=g,v-r}return St.findRoot(b,_,s+y,l,d,32,1e-12)},getPoint:function(n,r){return i(n,r,0,!1)},getTangent:function(n,r){return i(n,r,1,!0)},getWeightedTangent:function(n,r){return i(n,r,1,!1)},getNormal:function(n,r){return i(n,r,2,!0)},getWeightedNormal:function(n,r){return i(n,r,2,!1)},getCurvature:function(n,r){return i(n,r,3,!1).x},getPeaks:function(n){var r=n[0],s=n[1],u=n[2],a=n[3],o=n[4],l=n[5],d=n[6],_=n[7],c=-r+3*u-3*o+d,f=3*r-6*u+3*o,y=-3*r+3*u,v=-s+3*a-3*l+_,b=3*s-6*a+3*l,g=-3*s+3*a,m=1e-8,h=1-m,p=[];return St.solveCubic(9*(c*c+v*v),9*(c*f+b*v),2*(f*f+b*b)+3*(y*c+g*v),y*f+b*g,p,m,h),p.sort()}}}},new function(){function t(f,y,v,b,g,m,h){var p=!h&&v.getPrevious()===g,S=!h&&v!==g&&v.getNext()===g,x=1e-8,w=1-x;if(b!==null&&b>=(p?x:0)&&b<=(S?w:1)&&m!==null&&m>=(S?x:0)&&m<=(p?w:1)){var C=new Xt(v,b,null,h),T=new Xt(g,m,null,h);C._intersection=T,T._intersection=C,(!y||y(C))&&Xt.insert(f,C,!0)}}function e(f,y,v,b,g,m,h,p,S,x,w,C,T){if(++S>=4096||++p>=40)return S;var M=1e-9,z=y[0],I=y[1],E=y[6],L=y[7],D=Bt.getSignedDistance,B=D(z,I,E,L,y[2],y[3]),V=D(z,I,E,L,y[4],y[5]),j=B*V>0?3/4:4/9,K=j*Math.min(0,B,V),Q=j*Math.max(0,B,V),et=D(z,I,E,L,f[0],f[1]),U=D(z,I,E,L,f[2],f[3]),W=D(z,I,E,L,f[4],f[5]),$=D(z,I,E,L,f[6],f[7]),rt=i(et,U,W,$),it=rt[0],ht=rt[1],ot,_t;if(B===0&&V===0&&et===0&&U===0&&W===0&&$===0||(ot=n(it,ht,K,Q))==null||(_t=n(it.reverse(),ht.reverse(),K,Q))==null)return S;var wt=x+(w-x)*ot,gt=x+(w-x)*_t;if(Math.max(T-C,gt-wt)<M){var Zt=(wt+gt)/2,Wt=(C+T)/2;t(g,m,h?b:v,h?Wt:Zt,h?v:b,h?Zt:Wt)}else{f=J.getPart(f,ot,_t);var Yt=T-C;if(_t-ot>.8)if(gt-wt>Yt){var Rt=J.subdivide(f,.5),Zt=(wt+gt)/2;S=e(y,Rt[0],b,v,g,m,!h,p,S,C,T,wt,Zt),S=e(y,Rt[1],b,v,g,m,!h,p,S,C,T,Zt,gt)}else{var Rt=J.subdivide(y,.5),Wt=(C+T)/2;S=e(Rt[0],f,b,v,g,m,!h,p,S,C,Wt,wt,gt),S=e(Rt[1],f,b,v,g,m,!h,p,S,Wt,T,wt,gt)}else Yt===0||Yt>=M?S=e(y,f,b,v,g,m,!h,p,S,C,T,wt,gt):S=e(f,y,v,b,g,m,h,p,S,wt,gt,C,T)}return S}function i(f,y,v,b){var g=[0,f],m=[1/3,y],h=[2/3,v],p=[1,b],S=y-(2*f+b)/3,x=v-(f+2*b)/3,w;if(S*x<0)w=[[g,m,p],[g,h,p]];else{var C=S/x;w=[C>=2?[g,m,p]:C<=.5?[g,h,p]:[g,m,h,p],[g,p]]}return(S||x)<0?w.reverse():w}function n(f,y,v,b){return f[0][1]<v?r(f,!0,v):y[0][1]>b?r(y,!1,b):f[0][0]}function r(f,y,v){for(var b=f[0][0],g=f[0][1],m=1,h=f.length;m<h;m++){var p=f[m][0],S=f[m][1];if(y?S>=v:S<=v)return S===v?p:b+(v-g)*(p-b)/(S-g);b=p,g=S}return null}function s(f,y,v,b,g){var m=St.isZero;if(m(b)&&m(g)){var h=J.getTimeOf(f,new R(y,v));return h===null?[]:[h]}for(var p=Math.atan2(-g,b),S=Math.sin(p),x=Math.cos(p),w=[],C=[],T=0;T<8;T+=2){var M=f[T]-y,z=f[T+1]-v;w.push(M*x-z*S,M*S+z*x)}return J.solveCubic(w,1,0,C,0,1),C}function u(f,y,v,b,g,m,h){for(var p=y[0],S=y[1],x=y[6],w=y[7],C=s(f,p,S,x-p,w-S),T=0,M=C.length;T<M;T++){var z=C[T],I=J.getPoint(f,z),E=J.getTimeOf(y,I);E!==null&&t(g,m,h?b:v,h?E:z,h?v:b,h?z:E)}}function a(f,y,v,b,g,m){var h=Bt.intersect(f[0],f[1],f[6],f[7],y[0],y[1],y[6],y[7]);h&&t(g,m,v,J.getTimeOf(f,h),b,J.getTimeOf(y,h))}function o(f,y,v,b,g,m){var h=1e-12,p=Math.min,S=Math.max;if(S(f[0],f[2],f[4],f[6])+h>p(y[0],y[2],y[4],y[6])&&p(f[0],f[2],f[4],f[6])-h<S(y[0],y[2],y[4],y[6])&&S(f[1],f[3],f[5],f[7])+h>p(y[1],y[3],y[5],y[7])&&p(f[1],f[3],f[5],f[7])-h<S(y[1],y[3],y[5],y[7])){var x=_(f,y);if(x)for(var w=0;w<2;w++){var C=x[w];t(g,m,v,C[0],b,C[1],!0)}else{var T=J.isStraight(f),M=J.isStraight(y),z=T&&M,I=T&&!M,E=g.length;if((z?a:T||M?u:e)(I?y:f,I?f:y,I?b:v,I?v:b,g,m,I,0,0,0,1,0,1),!z||g.length===E)for(var w=0;w<4;w++){var L=w>>1,D=w&1,B=L*6,V=D*6,j=new R(f[B],f[B+1]),K=new R(y[V],y[V+1]);j.isClose(K,h)&&t(g,m,v,L,b,D)}}}return g}function l(f,y,v,b){var g=J.classify(f);if(g.type==="loop"){var m=g.roots;t(v,b,y,m[0],y,m[1])}return v}function d(f,y,v,b,g,m){var h=1e-7,p=!y;p&&(y=f);for(var S=f.length,x=y.length,w=new Array(S),C=p?w:new Array(x),T=[],M=0;M<S;M++)w[M]=f[M].getValues(b);if(!p)for(var M=0;M<x;M++)C[M]=y[M].getValues(g);for(var z=oe.findCurveBoundsCollisions(w,C,h),I=0;I<S;I++){var E=f[I],L=w[I];p&&l(L,E,T,v);var D=z[I];if(D)for(var B=0;B<D.length;B++){if(m&&T.length)return T;var V=D[B];if(!p||V>I){var j=y[V],K=C[V];o(L,K,E,j,T,v)}}}return T}function _(f,y){function v($){var rt=$[6]-$[0],it=$[7]-$[1];return rt*rt+it*it}var b=Math.abs,g=Bt.getDistance,m=1e-8,h=1e-7,p=J.isStraight(f),S=J.isStraight(y),x=p&&S,w=v(f)<v(y),C=w?y:f,T=w?f:y,M=C[0],z=C[1],I=C[6]-M,E=C[7]-z;if(g(M,z,I,E,T[0],T[1],!0)<h&&g(M,z,I,E,T[6],T[7],!0)<h)!x&&g(M,z,I,E,C[2],C[3],!0)<h&&g(M,z,I,E,C[4],C[5],!0)<h&&g(M,z,I,E,T[2],T[3],!0)<h&&g(M,z,I,E,T[4],T[5],!0)<h&&(p=S=x=!0);else if(x)return null;if(p^S)return null;for(var L=[f,y],D=[],B=0;B<4&&D.length<2;B++){var V=B&1,j=V^1,K=B>>1,Q=J.getTimeOf(L[V],new R(L[j][K?6:0],L[j][K?7:1]));if(Q!=null){var et=V?[K,Q]:[Q,K];(!D.length||b(et[0]-D[0][0])>m&&b(et[1]-D[0][1])>m)&&D.push(et)}if(B>2&&!D.length)break}if(D.length!==2)D=null;else if(!x){var U=J.getPart(f,D[0][0],D[1][0]),W=J.getPart(y,D[0][1],D[1][1]);(b(W[2]-U[2])>h||b(W[3]-U[3])>h||b(W[4]-U[4])>h||b(W[5]-U[5])>h)&&(D=null)}return D}function c(f,y){var v=f[0],b=f[1],g=f[2],m=f[3],h=f[4],p=f[5],S=f[6],x=f[7],w=y.normalize(),C=w.x,T=w.y,M=3*S-9*h+9*g-3*v,z=3*x-9*p+9*m-3*b,I=6*h-12*g+6*v,E=6*p-12*m+6*b,L=3*g-3*v,D=3*m-3*b,B=2*M*T-2*z*C,V=[];if(Math.abs(B)<St.CURVETIME_EPSILON){var j=M*D-z*L,B=M*E-z*I;if(B!=0){var K=-j/B;K>=0&&K<=1&&V.push(K)}}else{var Q=(I*I-4*M*L)*T*T+(-2*I*E+4*z*L+4*M*D)*C*T+(E*E-4*z*D)*C*C,et=I*T-E*C;if(Q>=0&&B!=0){var U=Math.sqrt(Q),W=-(et+U)/B,$=(-et+U)/B;W>=0&&W<=1&&V.push(W),$>=0&&$<=1&&V.push($)}}return V}return{getIntersections:function(f){var y=this.getValues(),v=f&&f!==this&&f.getValues();return v?o(y,v,this,f,[]):l(y,this,[])},statics:{getOverlaps:_,getIntersections:d,getCurveLineIntersections:s,getTimesWithTangent:c}}}),Xt=P.extend({_class:"CurveLocation",initialize:function(e,i,n,r,s){if(i>=.99999999){var u=e.getNext();u&&(i=0,e=u)}this._setCurve(e),this._time=i,this._point=n||e.getPointAtTime(i),this._overlap=r,this._distance=s,this._intersection=this._next=this._previous=null},_setPath:function(t){this._path=t,this._version=t?t._version:0},_setCurve:function(t){this._setPath(t._path),this._curve=t,this._segment=null,this._segment1=t._segment1,this._segment2=t._segment2},_setSegment:function(t){var e=t.getCurve();e?this._setCurve(e):(this._setPath(t._path),this._segment1=t,this._segment2=null),this._segment=t,this._time=t===this._segment1?0:1,this._point=t._point.clone()},getSegment:function(){var t=this._segment;if(!t){var e=this.getCurve(),i=this.getTime();i===0?t=e._segment1:i===1?t=e._segment2:i!=null&&(t=e.getPartLength(0,i)<e.getPartLength(i,1)?e._segment1:e._segment2),this._segment=t}return t},getCurve:function(){var t=this._path,e=this;t&&t._version!==this._version&&(this._time=this._offset=this._curveOffset=this._curve=null);function i(n){var r=n&&n.getCurve();if(r&&(e._time=r.getTimeOf(e._point))!=null)return e._setCurve(r),r}return this._curve||i(this._segment)||i(this._segment1)||i(this._segment2.getPrevious())},getPath:function(){var t=this.getCurve();return t&&t._path},getIndex:function(){var t=this.getCurve();return t&&t.getIndex()},getTime:function(){var t=this.getCurve(),e=this._time;return t&&e==null?this._time=t.getTimeOf(this._point):e},getParameter:"#getTime",getPoint:function(){return this._point},getOffset:function(){var t=this._offset;if(t==null){t=0;var e=this.getPath(),i=this.getIndex();if(e&&i!=null)for(var n=e.getCurves(),r=0;r<i;r++)t+=n[r].getLength();this._offset=t+=this.getCurveOffset()}return t},getCurveOffset:function(){var t=this._curveOffset;if(t==null){var e=this.getCurve(),i=this.getTime();this._curveOffset=t=i!=null&&e&&e.getPartLength(0,i)}return t},getIntersection:function(){return this._intersection},getDistance:function(){return this._distance},divide:function(){var t=this.getCurve(),e=t&&t.divideAtTime(this.getTime());return e&&this._setSegment(e._segment1),e},split:function(){var t=this.getCurve(),e=t._path,i=t&&t.splitAtTime(this.getTime());return i&&this._setSegment(e.getLastSegment()),i},equals:function(t,e){var i=this===t;if(!i&&t instanceof Xt){var n=this.getCurve(),r=t.getCurve(),s=n._path,u=r._path;if(s===u){var a=Math.abs,o=1e-7,l=a(this.getOffset()-t.getOffset()),d=!e&&this._intersection,_=!e&&t._intersection;i=(l<o||s&&a(s.getLength()-l)<o)&&(!d&&!_||d&&_&&d.equals(_,!0))}}return i},toString:function(){var t=[],e=this.getPoint(),i=$t.instance;e&&t.push("point: "+e);var n=this.getIndex();n!=null&&t.push("index: "+n);var r=this.getTime();return r!=null&&t.push("time: "+i.number(r)),this._distance!=null&&t.push("distance: "+i.number(this._distance)),"{ "+t.join(", ")+" }"},isTouching:function(){var t=this._intersection;if(t&&this.getTangent().isCollinear(t.getTangent())){var e=this.getCurve(),i=t.getCurve();return!(e.isStraight()&&i.isStraight()&&e.getLine().intersect(i.getLine()))}return!1},isCrossing:function(){var t=this._intersection;if(!t)return!1;var e=this.getTime(),i=t.getTime(),n=1e-8,r=1-n,s=e>=n&&e<=r,u=i>=n&&i<=r;if(s&&u)return!this.isTouching();var a=this.getCurve(),o=a&&e<n?a.getPrevious():a,l=t.getCurve(),d=l&&i<n?l.getPrevious():l;if(e>r&&(a=a.getNext()),i>r&&(l=l.getNext()),!o||!a||!d||!l)return!1;var _=[];function c(C,T){var M=C.getValues(),z=J.classify(M).roots||J.getPeaks(M),I=z.length,E=J.getLength(M,T&&I?z[I-1]:0,!T&&I?z[0]:1);_.push(I?E:E/32)}function f(C,T,M){return T<M?C>T&&C<M:C>T||C<M}s||(c(o,!0),c(a,!1)),u||(c(d,!0),c(l,!1));var y=this.getPoint(),v=Math.min.apply(Math,_),b=s?a.getTangentAtTime(e):a.getPointAt(v).subtract(y),g=s?b.negate():o.getPointAt(-v).subtract(y),m=u?l.getTangentAtTime(i):l.getPointAt(v).subtract(y),h=u?m.negate():d.getPointAt(-v).subtract(y),p=g.getAngle(),S=b.getAngle(),x=h.getAngle(),w=m.getAngle();return!!(s?f(p,x,w)^f(S,x,w)&&f(p,w,x)^f(S,w,x):f(x,p,S)^f(w,p,S)&&f(x,S,p)^f(w,S,p))},hasOverlap:function(){return!!this._overlap}},P.each(J._evaluateMethods,function(t){var e=t+"At";this[t]=function(){var i=this.getCurve(),n=this.getTime();return n!=null&&i&&i[e](n,!0)}},{preserve:!0}),new function(){function t(e,i,n){var r=e.length,s=0,u=r-1;function a(y,v){for(var b=y+v;b>=-1&&b<=r;b+=v){var g=e[(b%r+r)%r];if(!i.getPoint().isClose(g.getPoint(),1e-7))break;if(i.equals(g))return g}return null}for(;s<=u;){var o=s+u>>>1,l=e[o],d;if(n&&(d=i.equals(l)?l:a(o,-1)||a(o,1)))return i._overlap&&(d._overlap=d._intersection._overlap=!0),d;var _=i.getPath(),c=l.getPath(),f=_!==c?_._id-c._id:i.getIndex()+i.getTime()-(l.getIndex()+l.getTime());f<0?u=o-1:s=o+1}return e.splice(s,0,i),i}return{statics:{insert:t,expand:function(e){for(var i=e.slice(),n=e.length-1;n>=0;n--)t(i,e[n]._intersection,!1);return i}}}}),re=mt.extend({_class:"PathItem",_selectBounds:!1,_canScaleStroke:!0,beans:!0,initialize:function(){},statics:{create:function(t){var e,i,n;if(P.isPlainObject(t)?(i=t.segments,e=t.pathData):Array.isArray(t)?i=t:typeof t=="string"&&(e=t),i){var r=i[0];n=r&&Array.isArray(r[0])}else e&&(n=(e.match(/m/gi)||[]).length>1||/z\s*\S+/i.test(e));var s=n?pe:Pt;return new s(t)}},_asPathItem:function(){return this},isClockwise:function(){return this.getArea()>=0},setClockwise:function(t){this.isClockwise()!=(t=!!t)&&this.reverse()},setPathData:function(t){var e=t&&t.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/ig),i,n=!1,r,s,u=new R,a=new R;function o(h,p){var S=+i[h];return n&&(S+=u[p]),S}function l(h){return new R(o(h,"x"),o(h+1,"y"))}this.clear();for(var d=0,_=e&&e.length;d<_;d++){var c=e[d],f=c[0],y=f.toLowerCase();i=c.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g);var v=i&&i.length;switch(n=f===y,r==="z"&&!/[mz]/.test(y)&&this.moveTo(u),y){case"m":case"l":for(var b=y==="m",g=0;g<v;g+=2)this[b?"moveTo":"lineTo"](u=l(g)),b&&(a=u,b=!1);s=u;break;case"h":case"v":var m=y==="h"?"x":"y";u=u.clone();for(var g=0;g<v;g++)u[m]=o(g,m),this.lineTo(u);s=u;break;case"c":for(var g=0;g<v;g+=6)this.cubicCurveTo(l(g),s=l(g+2),u=l(g+4));break;case"s":for(var g=0;g<v;g+=4)this.cubicCurveTo(/[cs]/.test(r)?u.multiply(2).subtract(s):u,s=l(g),u=l(g+2)),r=y;break;case"q":for(var g=0;g<v;g+=4)this.quadraticCurveTo(s=l(g),u=l(g+2));break;case"t":for(var g=0;g<v;g+=2)this.quadraticCurveTo(s=/[qt]/.test(r)?u.multiply(2).subtract(s):u,u=l(g)),r=y;break;case"a":for(var g=0;g<v;g+=7)this.arcTo(u=l(g+5),new ut(+i[g],+i[g+1]),+i[g+2],+i[g+4],+i[g+3]);break;case"z":this.closePath(1e-12),u=a;break}r=y}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_contains:function(t){var e=t.isInside(this.getBounds({internal:!0,handle:!0}))?this._getWinding(t):{};return e.onPath||!!(this.getFillRule()==="evenodd"?e.windingL&1||e.windingR&1:e.winding)},getIntersections:function(t,e,i,n){var r=this===t||!t,s=this._matrix._orNullIfIdentity(),u=r?s:(i||t._matrix)._orNullIfIdentity();return r||this.getBounds(s).intersects(t.getBounds(u),1e-12)?J.getIntersections(this.getCurves(),!r&&t.getCurves(),e,s,u,n):[]},getCrossings:function(t){return this.getIntersections(t,function(e){return e.isCrossing()})},getNearestLocation:function(){for(var t=R.read(arguments),e=this.getCurves(),i=1/0,n=null,r=0,s=e.length;r<s;r++){var u=e[r].getNearestLocation(t);u._distance<i&&(i=u._distance,n=u)}return n},getNearestPoint:function(){var t=this.getNearestLocation.apply(this,arguments);return t&&t.getPoint()},interpolate:function(t,e,i){var n=!this._children,r=n?"_segments":"_children",s=t[r],u=e[r],a=this[r];if(!s||!u||s.length!==u.length)throw new Error("Invalid operands in interpolate() call: "+t+", "+e);var o=a.length,l=u.length;if(o<l)for(var d=n?at:Pt,_=o;_<l;_++)this.add(new d);else o>l&&this[n?"removeSegments":"removeChildren"](l,o);for(var _=0;_<l;_++)a[_].interpolate(s[_],u[_],i);n&&(this.setClosed(t._closed),this._changed(9))},compare:function(t){var e=!1;if(t){var i=this._children||[this],n=t._children?t._children.slice():[t],r=i.length,s=n.length,u=[],a=0;e=!0;for(var o=oe.findItemBoundsCollisions(i,n,St.GEOMETRIC_EPSILON),l=r-1;l>=0&&e;l--){var d=i[l];e=!1;var _=o[l];if(_)for(var c=_.length-1;c>=0&&!e;c--)d.compare(n[_[c]])&&(u[_[c]]||(u[_[c]]=!0,a++),e=!0)}e=e&&a===s}return e}}),Pt=re.extend({_class:"Path",_serializeFields:{segments:[],closed:!1},initialize:function(e){this._closed=!1,this._segments=[],this._version=0;var i=arguments,n=Array.isArray(e)?typeof e[0]=="object"?e:i:e&&e.size===k&&(e.x!==k||e.point!==k)?i:null;n&&n.length>0?this.setSegments(n):(this._curves=k,this._segmentSelection=0,!n&&typeof e=="string"&&(this.setPathData(e),e=null)),this._initialize(!n&&e)},_equals:function(t){return this._closed===t._closed&&P.equals(this._segments,t._segments)},copyContent:function(t){this.setSegments(t._segments),this._closed=t._closed},_changed:function t(e){if(t.base.call(this,e),e&8){if(this._length=this._area=k,e&32)this._version++;else if(this._curves)for(var i=0,n=this._curves.length;i<n;i++)this._curves[i]._changed()}else e&64&&(this._bounds=k)},getStyle:function(){var t=this._parent;return(t instanceof pe?t:this)._style},getSegments:function(){return this._segments},setSegments:function(t){var e=this.isFullySelected(),i=t&&t.length;if(this._segments.length=0,this._segmentSelection=0,this._curves=k,i){var n=t[i-1];typeof n=="boolean"&&(this.setClosed(n),i--),this._add(at.readList(t,0,{},i))}e&&this.setFullySelected(!0)},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var t=this._curves,e=this._segments;if(!t){var i=this._countCurves();t=this._curves=new Array(i);for(var n=0;n<i;n++)t[n]=new J(this,e[n],e[n+1]||e[0])}return t},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var t=this.getCurves();return t[t.length-1]},isClosed:function(){return this._closed},setClosed:function(t){if(this._closed!=(t=!!t)){if(this._closed=t,this._curves){var e=this._curves.length=this._countCurves();t&&(this._curves[e-1]=new J(this,this._segments[e-1],this._segments[0]))}this._changed(41)}}},{beans:!0,getPathData:function(t,e){var i=this._segments,n=i.length,r=new $t(e),s=new Array(6),u=!0,a,o,l,d,_,c,f,y,v=[];function b(m,h){if(m._transformCoordinates(t,s),a=s[0],o=s[1],u)v.push("M"+r.pair(a,o)),u=!1;else if(_=s[2],c=s[3],_===a&&c===o&&f===l&&y===d){if(!h){var p=a-l,S=o-d;v.push(p===0?"v"+r.number(S):S===0?"h"+r.number(p):"l"+r.pair(p,S))}}else v.push("c"+r.pair(f-l,y-d)+" "+r.pair(_-l,c-d)+" "+r.pair(a-l,o-d));l=a,d=o,f=s[4],y=s[5]}if(!n)return"";for(var g=0;g<n;g++)b(i[g]);return this._closed&&n>0&&(b(i[0],!0),v.push("z")),v.join("")},isEmpty:function(){return!this._segments.length},_transformContent:function(t){for(var e=this._segments,i=new Array(6),n=0,r=e.length;n<r;n++)e[n]._transformCoordinates(t,i,!0);return!0},_add:function(t,u){for(var i=this._segments,n=this._curves,r=t.length,s=u==null,u=s?i.length:u,a=0;a<r;a++){var o=t[a];o._path&&(o=t[a]=o.clone()),o._path=this,o._index=u+a,o._selection&&this._updateSelection(o,0,o._selection)}if(s)P.push(i,t);else{i.splice.apply(i,[u,0].concat(t));for(var a=u+r,l=i.length;a<l;a++)i[a]._index=a}if(n){var d=this._countCurves(),_=u>0&&u+r-1===d?u-1:u,c=_,f=Math.min(_+r,d);t._curves&&(n.splice.apply(n,[_,0].concat(t._curves)),c+=t._curves.length);for(var a=c;a<f;a++)n.splice(a,0,new J(this,null,null));this._adjustCurves(_,f)}return this._changed(41),t},_adjustCurves:function(t,e){for(var i=this._segments,n=this._curves,r,s=t;s<e;s++)r=n[s],r._path=this,r._segment1=i[s],r._segment2=i[s+1]||i[0],r._changed();(r=n[this._closed&&!t?i.length-1:t-1])&&(r._segment2=i[t]||i[0],r._changed()),(r=n[e])&&(r._segment1=i[e],r._changed())},_countCurves:function(){var t=this._segments.length;return!this._closed&&t>0?t-1:t},add:function(t){var e=arguments;return e.length>1&&typeof t!="number"?this._add(at.readList(e)):this._add([at.read(e)])[0]},insert:function(t,e){var i=arguments;return i.length>2&&typeof e!="number"?this._add(at.readList(i,1),t):this._add([at.read(i,1)],t)[0]},addSegment:function(){return this._add([at.read(arguments)])[0]},insertSegment:function(t){return this._add([at.read(arguments,1)],t)[0]},addSegments:function(t){return this._add(at.readList(t))},insertSegments:function(t,e){return this._add(at.readList(e),t)},removeSegment:function(t){return this.removeSegments(t,t+1)[0]||null},removeSegments:function(t,e,i){t=t||0,e=P.pick(e,this._segments.length);var n=this._segments,r=this._curves,s=n.length,u=n.splice(t,e-t),a=u.length;if(!a)return u;for(var o=0;o<a;o++){var l=u[o];l._selection&&this._updateSelection(l,l._selection,0),l._index=l._path=null}for(var o=t,d=n.length;o<d;o++)n[o]._index=o;if(r){for(var _=t>0&&e===s+(this._closed?1:0)?t-1:t,r=r.splice(_,a),o=r.length-1;o>=0;o--)r[o]._path=null;i&&(u._curves=r.slice(1)),this._adjustCurves(_,_)}return this._changed(41),u},clear:"#removeSegments",hasHandles:function(){for(var t=this._segments,e=0,i=t.length;e<i;e++)if(t[e].hasHandles())return!0;return!1},clearHandles:function(){for(var t=this._segments,e=0,i=t.length;e<i;e++)t[e].clearHandles()},getLength:function(){if(this._length==null){for(var t=this.getCurves(),e=0,i=0,n=t.length;i<n;i++)e+=t[i].getLength();this._length=e}return this._length},getArea:function(){var t=this._area;if(t==null){var e=this._segments,i=this._closed;t=0;for(var n=0,r=e.length;n<r;n++){var s=n+1===r;t+=J.getArea(J.getValues(e[n],e[s?0:n+1],null,s&&!i))}this._area=t}return t},isFullySelected:function(){var t=this._segments.length;return this.isSelected()&&t>0&&this._segmentSelection===t*7},setFullySelected:function(t){t&&this._selectSegments(!0),this.setSelected(t)},setSelection:function t(e){e&1||this._selectSegments(!1),t.base.call(this,e)},_selectSegments:function(t){var e=this._segments,i=e.length,n=t?7:0;this._segmentSelection=n*i;for(var r=0;r<i;r++)e[r]._selection=n},_updateSelection:function(t,e,i){t._selection=i;var n=this._segmentSelection+=i-e;n>0&&this.setSelected(!0)},divideAt:function(t){var e=this.getLocationAt(t),i;return e&&(i=e.getCurve().divideAt(e.getCurveOffset()))?i._segment1:null},splitAt:function(t){var e=this.getLocationAt(t),i=e&&e.index,n=e&&e.time,r=1e-8,s=1-r;n>s&&(i++,n=0);var u=this.getCurves();if(i>=0&&i<u.length){n>=r&&u[i++].divideAtTime(n);var a=this.removeSegments(i,this._segments.length,!0),o;return this._closed?(this.setClosed(!1),o=this):(o=new Pt(mt.NO_INSERT),o.insertAbove(this),o.copyAttributes(this)),o._add(a,0),this.addSegment(a[0]),o}return null},split:function(t,e){var i,n=e===k?t:(i=this.getCurves()[t])&&i.getLocationAtTime(e);return n!=null?this.splitAt(n):null},join:function(t,e){var i=e||0;if(t&&t!==this){var n=t._segments,r=this.getLastSegment(),s=t.getLastSegment();if(!s)return this;r&&r._point.isClose(s._point,i)&&t.reverse();var u=t.getFirstSegment();if(r&&r._point.isClose(u._point,i))r.setHandleOut(u._handleOut),this._add(n.slice(1));else{var a=this.getFirstSegment();a&&a._point.isClose(u._point,i)&&t.reverse(),s=t.getLastSegment(),a&&a._point.isClose(s._point,i)?(a.setHandleIn(s._handleIn),this._add(n.slice(0,n.length-1),0)):this._add(n.slice())}t._closed&&this._add([n[0]]),t.remove()}var o=this.getFirstSegment(),l=this.getLastSegment();return o!==l&&o._point.isClose(l._point,i)&&(o.setHandleIn(l._handleIn),l.remove(),this.setClosed(!0)),this},reduce:function(t){for(var e=this.getCurves(),i=t&&t.simplify,n=i?1e-7:0,r=e.length-1;r>=0;r--){var s=e[r];!s.hasHandles()&&(!s.hasLength(n)||i&&s.isCollinear(s.getNext()))&&s.remove()}return this},reverse:function(){this._segments.reverse();for(var t=0,e=this._segments.length;t<e;t++){var i=this._segments[t],n=i._handleIn;i._handleIn=i._handleOut,i._handleOut=n,i._index=t}this._curves=null,this._changed(9)},flatten:function(t){for(var e=new Fi(this,t||.25,256,!0),i=e.parts,n=i.length,r=[],s=0;s<n;s++)r.push(new at(i[s].curve.slice(0,2)));!this._closed&&n>0&&r.push(new at(i[n-1].curve.slice(6))),this.setSegments(r)},simplify:function(t){var e=new kn(this).fit(t||2.5);return e&&this.setSegments(e),!!e},smooth:function(t){var e=this,i=t||{},n=i.type||"asymmetric",r=this._segments,s=r.length,u=this._closed;function a(it,ht){var ot=it&&it.index;if(ot!=null){var _t=it.path;if(_t&&_t!==e)throw new Error(it._class+" "+ot+" of "+_t+" is not part of "+e);ht&&it instanceof J&&ot++}else ot=typeof it=="number"?it:ht;return Math.min(ot<0&&u?ot%s:ot<0?ot+s:ot,s-1)}var o=u&&i.from===k&&i.to===k,l=a(i.from,0),d=a(i.to,s-1);if(l>d)if(u)l-=s;else{var _=l;l=d,d=_}if(/^(?:asymmetric|continuous)$/.test(n)){var c=n==="asymmetric",f=Math.min,y=d-l+1,v=y-1,b=o?f(y,4):1,g=b,m=b,h=[];if(u||(g=f(1,l),m=f(1,s-d-1)),v+=g+m,v<=1)return;for(var p=0,S=l-g;p<=v;p++,S++)h[p]=r[(S<0?S+s:S)%s]._point;for(var x=h[0]._x+2*h[1]._x,w=h[0]._y+2*h[1]._y,C=2,T=v-1,M=[x],z=[w],I=[C],E=[],L=[],p=1;p<v;p++){var D=p<T,B=D||c?1:2,V=D?4:c?2:7,j=D?4:c?3:8,K=D?2:c?0:1,Q=B/C;C=I[p]=V-Q,x=M[p]=j*h[p]._x+K*h[p+1]._x-Q*x,w=z[p]=j*h[p]._y+K*h[p+1]._y-Q*w}E[T]=M[T]/I[T],L[T]=z[T]/I[T];for(var p=v-2;p>=0;p--)E[p]=(M[p]-E[p+1])/I[p],L[p]=(z[p]-L[p+1])/I[p];E[v]=(3*h[v]._x-E[T])/2,L[v]=(3*h[v]._y-L[T])/2;for(var p=g,et=v-m,S=l;p<=et;p++,S++){var U=r[S<0?S+s:S],W=U._point,$=E[p]-W._x,rt=L[p]-W._y;(o||p<et)&&U.setHandleOut($,rt),(o||p>g)&&U.setHandleIn(-$,-rt)}}else for(var p=l;p<=d;p++)r[p<0?p+s:p].smooth(i,!o&&p===l,!o&&p===d)},toShape:function(t){if(!this._closed)return null;var e=this._segments,i,n,r,s;function u(c,f){var y=e[c],v=y.getNext(),b=e[f],g=b.getNext();return y._handleOut.isZero()&&v._handleIn.isZero()&&b._handleOut.isZero()&&g._handleIn.isZero()&&v._point.subtract(y._point).isCollinear(g._point.subtract(b._point))}function a(c){var f=e[c],y=f.getPrevious(),v=f.getNext();return y._handleOut.isZero()&&f._handleIn.isZero()&&f._handleOut.isZero()&&v._handleIn.isZero()&&f._point.subtract(y._point).isOrthogonal(v._point.subtract(f._point))}function o(c){var f=e[c],y=f.getNext(),v=f._handleOut,b=y._handleIn,g=.5522847498307936;if(v.isOrthogonal(b)){var m=f._point,h=y._point,p=new Bt(m,v,!0).intersect(new Bt(h,b,!0),!0);return p&&St.isZero(v.getLength()/p.subtract(m).getLength()-g)&&St.isZero(b.getLength()/p.subtract(h).getLength()-g)}return!1}function l(c,f){return e[c]._point.getDistance(e[f]._point)}if(!this.hasHandles()&&e.length===4&&u(0,2)&&u(1,3)&&a(1)?(i=Y.Rectangle,n=new ut(l(0,3),l(0,1)),s=e[1]._point.add(e[2]._point).divide(2)):e.length===8&&o(0)&&o(2)&&o(4)&&o(6)&&u(1,5)&&u(3,7)?(i=Y.Rectangle,n=new ut(l(1,6),l(0,3)),r=n.subtract(new ut(l(0,7),l(1,2))).divide(2),s=e[3]._point.add(e[4]._point).divide(2)):e.length===4&&o(0)&&o(1)&&o(2)&&o(3)&&(St.isZero(l(0,2)-l(1,3))?(i=Y.Circle,r=l(0,2)/2):(i=Y.Ellipse,r=new ut(l(2,0)/2,l(3,1)/2)),s=e[1]._point),i){var d=this.getPosition(!0),_=new i({center:d,size:n,radius:r,insert:!1});return _.copyAttributes(this,!0),_._matrix.prepend(this._matrix),_.rotate(s.subtract(d).getAngle()+90),(t===k||t)&&_.insertAbove(this),_}return null},toPath:"#clone",compare:function t(e){if(!e||e instanceof pe)return t.base.call(this,e);var i=this.getCurves(),n=e.getCurves(),r=i.length,s=n.length;if(!r||!s)return r==s;for(var u=i[0].getValues(),a=[],o=0,l,d=0,_,c=0;c<s;c++){var b=n[c].getValues();a.push(b);var f=J.getOverlaps(u,b);if(f){l=!c&&f[0][0]>0?s-1:c,_=f[0][1];break}}for(var y=Math.abs,v=1e-8,b=a[l],g;u&&b;){var f=J.getOverlaps(u,b);if(f){var m=f[0][0];if(y(m-d)<v){d=f[1][0],d===1&&(u=++o<r?i[o].getValues():null,d=0);var h=f[0][1];if(y(h-_)<v){if(g||(g=[l,h]),_=f[1][1],_===1&&(++l>=s&&(l=0),b=a[l]||n[l].getValues(),_=0),!u)return g[0]===l&&g[1]===_;continue}}}break}return!1},_hitTestSelf:function(t,e,i,n){var r=this,s=this.getStyle(),u=this._segments,a=u.length,o=this._closed,l=e._tolerancePadding,d=l,_,c,f,y,v,b,g=e.stroke&&s.hasStroke(),m=e.fill&&s.hasFill(),h=e.curves,p=g?s.getStrokeWidth()/2:m&&e.tolerance>0||h?0:null;p!==null&&(p>0?(_=s.getStrokeJoin(),c=s.getStrokeCap(),f=s.getMiterLimit(),d=d.add(Pt._getStrokePadding(p,n))):_=c="round");function S(E,L){return t.subtract(E).divide(L).length<=1}function x(E,L,D){if(!e.selected||L.isSelected()){var B=E._point;if(L!==B&&(L=L.add(B)),S(L,d))return new Ct(D,r,{segment:E,point:L})}}function w(E,L){return(L||e.segments)&&x(E,E._point,"segment")||!L&&e.handles&&(x(E,E._handleIn,"handle-in")||x(E,E._handleOut,"handle-out"))}function C(E){y.add(E)}function T(E){var L=o||E._index>0&&E._index<a-1;if((L?_:c)==="round")return S(E._point,d);if(y=new Pt({internal:!0,closed:!0}),L?E.isSmooth()||Pt._addBevelJoin(E,_,p,f,null,n,C,!0):c==="square"&&Pt._addSquareCap(E,c,p,null,n,C,!0),!y.isEmpty()){var D;return y.contains(t)||(D=y.getNearestLocation(t))&&S(D.getPoint(),l)}}if(e.ends&&!e.segments&&!o){if(b=w(u[0],!0)||w(u[a-1],!0))return b}else if(e.segments||e.handles){for(var M=0;M<a;M++)if(b=w(u[M]))return b}if(p!==null){if(v=this.getNearestLocation(t),v){var z=v.getTime();z===0||z===1&&a>1?T(v.getSegment())||(v=null):S(v.getPoint(),d)||(v=null)}if(!v&&_==="miter"&&a>1)for(var M=0;M<a;M++){var I=u[M];if(t.getDistance(I._point)<=f*p&&T(I)){v=I.getLocation();break}}}return!v&&m&&this._contains(t)||v&&!g&&!h?new Ct("fill",this):v?new Ct(g?"stroke":"curve",this,{location:v,point:v.getPoint()}):null}},P.each(J._evaluateMethods,function(t){this[t+"At"]=function(e){var i=this.getLocationAt(e);return i&&i[t]()}},{beans:!1,getLocationOf:function(){for(var t=R.read(arguments),e=this.getCurves(),i=0,n=e.length;i<n;i++){var r=e[i].getLocationOf(t);if(r)return r}return null},getOffsetOf:function(){var t=this.getLocationOf.apply(this,arguments);return t?t.getOffset():null},getLocationAt:function(t){if(typeof t=="number"){for(var e=this.getCurves(),i=0,n=0,r=e.length;n<r;n++){var s=i,u=e[n];if(i+=u.getLength(),i>t)return u.getLocationAt(t-s)}if(e.length>0&&t<=this.getLength())return new Xt(e[e.length-1],1)}else if(t&&t.getPath&&t.getPath()===this)return t;return null},getOffsetsWithTangent:function(){var t=R.read(arguments);if(t.isZero())return[];for(var e=[],i=0,n=this.getCurves(),r=0,s=n.length;r<s;r++){for(var u=n[r],a=u.getTimesWithTangent(t),o=0,l=a.length;o<l;o++){var d=i+u.getOffsetAtTime(a[o]);e.indexOf(d)<0&&e.push(d)}i+=u.length}return e}}),new function(){function t(i,n,r,s){if(s<=0)return;var u=s/2,a=s-2,o=u-1,l=new Array(6),d,_;function c(m){var h=l[m],p=l[m+1];(d!=h||_!=p)&&(i.beginPath(),i.moveTo(d,_),i.lineTo(h,p),i.stroke(),i.beginPath(),i.arc(h,p,u,0,Math.PI*2,!0),i.fill())}for(var f=0,y=n.length;f<y;f++){var v=n[f],b=v._selection;if(v._transformCoordinates(r,l),d=l[0],_=l[1],b&2&&c(2),b&4&&c(4),i.fillRect(d-u,_-u,s,s),a>0&&!(b&1)){var g=i.fillStyle;i.fillStyle="#ffffff",i.fillRect(d-o,_-o,a,a),i.fillStyle=g}}}function e(i,n,r){var s=n._segments,u=s.length,a=new Array(6),o=!0,l,d,_,c,f,y,v,b;function g(h){if(r)h._transformCoordinates(r,a),l=a[0],d=a[1];else{var p=h._point;l=p._x,d=p._y}if(o)i.moveTo(l,d),o=!1;else{if(r)f=a[2],y=a[3];else{var S=h._handleIn;f=l+S._x,y=d+S._y}f===l&&y===d&&v===_&&b===c?i.lineTo(l,d):i.bezierCurveTo(v,b,f,y,l,d)}if(_=l,c=d,r)v=a[4],b=a[5];else{var S=h._handleOut;v=_+S._x,b=c+S._y}}for(var m=0;m<u;m++)g(s[m]);n._closed&&u>0&&g(s[0])}return{_draw:function(i,n,r,s){var u=n.dontStart,a=n.dontFinish||n.clip,o=this.getStyle(),l=o.hasFill(),d=o.hasStroke(),_=o.getDashArray(),c=!bt.support.nativeDash&&d&&_&&_.length;u||i.beginPath(),(l||d&&!c||a)&&(e(i,this,s),this._closed&&i.closePath());function f(h){return _[(h%c+c)%c]}if(!a&&(l||d)&&(this._setStyles(i,n,r),l&&(i.fill(o.getFillRule()),i.shadowColor="rgba(0,0,0,0)"),d)){if(c){u||i.beginPath();for(var y=new Fi(this,.25,32,!1,s),v=y.length,b=-o.getDashOffset(),g,m=0;b>0;)b-=f(m--)+f(m--);for(;b<v;)g=b+f(m++),(b>0||g>0)&&y.drawPart(i,Math.max(b,0),Math.max(g,0)),b=g+f(m++)}i.stroke()}},_drawSelected:function(i,n){i.beginPath(),e(i,this,n),i.stroke(),t(i,this._segments,n,bt.settings.handleSize)}}},new function(){function t(e){var i=e._segments;if(!i.length)throw new Error("Use a moveTo() command first");return i[i.length-1]}return{moveTo:function(){var e=this._segments;e.length===1&&this.removeSegment(0),e.length||this._add([new at(R.read(arguments))])},moveBy:function(){throw new Error("moveBy() is unsupported on Path items.")},lineTo:function(){this._add([new at(R.read(arguments))])},cubicCurveTo:function(){var e=arguments,i=R.read(e),n=R.read(e),r=R.read(e),s=t(this);s.setHandleOut(i.subtract(s._point)),this._add([new at(r,n.subtract(r))])},quadraticCurveTo:function(){var e=arguments,i=R.read(e),n=R.read(e),r=t(this)._point;this.cubicCurveTo(i.add(r.subtract(i).multiply(1/3)),i.add(n.subtract(i).multiply(1/3)),n)},curveTo:function(){var e=arguments,i=R.read(e),n=R.read(e),r=P.pick(P.read(e),.5),s=1-r,u=t(this)._point,a=i.subtract(u.multiply(s*s)).subtract(n.multiply(r*r)).divide(2*r*s);if(a.isNaN())throw new Error("Cannot put a curve through points with parameter = "+r);this.quadraticCurveTo(a,n)},arcTo:function(){var e=arguments,i=Math.abs,n=Math.sqrt,r=t(this),s=r._point,u=R.read(e),a,o=P.peek(e),l=P.pick(o,!0),d,_,c,f;if(typeof l=="boolean")var y=s.add(u).divide(2),a=y.add(y.subtract(s).rotate(l?-90:90));else if(P.remain(e)<=2)a=u,u=R.read(e);else if(!s.equals(u)){var v=ut.read(e),b=St.isZero;if(b(v.width)||b(v.height))return this.lineTo(u);var g=P.read(e),l=!!P.read(e),m=!!P.read(e),y=s.add(u).divide(2),h=s.subtract(y).rotate(-g),p=h.x,S=h.y,x=i(v.width),w=i(v.height),C=x*x,T=w*w,M=p*p,z=S*S,I=n(M/C+z/T);if(I>1&&(x*=I,w*=I,C=x*x,T=w*w),I=(C*T-C*z-T*M)/(C*z+T*M),i(I)<1e-12&&(I=0),I<0)throw new Error("Cannot create an arc with the given arguments");d=new R(x*S/w,-w*p/x).multiply((m===l?-1:1)*n(I)).rotate(g).add(y),f=new Ot().translate(d).rotate(g).scale(x,w),c=f._inverseTransform(s),_=c.getDirectedAngle(f._inverseTransform(u)),!l&&_>0?_-=360:l&&_<0&&(_+=360)}if(a){var E=new Bt(s.add(a).divide(2),a.subtract(s).rotate(90),!0),L=new Bt(a.add(u).divide(2),u.subtract(a).rotate(90),!0),D=new Bt(s,u),B=D.getSide(a);if(d=E.intersect(L,!0),!d){if(!B)return this.lineTo(u);throw new Error("Cannot create an arc with the given arguments")}c=s.subtract(d),_=c.getDirectedAngle(u.subtract(d));var V=D.getSide(d,!0);V===0?_=B*i(_):B===V&&(_+=_<0?360:-360)}if(_){for(var j=1e-5,K=i(_),Q=K>=360?4:Math.ceil((K-j)/90),et=_/Q,U=et*Math.PI/360,W=4/3*Math.sin(U)/(1+Math.cos(U)),$=[],rt=0;rt<=Q;rt++){var h=u,it=null;if(rt<Q&&(it=c.rotate(90).multiply(W),f?(h=f._transformPoint(c),it=f._transformPoint(c.add(it)).subtract(h)):h=d.add(c)),!rt)r.setHandleOut(it);else{var ht=c.rotate(-90).multiply(W);f&&(ht=f._transformPoint(c.add(ht)).subtract(h)),$.push(new at(h,ht,it))}c=c.rotate(et)}this._add($)}},lineBy:function(){var e=R.read(arguments),i=t(this)._point;this.lineTo(i.add(e))},curveBy:function(){var e=arguments,i=R.read(e),n=R.read(e),r=P.read(e),s=t(this)._point;this.curveTo(s.add(i),s.add(n),r)},cubicCurveBy:function(){var e=arguments,i=R.read(e),n=R.read(e),r=R.read(e),s=t(this)._point;this.cubicCurveTo(s.add(i),s.add(n),s.add(r))},quadraticCurveBy:function(){var e=arguments,i=R.read(e),n=R.read(e),r=t(this)._point;this.quadraticCurveTo(r.add(i),r.add(n))},arcBy:function(){var e=arguments,i=t(this)._point,n=i.add(R.read(e)),r=P.pick(P.peek(e),!0);typeof r=="boolean"?this.arcTo(n,r):this.arcTo(n,i.add(R.read(e)))},closePath:function(e){this.setClosed(!0),this.join(this,e)}}},{_getBounds:function(t,e){var i=e.handle?"getHandleBounds":e.stroke?"getStrokeBounds":"getBounds";return Pt[i](this._segments,this._closed,this,t,e)},statics:{getBounds:function(t,e,i,n,r,s){var u=t[0];if(!u)return new ft;var a=new Array(6),o=u._transformCoordinates(n,new Array(6)),l=o.slice(0,2),d=l.slice(),_=new Array(2);function c(v){v._transformCoordinates(n,a);for(var b=0;b<2;b++)J._addBounds(o[b],o[b+4],a[b+2],a[b],b,s?s[b]:0,l,d,_);var g=o;o=a,a=g}for(var f=1,y=t.length;f<y;f++)c(t[f]);return e&&c(u),new ft(l[0],l[1],d[0]-l[0],d[1]-l[1])},getStrokeBounds:function(t,e,i,n,r){var s=i.getStyle(),u=s.hasStroke(),a=s.getStrokeWidth(),o=u&&i._getStrokeMatrix(n,r),l=u&&Pt._getStrokePadding(a,o),d=Pt.getBounds(t,e,i,n,r,l);if(!u)return d;var _=a/2,c=s.getStrokeJoin(),f=s.getStrokeCap(),y=s.getMiterLimit(),v=new ft(new ut(l));function b(x){d=d.include(x)}function g(x){d=d.unite(v.setCenter(x._point.transform(n)))}function m(x,w){w==="round"||x.isSmooth()?g(x):Pt._addBevelJoin(x,w,_,y,n,o,b)}function h(x,w){w==="round"?g(x):Pt._addSquareCap(x,w,_,n,o,b)}var p=t.length-(e?0:1);if(p>0){for(var S=1;S<p;S++)m(t[S],c);e?m(t[0],c):(h(t[0],f),h(t[t.length-1],f))}return d},_getStrokePadding:function(t,e){if(!e)return[t,t];var i=new R(t,0).transform(e),n=new R(0,t).transform(e),r=i.getAngleInRadians(),s=i.getLength(),u=n.getLength(),a=Math.sin(r),o=Math.cos(r),l=Math.tan(r),d=Math.atan2(u*l,s),_=Math.atan2(u,l*s);return[Math.abs(s*Math.cos(d)*o+u*Math.sin(d)*a),Math.abs(u*Math.sin(_)*o+s*Math.cos(_)*a)]},_addBevelJoin:function(t,e,i,n,r,s,u,a){var o=t.getCurve(),l=o.getPrevious(),d=o.getPoint1().transform(r),_=l.getNormalAtTime(1).multiply(i).transform(s),c=o.getNormalAtTime(0).multiply(i).transform(s),f=_.getDirectedAngle(c);if((f<0||f>=180)&&(_=_.negate(),c=c.negate()),a&&u(d),u(d.add(_)),e==="miter"){var y=new Bt(d.add(_),new R(-_.y,_.x),!0).intersect(new Bt(d.add(c),new R(-c.y,c.x),!0),!0);y&&d.getDistance(y)<=n*i&&u(y)}u(d.add(c))},_addSquareCap:function(t,e,i,n,r,s,u){var a=t._point.transform(n),o=t.getLocation(),l=o.getNormal().multiply(o.getTime()===0?i:-i).transform(r);e==="square"&&(u&&(s(a.subtract(l)),s(a.add(l))),a=a.add(l.rotate(-90))),s(a.add(l)),s(a.subtract(l))},getHandleBounds:function(t,e,i,n,r){var s=i.getStyle(),u=r.stroke&&s.hasStroke(),a,o;if(u){var l=i._getStrokeMatrix(n,r),d=s.getStrokeWidth()/2,_=d;s.getStrokeJoin()==="miter"&&(_=d*s.getMiterLimit()),s.getStrokeCap()==="square"&&(_=Math.max(_,d*Math.SQRT2)),a=Pt._getStrokePadding(d,l),o=Pt._getStrokePadding(_,l)}for(var c=new Array(6),f=1/0,y=-f,v=f,b=y,g=0,m=t.length;g<m;g++){var h=t[g];h._transformCoordinates(n,c);for(var p=0;p<6;p+=2){var S=p?a:o,x=S?S[0]:0,w=S?S[1]:0,C=c[p],T=c[p+1],M=C-x,z=C+x,I=T-w,E=T+w;M<f&&(f=M),z>y&&(y=z),I<v&&(v=I),E>b&&(b=E)}}return new ft(f,v,y-f,b-v)}}});Pt.inject({statics:new function(){var t=.5522847498307936,e=[new at([-1,0],[0,t],[0,-.5522847498307936]),new at([0,-1],[-.5522847498307936,0],[t,0]),new at([1,0],[0,-.5522847498307936],[0,t]),new at([0,1],[t,0],[-.5522847498307936,0])];function i(r,s,u){var a=P.getNamed(u),o=new Pt(a&&(a.insert==!0?mt.INSERT:a.insert==!1?mt.NO_INSERT:null));return o._add(r),o._closed=s,o.set(a,mt.INSERT)}function n(r,s,u){for(var a=new Array(4),o=0;o<4;o++){var l=e[o];a[o]=new at(l._point.multiply(s).add(r),l._handleIn.multiply(s),l._handleOut.multiply(s))}return i(a,!0,u)}return{Line:function(){var r=arguments;return i([new at(R.readNamed(r,"from")),new at(R.readNamed(r,"to"))],!1,r)},Circle:function(){var r=arguments,s=R.readNamed(r,"center"),u=P.readNamed(r,"radius");return n(s,new ut(u),r)},Rectangle:function(){var r=arguments,s=ft.readNamed(r,"rectangle"),u=ut.readNamed(r,"radius",0,{readNull:!0}),a=s.getBottomLeft(!0),o=s.getTopLeft(!0),l=s.getTopRight(!0),d=s.getBottomRight(!0),_;if(!u||u.isZero())_=[new at(a),new at(o),new at(l),new at(d)];else{u=ut.min(u,s.getSize(!0).divide(2));var c=u.width,f=u.height,y=c*t,v=f*t;_=[new at(a.add(c,0),null,[-y,0]),new at(a.subtract(0,f),[0,v]),new at(o.add(0,f),null,[0,-v]),new at(o.add(c,0),[-y,0],null),new at(l.subtract(c,0),null,[y,0]),new at(l.add(0,f),[0,-v],null),new at(d.subtract(0,f),null,[0,v]),new at(d.subtract(c,0),[y,0])]}return i(_,!0,r)},RoundRectangle:"#Rectangle",Ellipse:function(){var r=arguments,s=Y._readEllipse(r);return n(s.center,s.radius,r)},Oval:"#Ellipse",Arc:function(){var r=arguments,s=R.readNamed(r,"from"),u=R.readNamed(r,"through"),a=R.readNamed(r,"to"),o=P.getNamed(r),l=new Pt(o&&o.insert==!1&&mt.NO_INSERT);return l.moveTo(s),l.arcTo(u,a),l.set(o)},RegularPolygon:function(){for(var r=arguments,s=R.readNamed(r,"center"),u=P.readNamed(r,"sides"),a=P.readNamed(r,"radius"),o=360/u,l=u%3===0,d=new R(0,l?-a:a),_=l?-1:.5,c=new Array(u),f=0;f<u;f++)c[f]=new at(s.add(d.rotate((f+_)*o)));return i(c,!0,r)},Star:function(){for(var r=arguments,s=R.readNamed(r,"center"),u=P.readNamed(r,"points")*2,a=P.readNamed(r,"radius1"),o=P.readNamed(r,"radius2"),l=360/u,d=new R(0,-1),_=new Array(u),c=0;c<u;c++)_[c]=new at(s.add(d.rotate(l*c).multiply(c%2?o:a)));return i(_,!0,r)}}}});var pe=re.extend({_class:"CompoundPath",_serializeFields:{children:[]},beans:!0,initialize:function(e){this._children=[],this._namedChildren={},this._initialize(e)||(typeof e=="string"?this.setPathData(e):this.addChildren(Array.isArray(e)?e:arguments))},insertChildren:function t(e,i){var n=i,r=n[0];r&&typeof r[0]=="number"&&(n=[n]);for(var s=i.length-1;s>=0;s--){var u=n[s];n===i&&!(u instanceof Pt)&&(n=P.slice(n)),Array.isArray(u)?n[s]=new Pt({segments:u,insert:!1}):u instanceof pe&&(n.splice.apply(n,[s,1].concat(u.removeChildren())),u.remove())}return t.base.call(this,e,n)},reduce:function t(e){for(var i=this._children,n=i.length-1;n>=0;n--){var r=i[n].reduce(e);r.isEmpty()&&r.remove()}if(!i.length){var r=new Pt(mt.NO_INSERT);return r.copyAttributes(this),r.insertAbove(this),this.remove(),r}return t.base.call(this)},isClosed:function(){for(var t=this._children,e=0,i=t.length;e<i;e++)if(!t[e]._closed)return!1;return!0},setClosed:function(t){for(var e=this._children,i=0,n=e.length;i<n;i++)e[i].setClosed(t)},getFirstSegment:function(){var t=this.getFirstChild();return t&&t.getFirstSegment()},getLastSegment:function(){var t=this.getLastChild();return t&&t.getLastSegment()},getCurves:function(){for(var t=this._children,e=[],i=0,n=t.length;i<n;i++)P.push(e,t[i].getCurves());return e},getFirstCurve:function(){var t=this.getFirstChild();return t&&t.getFirstCurve()},getLastCurve:function(){var t=this.getLastChild();return t&&t.getLastCurve()},getArea:function(){for(var t=this._children,e=0,i=0,n=t.length;i<n;i++)e+=t[i].getArea();return e},getLength:function(){for(var t=this._children,e=0,i=0,n=t.length;i<n;i++)e+=t[i].getLength();return e},getPathData:function(t,e){for(var i=this._children,n=[],r=0,s=i.length;r<s;r++){var u=i[r],a=u._matrix;n.push(u.getPathData(t&&!a.isIdentity()?t.appended(a):t,e))}return n.join("")},_hitTestChildren:function t(e,i,n){return t.base.call(this,e,i.class===Pt||i.type==="path"?i:P.set({},i,{fill:!1}),n)},_draw:function(t,e,i,n){var r=this._children;if(r.length){e=e.extend({dontStart:!0,dontFinish:!0}),t.beginPath();for(var s=0,u=r.length;s<u;s++)r[s].draw(t,e,n);if(!e.clip){this._setStyles(t,e,i);var a=this._style;a.hasFill()&&(t.fill(a.getFillRule()),t.shadowColor="rgba(0,0,0,0)"),a.hasStroke()&&t.stroke()}}},_drawSelected:function(t,e,i){for(var n=this._children,r=0,s=n.length;r<s;r++){var u=n[r],a=u._matrix;i[u._id]||u._drawSelected(t,a.isIdentity()?e:e.appended(a))}}},new function(){function t(e,i){var n=e._children;if(i&&!n.length)throw new Error("Use a moveTo() command first");return n[n.length-1]}return P.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","cubicCurveBy","quadraticCurveBy","curveBy","arcBy"],function(e){this[e]=function(){var i=t(this,!0);i[e].apply(i,arguments)}},{moveTo:function(){var e=t(this),i=e&&e.isEmpty()?e:new Pt(mt.NO_INSERT);i!==e&&this.addChild(i),i.moveTo.apply(i,arguments)},moveBy:function(){var e=t(this,!0),i=e&&e.getLastSegment(),n=R.read(arguments);this.moveTo(i?n.add(i._point):n)},closePath:function(e){t(this,!0).closePath(e)}})},P.each(["reverse","flatten","simplify","smooth"],function(t){this[t]=function(e){for(var i=this._children,n,r=0,s=i.length;r<s;r++)n=i[r][t](e)||n;return n}},{}));re.inject(new function(){var t=Math.min,e=Math.max,i=Math.abs,n={unite:{1:!0,2:!0},intersect:{2:!0},subtract:{1:!0},exclude:{1:!0,"-1":!0}};function r(g){return g._children||[g]}function s(g,m){var h=g.clone(!1).reduce({simplify:!0}).transform(null,!0,!0);if(m){for(var p=r(h),S=0,x=p.length;S<x;S++){var g=p[S];!g._closed&&!g.isEmpty()&&(g.closePath(1e-12),g.getFirstSegment().setHandleIn(0,0),g.getLastSegment().setHandleOut(0,0))}h=h.resolveCrossings().reorient(h.getFillRule()==="nonzero",!0)}return h}function u(g,m,h,p,S){var x=new pe(mt.NO_INSERT);return x.addChildren(g,!0),x=x.reduce({simplify:m}),S&&S.insert==!1||x.insertAbove(p&&h.isSibling(p)&&h.getIndex()<p.getIndex()?p:h),x.copyAttributes(h,!0),x}function a(g){return g.hasOverlap()||g.isCrossing()}function o(g,m,h,p){if(p&&(p.trace==!1||p.stroke)&&/^(subtract|intersect)$/.test(h))return l(g,m,h);var S=s(g,!0),x=m&&g!==m&&s(m,!0),w=n[h];w[h]=!0,x&&(w.subtract||w.exclude)^(x.isClockwise()^S.isClockwise())&&x.reverse();var C=f(Xt.expand(S.getIntersections(x,a))),T=r(S),M=x&&r(x),z=[],I=[],E;function L(it){for(var ht=0,ot=it.length;ht<ot;ht++){var _t=it[ht];P.push(z,_t._segments),P.push(I,_t.getCurves()),_t._overlapsOnly=!0}}function D(it){for(var ht=[],ot=0,_t=it&&it.length;ot<_t;ot++)ht.push(I[it[ot]]);return ht}if(C.length){L(T),M&&L(M);for(var B=new Array(I.length),V=0,j=I.length;V<j;V++)B[V]=I[V].getValues();for(var K=oe.findCurveBoundsCollisions(B,B,0,!0),Q={},V=0;V<I.length;V++){var et=I[V],U=et._path._id,W=Q[U]=Q[U]||{};W[et.getIndex()]={hor:D(K[V].hor),ver:D(K[V].ver)}}for(var V=0,j=C.length;V<j;V++)v(C[V]._segment,S,x,Q,w);for(var V=0,j=z.length;V<j;V++){var $=z[V],rt=$._intersection;$._winding||v($,S,x,Q,w),rt&&rt._overlap||($._path._overlapsOnly=!1)}E=b(z,w)}else E=c(M?T.concat(M):T.slice(),function(it){return!!w[it]});return u(E,!0,g,m,p)}function l(g,m,h){var p=s(g),S=s(m),x=p.getIntersections(S,a),w=h==="subtract",C=h==="divide",T={},M=[];function z(L){if(!T[L._id]&&(C||S.contains(L.getPointAt(L.getLength()/2))^w))return M.unshift(L),T[L._id]=!0}for(var I=x.length-1;I>=0;I--){var E=x[I].split();E&&(z(E)&&E.getFirstSegment().setHandleIn(0,0),p.getLastSegment().setHandleOut(0,0))}return z(p),u(M,!1,g,m)}function d(g,m){for(var h=g;h;){if(h===m)return;h=h._previous}for(;g._next&&g._next!==m;)g=g._next;if(!g._next){for(;m._previous;)m=m._previous;g._next=m,m._previous=g}}function _(g){for(var m=g.length-1;m>=0;m--)g[m].clearHandles()}function c(g,m,h){var p=g&&g.length;if(p){var S=P.each(g,function(K,Q){this[K._id]={container:null,winding:K.isClockwise()?1:-1,index:Q}},{}),x=g.slice().sort(function(K,Q){return i(Q.getArea())-i(K.getArea())}),w=x[0],C=oe.findItemBoundsCollisions(x,null,St.GEOMETRIC_EPSILON);h==null&&(h=w.isClockwise());for(var T=0;T<p;T++){var M=x[T],z=S[M._id],I=0,E=C[T];if(E){for(var L=null,D=E.length-1;D>=0;D--)if(E[D]<T){L=L||M.getInteriorPoint();var B=x[E[D]];if(B.contains(L)){var V=S[B._id];I=V.winding,z.winding+=I,z.container=V.exclude?V.container:B;break}}}if(m(z.winding)===m(I))z.exclude=!0,g[z.index]=null;else{var j=z.container;M.setClockwise(j?!j.isClockwise():h)}}}return g}function f(g,m,h){var p=m&&[],S=1e-8,x=1-S,w=!1,C=h||[],T=h&&{},M,z,I;function E(ht){return ht._path._id+"."+ht._segment1._index}for(var L=(h&&h.length)-1;L>=0;L--){var D=h[L];D._path&&(T[E(D)]=!0)}for(var L=g.length-1;L>=0;L--){var B=g[L],V=B._time,j=V,K=m&&!m(B),D=B._curve,Q;if(D&&(D!==z?(w=!D.hasHandles()||T&&T[E(D)],M=[],I=null,z=D):I>=S&&(V/=I)),K){M&&M.push(B);continue}else m&&p.unshift(B);if(I=j,V<S)Q=D._segment1;else if(V>x)Q=D._segment2;else{var et=D.divideAtTime(V,!0);w&&C.push(D,et),Q=et._segment1;for(var U=M.length-1;U>=0;U--){var W=M[U];W._time=(W._time-V)/(1-V)}}B._setSegment(Q);var $=Q._intersection,rt=B._intersection;if($){d($,rt);for(var it=$;it;)d(it._intersection,$),it=it._next}else Q._intersection=rt}return h||_(C),p||g}function y(g,m,h,p,S){var x=Array.isArray(m)?m:m[h?"hor":"ver"],w=h?1:0,C=w^1,T=[g.x,g.y],M=T[w],z=T[C],I=1e-9,E=1e-6,L=M-I,D=M+I,B=0,V=0,j=0,K=0,Q=!1,et=!1,U=1,W=[],$,rt;function it(At){var Dt=At[C+0],se=At[C+6];if(!(z<t(Dt,se)||z>e(Dt,se))){var Gt=At[w+0],le=At[w+2],xe=At[w+4],he=At[w+6];if(Dt===se){(Gt<D&&he>L||he<D&&Gt>L)&&(Q=!0);return}var fe=z===Dt?0:z===se||L>e(Gt,le,xe,he)||D<t(Gt,le,xe,he)?1:J.solveCubic(At,C,z,W,0,1)>0?W[0]:1,ae=fe===0?Gt:fe===1?he:J.getPoint(At,fe)[h?"y":"x"],ue=Dt>se?1:-1,Ce=$[C]>$[C+6]?1:-1,ce=$[w+6];return z!==Dt?(ae<L?j+=ue:ae>D?K+=ue:Q=!0,ae>M-E&&ae<M+E&&(U/=2)):(ue!==Ce?Gt<L?j+=ue:Gt>D&&(K+=ue):Gt!=ce&&(ce<D&&ae>D?(K+=ue,Q=!0):ce>L&&ae<L&&(j+=ue,Q=!0)),U/=4),$=At,!S&&ae>L&&ae<D&&J.getTangent(At,fe)[h?"x":"y"]===0&&y(g,m,!h,p,!0)}}function ht(At){var Dt=At[C+0],se=At[C+2],Gt=At[C+4],le=At[C+6];if(z<=e(Dt,se,Gt,le)&&z>=t(Dt,se,Gt,le)){for(var xe=At[w+0],he=At[w+2],fe=At[w+4],ae=At[w+6],ue=L>e(xe,he,fe,ae)||D<t(xe,he,fe,ae)?[At]:J.getMonoCurves(At,h),Ce,ce=0,Qe=ue.length;ce<Qe;ce++)if(Ce=it(ue[ce]))return Ce}}for(var ot=0,_t=x.length;ot<_t;ot++){var wt=x[ot],gt=wt._path,Zt=wt.getValues(),Wt;if((!ot||x[ot-1]._path!==gt)&&($=null,gt._closed||(rt=J.getValues(gt.getLastCurve().getSegment2(),wt.getSegment1(),null,!p),rt[C]!==rt[C+6]&&($=rt)),!$)){$=Zt;for(var Yt=gt.getLastCurve();Yt&&Yt!==wt;){var Rt=Yt.getValues();if(Rt[C]!==Rt[C+6]){$=Rt;break}Yt=Yt.getPrevious()}}if(Wt=ht(Zt))return Wt;if(ot+1===_t||x[ot+1]._path!==gt){if(rt&&(Wt=ht(rt)))return Wt;Q&&!j&&!K&&(j=K=gt.isClockwise(p)^h?1:-1),B+=j,V+=K,j=K=0,Q&&(et=!0,Q=!1),rt=null}}return B=i(B),V=i(V),{winding:e(B,V),windingL:B,windingR:V,quality:U,onPath:et}}function v(g,m,h,p,S){var x=[],w=g,C=0,I;do{var T=g.getCurve();if(T){var M=T.getLength();x.push({segment:g,curve:T,length:M}),C+=M}g=g.getNext()}while(g&&!g._intersection&&g!==w);for(var z=[.5,.25,.75],I={winding:0,quality:-1},E=.001,L=1-E,D=0;D<z.length&&I.quality<.5;D++)for(var M=C*z[D],B=0,V=x.length;B<V;B++){var j=x[B],K=j.length;if(M<=K){var T=j.curve,Q=T._path,et=Q._parent,U=et instanceof pe?et:Q,W=St.clamp(T.getTimeAt(M),E,L),$=T.getPointAtTime(W),rt=i(T.getTangentAtTime(W).y)<Math.SQRT1_2,it=null;if(S.subtract&&h){var ht=U===m?h:m,ot=ht._getWinding($,rt,!0);if(U===m&&ot.winding||U===h&&!ot.winding){if(ot.quality<1)continue;it={winding:0,quality:1}}}it=it||y($,p[Q._id][T.getIndex()],rt,!0),it.quality>I.quality&&(I=it);break}M-=K}for(var B=x.length-1;B>=0;B--)x[B].segment._winding=I}function b(g,m){var h=[],p;function S(_t){var wt;return!!(_t&&!_t._visited&&(!m||m[(wt=_t._winding||{}).winding]&&!(m.unite&&wt.winding===2&&wt.windingL&&wt.windingR)))}function x(_t){if(_t){for(var wt=0,gt=p.length;wt<gt;wt++)if(_t===p[wt])return!0}return!1}function w(_t){for(var wt=_t._segments,gt=0,Zt=wt.length;gt<Zt;gt++)wt[gt]._visited=!0}function C(_t,wt){var gt=_t._intersection,Zt=gt,Wt=[];wt&&(p=[_t]);function Yt(Rt,At){for(;Rt&&Rt!==At;){var Dt=Rt._segment,se=Dt&&Dt._path;if(se){var Gt=Dt.getNext()||se.getFirstSegment(),le=Gt._intersection;Dt!==_t&&(x(Dt)||x(Gt)||Gt&&S(Dt)&&(S(Gt)||le&&S(le._segment)))&&Wt.push(Dt),wt&&p.push(Dt)}Rt=Rt._next}}if(gt){for(Yt(gt);gt&&gt._previous;)gt=gt._previous;Yt(gt,Zt)}return Wt}g.sort(function(_t,wt){var gt=_t._intersection,Zt=wt._intersection,Wt=!!(gt&&gt._overlap),Yt=!!(Zt&&Zt._overlap),Rt=_t._path,At=wt._path;return Wt^Yt?Wt?1:-1:!gt^!Zt?gt?1:-1:Rt!==At?Rt._id-At._id:_t._index-wt._index});for(var T=0,M=g.length;T<M;T++){var z=g[T],I=S(z),E=null,L=!1,D=!0,B=[],V,j,K;if(I&&z._path._overlapsOnly){var Q=z._path,et=z._intersection._segment._path;Q.compare(et)&&(Q.getArea()&&h.push(Q.clone(!1)),w(Q),w(et),I=!1)}for(;I;){var U=!E,W=C(z,U),$=W.shift(),L=!U&&(x(z)||x($)),rt=!L&&$;if(U&&(E=new Pt(mt.NO_INSERT),V=null),L){(z.isFirst()||z.isLast())&&(D=z._path._closed),z._visited=!0;break}if(rt&&V&&(B.push(V),V=null),V||(rt&&W.push(z),V={start:E._segments.length,crossings:W,visited:j=[],handleIn:K}),rt&&(z=$),!S(z)){E.removeSegments(V.start);for(var it=0,ht=j.length;it<ht;it++)j[it]._visited=!1;j.length=0;do z=V&&V.crossings.shift(),(!z||!z._path)&&(z=null,V=B.pop(),V&&(j=V.visited,K=V.handleIn));while(V&&!S(z));if(!z)break}var ot=z.getNext();E.add(new at(z._point,K,ot&&z._handleOut)),z._visited=!0,j.push(z),z=ot||z._path.getFirstSegment(),K=ot&&ot._handleIn}L&&(D&&(E.getFirstSegment().setHandleIn(K),E.setClosed(D)),E.getArea()!==0&&h.push(E))}return h}return{_getWinding:function(g,m,h){return y(g,this.getCurves(),m,h)},unite:function(g,m){return o(this,g,"unite",m)},intersect:function(g,m){return o(this,g,"intersect",m)},subtract:function(g,m){return o(this,g,"subtract",m)},exclude:function(g,m){return o(this,g,"exclude",m)},divide:function(g,m){return m&&(m.trace==!1||m.stroke)?l(this,g,"divide"):u([this.subtract(g,m),this.intersect(g,m)],!0,this,g,m)},resolveCrossings:function(){var g=this._children,m=g||[this];function h(V,j){var K=V&&V._intersection;return K&&K._overlap&&K._path===j}var p=!1,S=!1,x=this.getIntersections(null,function(V){return V.hasOverlap()&&(p=!0)||V.isCrossing()&&(S=!0)}),w=p&&S&&[];if(x=Xt.expand(x),p)for(var C=f(x,function(V){return V.hasOverlap()},w),T=C.length-1;T>=0;T--){var M=C[T],z=M._path,I=M._segment,E=I.getPrevious(),L=I.getNext();h(E,z)&&h(L,z)&&(I.remove(),E._handleOut._set(0,0),L._handleIn._set(0,0),E!==I&&!E.getCurve().hasLength()&&(L._handleIn.set(E._handleIn),E.remove()))}S&&(f(x,p&&function(V){var j=V.getCurve(),K=V.getSegment(),Q=V._intersection,et=Q._curve,U=Q._segment;if(j&&et&&j._path&&et._path)return!0;K&&(K._intersection=null),U&&(U._intersection=null)},w),w&&_(w),m=b(P.each(m,function(V){P.push(this,V._segments)},[])));var D=m.length,B;return D>1&&g?(m!==g&&this.setChildren(m),B=this):D===1&&!g&&(m[0]!==this&&this.setSegments(m[0].removeSegments()),B=this),B||(B=new pe(mt.NO_INSERT),B.addChildren(m),B=B.reduce(),B.copyAttributes(this),this.replaceWith(B)),B},reorient:function(g,m){var h=this._children;return h&&h.length?this.setChildren(c(this.removeChildren(),function(p){return!!(g?p:p&1)},m)):m!==k&&this.setClockwise(m),this},getInteriorPoint:function(){var g=this.getBounds(),m=g.getCenter(!0);if(!this.contains(m)){for(var h=this.getCurves(),p=m.y,S=[],x=[],w=0,C=h.length;w<C;w++){var T=h[w].getValues(),M=T[1],z=T[3],I=T[5],E=T[7];if(p>=t(M,z,I,E)&&p<=e(M,z,I,E))for(var L=J.getMonoCurves(T),D=0,B=L.length;D<B;D++){var V=L[D],j=V[1],K=V[7];if(j!==K&&(p>=j&&p<=K||p>=K&&p<=j)){var Q=p===j?V[0]:p===K?V[6]:J.solveCubic(V,1,p,x,0,1)===1?J.getPoint(V,x[0]).x:(V[0]+V[6])/2;S.push(Q)}}}S.length>1&&(S.sort(function(et,U){return et-U}),m.x=(S[0]+S[1])/2)}return m}}});var Fi=P.extend({_class:"PathFlattener",initialize:function(t,e,i,n,r){var s=[],u=[],a=0,o=1/(i||32),l=t._segments,d=l[0],_;function c(b,g){var m=J.getValues(b,g,r);s.push(m),f(m,b._index,0,1)}function f(b,g,m,h){if(h-m>o&&!(n&&J.isStraight(b))&&!J.isFlatEnough(b,e||.25)){var p=J.subdivide(b,.5),S=(m+h)/2;f(p[0],g,m,S),f(p[1],g,S,h)}else{var x=b[6]-b[0],w=b[7]-b[1],C=Math.sqrt(x*x+w*w);C>0&&(a+=C,u.push({offset:a,curve:b,index:g,time:h}))}}for(var y=1,v=l.length;y<v;y++)_=l[y],c(d,_),d=_;t._closed&&c(_||d,l[0]),this.curves=s,this.parts=u,this.length=a,this.index=0},_get:function(t){for(var e=this.parts,i=e.length,n,r=this.index;n=r,!(!r||e[--r].offset<t););for(;n<i;n++){var s=e[n];if(s.offset>=t){this.index=n;var u=e[n-1],a=u&&u.index===s.index?u.time:0,o=u?u.offset:0;return{index:s.index,time:a+(s.time-a)*(t-o)/(s.offset-o)}}}return{index:e[i-1].index,time:1}},drawPart:function(t,e,i){for(var n=this._get(e),r=this._get(i),s=n.index,u=r.index;s<=u;s++){var a=J.getPart(this.curves[s],s===n.index?n.time:0,s===r.index?r.time:1);s===n.index&&t.moveTo(a[0],a[1]),t.bezierCurveTo.apply(t,a.slice(2))}}},P.each(J._evaluateMethods,function(t){this[t+"At"]=function(e){var i=this._get(e);return J[t](this.curves[i.index],i.time)}},{})),kn=P.extend({initialize:function(t){for(var e=this.points=[],i=t._segments,n=t._closed,r=0,s,u=i.length;r<u;r++){var a=i[r].point;(!s||!s.equals(a))&&e.push(s=a.clone())}n&&(e.unshift(e[e.length-1]),e.push(e[1])),this.closed=n},fit:function(t){var e=this.points,i=e.length,n=null;return i>0&&(n=[new at(e[0])],i>1&&(this.fitCubic(n,t,0,i-1,e[1].subtract(e[0]),e[i-2].subtract(e[i-1])),this.closed&&(n.shift(),n.pop()))),n},fitCubic:function(t,e,i,n,r,s){var u=this.points;if(n-i===1){var a=u[i],o=u[n],l=a.getDistance(o)/3;this.addCurve(t,[a,a.add(r.normalize(l)),o.add(s.normalize(l)),o]);return}for(var d=this.chordLengthParameterize(i,n),_=Math.max(e,e*e),c,f=!0,y=0;y<=4;y++){var v=this.generateBezier(i,n,d,r,s),b=this.findMaxError(i,n,v,d);if(b.error<e&&f){this.addCurve(t,v);return}if(c=b.index,b.error>=_)break;f=this.reparameterize(i,n,d,v),_=b.error}var g=u[c-1].subtract(u[c+1]);this.fitCubic(t,e,i,c,r,g),this.fitCubic(t,e,c,n,g.negate(),s)},addCurve:function(t,e){var i=t[t.length-1];i.setHandleOut(e[1].subtract(e[0])),t.push(new at(e[3],e[2].subtract(e[3])))},generateBezier:function(t,e,i,n,r){for(var s=1e-12,u=Math.abs,a=this.points,o=a[t],l=a[e],d=[[0,0],[0,0]],_=[0,0],c=0,f=e-t+1;c<f;c++){var y=i[c],v=1-y,b=3*y*v,g=v*v*v,m=b*v,h=b*y,p=y*y*y,S=n.normalize(m),x=r.normalize(h),w=a[t+c].subtract(o.multiply(g+m)).subtract(l.multiply(h+p));d[0][0]+=S.dot(S),d[0][1]+=S.dot(x),d[1][0]=d[0][1],d[1][1]+=x.dot(x),_[0]+=S.dot(w),_[1]+=x.dot(w)}var C=d[0][0]*d[1][1]-d[1][0]*d[0][1],T,M;if(u(C)>s){var z=d[0][0]*_[1]-d[1][0]*_[0],I=_[0]*d[1][1]-_[1]*d[0][1];T=I/C,M=z/C}else{var E=d[0][0]+d[0][1],L=d[1][0]+d[1][1];T=M=u(E)>s?_[0]/E:u(L)>s?_[1]/L:0}var D=l.getDistance(o),B=s*D,V,j;if(T<B||M<B)T=M=D/3;else{var K=l.subtract(o);V=n.normalize(T),j=r.normalize(M),V.dot(K)-j.dot(K)>D*D&&(T=M=D/3,V=j=null)}return[o,o.add(V||n.normalize(T)),l.add(j||r.normalize(M)),l]},reparameterize:function(t,e,i,n){for(var r=t;r<=e;r++)i[r-t]=this.findRoot(n,this.points[r],i[r-t]);for(var r=1,s=i.length;r<s;r++)if(i[r]<=i[r-1])return!1;return!0},findRoot:function(t,e,i){for(var n=[],r=[],s=0;s<=2;s++)n[s]=t[s+1].subtract(t[s]).multiply(3);for(var s=0;s<=1;s++)r[s]=n[s+1].subtract(n[s]).multiply(2);var u=this.evaluate(3,t,i),a=this.evaluate(2,n,i),o=this.evaluate(1,r,i),l=u.subtract(e),d=a.dot(a)+l.dot(o);return St.isMachineZero(d)?i:i-l.dot(a)/d},evaluate:function(t,e,i){for(var n=e.slice(),r=1;r<=t;r++)for(var s=0;s<=t-r;s++)n[s]=n[s].multiply(1-i).add(n[s+1].multiply(i));return n[0]},chordLengthParameterize:function(t,e){for(var i=[0],n=t+1;n<=e;n++)i[n-t]=i[n-t-1]+this.points[n].getDistance(this.points[n-1]);for(var n=1,r=e-t;n<=r;n++)i[n]/=i[r];return i},findMaxError:function(t,e,i,n){for(var r=Math.floor((e-t+1)/2),s=0,u=t+1;u<e;u++){var a=this.evaluate(3,i,n[u-t]),o=a.subtract(this.points[u]),l=o.x*o.x+o.y*o.y;l>=s&&(s=l,r=u)}return{error:s,index:r}}}),Ke=mt.extend({_class:"TextItem",_applyMatrix:!1,_canApplyMatrix:!1,_serializeFields:{content:null},_boundsOptions:{stroke:!1,handle:!1},initialize:function(e){this._content="",this._lines=[];var i=e&&P.isPlainObject(e)&&e.x===k&&e.y===k;this._initialize(i&&e,!i&&R.read(arguments))},_equals:function(t){return this._content===t._content},copyContent:function(t){this.setContent(t._content)},getContent:function(){return this._content},setContent:function(t){this._content=""+t,this._lines=this._content.split(/\r\n|\n|\r/mg),this._changed(521)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),On=Ke.extend({_class:"PointText",initialize:function(){Ke.apply(this,arguments)},getPoint:function(){var t=this._matrix.getTranslation();return new ee(t.x,t.y,this,"setPoint")},setPoint:function(){var t=R.read(arguments);this.translate(t.subtract(this._matrix.getTranslation()))},_draw:function(t,e,i){if(this._content){this._setStyles(t,e,i);var n=this._lines,r=this._style,s=r.hasFill(),u=r.hasStroke(),a=r.getLeading(),o=t.shadowColor;t.font=r.getFontStyle(),t.textAlign=r.getJustification();for(var l=0,d=n.length;l<d;l++){t.shadowColor=o;var _=n[l];s&&(t.fillText(_,0,0),t.shadowColor="rgba(0,0,0,0)"),u&&t.strokeText(_,0,0),t.translate(0,a)}}},_getBounds:function(t,e){var i=this._style,n=this._lines,r=n.length,s=i.getJustification(),u=i.getLeading(),a=this.getView().getTextWidth(i.getFontStyle(),n),o=0;s!=="left"&&(o-=a/(s==="center"?2:1));var l=new ft(o,r?-.75*u:0,a,r*u);return t?t._transformBounds(l,l):l}}),Vt=P.extend(new function(){var t={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation","brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},e={},i={transparent:[0,0,0,0]},n;function r(a){var o=a.match(/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})([\da-f]{2})?$/i)||a.match(/^#([\da-f])([\da-f])([\da-f])([\da-f])?$/i),l="rgb",d;if(o){var _=o[4]?4:3;d=new Array(_);for(var c=0;c<_;c++){var f=o[c+1];d[c]=parseInt(f.length==1?f+f:f,16)/255}}else if(o=a.match(/^(rgb|hsl)a?\((.*)\)$/)){l=o[1],d=o[2].trim().split(/[,\s]+/g);for(var y=l==="hsl",c=0,v=Math.min(d.length,4);c<v;c++){var b=d[c],f=parseFloat(b);if(y)if(c===0){var g=b.match(/([a-z]*)$/)[1];f*={turn:360,rad:180/Math.PI,grad:.9}[g]||1}else c<3&&(f/=100);else c<3&&(f/=/%$/.test(b)?100:255);d[c]=f}}else{var m=i[a];if(!m)if(F){n||(n=Ut.getContext(1,1,{willReadFrequently:!0}),n.globalCompositeOperation="copy"),n.fillStyle="rgba(0,0,0,0)",n.fillStyle=a,n.fillRect(0,0,1,1);var h=n.getImageData(0,0,1,1).data;m=i[a]=[h[0]/255,h[1]/255,h[2]/255]}else m=[0,0,0];d=m.slice()}return[l,d]}var s=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],u={"rgb-hsb":function(a,o,l){var d=Math.max(a,o,l),_=Math.min(a,o,l),c=d-_,f=c===0?0:(d==a?(o-l)/c+(o<l?6:0):d==o?(l-a)/c+2:(a-o)/c+4)*60;return[f,d===0?0:c/d,d]},"hsb-rgb":function(a,o,l){a=(a/60%6+6)%6;var _=Math.floor(a),d=a-_,_=s[_],c=[l,l*(1-o),l*(1-o*d),l*(1-o*(1-d))];return[c[_[0]],c[_[1]],c[_[2]]]},"rgb-hsl":function(a,o,l){var d=Math.max(a,o,l),_=Math.min(a,o,l),c=d-_,f=c===0,y=f?0:(d==a?(o-l)/c+(o<l?6:0):d==o?(l-a)/c+2:(a-o)/c+4)*60,v=(d+_)/2,b=f?0:v<.5?c/(d+_):c/(2-d-_);return[y,b,v]},"hsl-rgb":function(a,o,l){if(a=(a/360%1+1)%1,o===0)return[l,l,l];for(var d=[a+1/3,a,a-1/3],_=l<.5?l*(1+o):l+o-l*o,c=2*l-_,f=[],y=0;y<3;y++){var v=d[y];v<0&&(v+=1),v>1&&(v-=1),f[y]=6*v<1?c+(_-c)*6*v:2*v<1?_:3*v<2?c+(_-c)*(2/3-v)*6:c}return f},"rgb-gray":function(a,o,l){return[a*.2989+o*.587+l*.114]},"gray-rgb":function(a){return[a,a,a]},"gray-hsb":function(a){return[0,0,a]},"gray-hsl":function(a){return[0,0,a]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return P.each(t,function(a,o){e[o]=[],P.each(a,function(l,d){var _=P.capitalize(l),c=/^(hue|saturation)$/.test(l),f=e[o][d]=o==="gradient"?l==="gradient"?function(y){var v=this._components[0];return y=Je.read(Array.isArray(y)?y:arguments,0,{readNull:!0}),v!==y&&(v&&v._removeOwner(this),y&&y._addOwner(this)),y}:function(){return R.read(arguments,0,{readNull:l==="highlight",clone:!0})}:function(y){return y==null||isNaN(y)?0:+y};this["get"+_]=function(){return this._type===o||c&&/^hs[bl]$/.test(this._type)?this._components[d]:this._convert(o)[d]},this["set"+_]=function(y){this._type!==o&&!(c&&/^hs[bl]$/.test(this._type))&&(this._components=this._convert(o),this._properties=t[o],this._type=o),this._components[d]=f.call(this,y),this._changed()}},this)},{_class:"Color",_readIndex:!0,initialize:function a(o){var l=arguments,d=this.__read,_=0,c,f,y,v;Array.isArray(o)&&(l=o,o=l[0]);var b=o!=null&&typeof o;if(b==="string"&&o in t&&(c=o,o=l[1],Array.isArray(o)?(f=o,y=l[2]):(d&&(_=1),l=P.slice(l,1),b=typeof o)),!f){if(v=b==="number"?l:b==="object"&&o.length!=null?o:null,v){c||(c=v.length>=3?"rgb":"gray");var g=t[c].length;y=v[g],d&&(_+=v===arguments?g+(y!=null?1:0):1),v.length>g&&(v=P.slice(v,0,g))}else if(b==="string"){var m=r(o);c=m[0],f=m[1],f.length===4&&(y=f[3],f.length--)}else if(b==="object")if(o.constructor===a){if(c=o._type,f=o._components.slice(),y=o._alpha,c==="gradient")for(var h=1,p=f.length;h<p;h++){var S=f[h];S&&(f[h]=S.clone())}}else if(o.constructor===Je)c="gradient",v=l;else{c="hue"in o?"lightness"in o?"hsl":"hsb":"gradient"in o||"stops"in o||"radial"in o?"gradient":"gray"in o?"gray":"rgb";var x=t[c],w=e[c];this._components=f=[];for(var h=0,p=x.length;h<p;h++){var C=o[x[h]];C==null&&!h&&c==="gradient"&&"stops"in o&&(C={stops:o.stops,radial:o.radial}),C=w[h].call(this,C),C!=null&&(f[h]=C)}y=o.alpha}d&&c&&(_=1)}if(this._type=c||"rgb",!f){this._components=f=[];for(var w=e[this._type],h=0,p=w.length;h<p;h++){var C=w[h].call(this,v&&v[h]);C!=null&&(f[h]=C)}}return this._components=f,this._properties=t[this._type],this._alpha=y,d&&(this.__read=_),this},set:"#initialize",_serialize:function(a,o){var l=this.getComponents();return P.serialize(/^(gray|rgb)$/.test(this._type)?l:[this._type].concat(l),a,!0,o)},_changed:function(){this._canvasStyle=null,this._owner&&(this._setter?this._owner[this._setter](this):this._owner._changed(129))},_convert:function(a){var o;return this._type===a?this._components.slice():(o=u[this._type+"-"+a])?o.apply(this,this._components):u["rgb-"+a].apply(this,u[this._type+"-rgb"].apply(this,this._components))},convert:function(a){return new Vt(a,this._convert(a),this._alpha)},getType:function(){return this._type},setType:function(a){this._components=this._convert(a),this._properties=t[a],this._type=a},getComponents:function(){var a=this._components.slice();return this._alpha!=null&&a.push(this._alpha),a},getAlpha:function(){return this._alpha!=null?this._alpha:1},setAlpha:function(a){this._alpha=a==null?null:Math.min(Math.max(a,0),1),this._changed()},hasAlpha:function(){return this._alpha!=null},equals:function(a){var o=P.isPlainValue(a,!0)?Vt.read(arguments):a;return o===this||o&&this._class===o._class&&this._type===o._type&&this.getAlpha()===o.getAlpha()&&P.equals(this._components,o._components)||!1},toString:function(){for(var a=this._properties,o=[],l=this._type==="gradient",d=$t.instance,_=0,c=a.length;_<c;_++){var f=this._components[_];f!=null&&o.push(a[_]+": "+(l?f:d.number(f)))}return this._alpha!=null&&o.push("alpha: "+d.number(this._alpha)),"{ "+o.join(", ")+" }"},toCSS:function(a){var o=this._convert("rgb"),l=a||this._alpha==null?1:this._alpha;function d(_){return Math.round((_<0?0:_>1?1:_)*255)}return o=[d(o[0]),d(o[1]),d(o[2])],l<1&&o.push(l<0?0:l),a?"#"+((1<<24)+(o[0]<<16)+(o[1]<<8)+o[2]).toString(16).slice(1):(o.length==4?"rgba(":"rgb(")+o.join(",")+")"},toCanvasStyle:function(a,o){if(this._canvasStyle)return this._canvasStyle;if(this._type!=="gradient")return this._canvasStyle=this.toCSS();var l=this._components,d=l[0],_=d._stops,c=l[1],f=l[2],y=l[3],v=o&&o.inverted(),b;if(v&&(c=v._transformPoint(c),f=v._transformPoint(f),y&&(y=v._transformPoint(y))),d._radial){var g=f.getDistance(c);if(y){var m=y.subtract(c);m.getLength()>g&&(y=c.add(m.normalize(g-.1)))}var h=y||c;b=a.createRadialGradient(h.x,h.y,0,c.x,c.y,g)}else b=a.createLinearGradient(c.x,c.y,f.x,f.y);for(var p=0,S=_.length;p<S;p++){var x=_[p],w=x._offset;b.addColorStop(w??p/(S-1),x._color.toCanvasStyle())}return this._canvasStyle=b},transform:function(a){if(this._type==="gradient"){for(var o=this._components,l=1,d=o.length;l<d;l++){var _=o[l];a._transformPoint(_,_,!0)}this._changed()}},statics:{_types:t,random:function(){var a=Math.random;return new Vt(a(),a(),a())},_setOwner:function(a,o,l){return a&&(a._owner&&o&&a._owner!==o&&(a=a.clone()),!a._owner^!o&&(a._owner=o||null,a._setter=l||null)),a}}})},new function(){var t={add:function(e,i){return e+i},subtract:function(e,i){return e-i},multiply:function(e,i){return e*i},divide:function(e,i){return e/i}};return P.each(t,function(e,i){this[i]=function(n){n=Vt.read(arguments);for(var r=this._type,s=this._components,u=n._convert(r),a=0,o=s.length;a<o;a++)u[a]=e(s[a],u[a]);return new Vt(r,u,this._alpha!=null?e(this._alpha,n.getAlpha()):null)}},{})}),Je=P.extend({_class:"Gradient",initialize:function(e,i){this._id=ze.get(),e&&P.isPlainObject(e)&&(this.set(e),e=i=null),this._stops==null&&this.setStops(e||["white","black"]),this._radial==null&&this.setRadial(typeof i=="string"&&i==="radial"||i||!1)},_serialize:function(t,e){return e.add(this,function(){return P.serialize([this._stops,this._radial],t,!0,e)})},_changed:function(){for(var t=0,e=this._owners&&this._owners.length;t<e;t++)this._owners[t]._changed()},_addOwner:function(t){this._owners||(this._owners=[]),this._owners.push(t)},_removeOwner:function(t){var e=this._owners?this._owners.indexOf(t):-1;e!=-1&&(this._owners.splice(e,1),this._owners.length||(this._owners=k))},clone:function(){for(var t=[],e=0,i=this._stops.length;e<i;e++)t[e]=this._stops[e].clone();return new Je(t,this._radial)},getStops:function(){return this._stops},setStops:function(t){if(t.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");var e=this._stops;if(e)for(var i=0,n=e.length;i<n;i++)e[i]._owner=k;e=this._stops=ci.readList(t,0,{clone:!0});for(var i=0,n=e.length;i<n;i++)e[i]._owner=this;this._changed()},getRadial:function(){return this._radial},setRadial:function(t){this._radial=t,this._changed()},equals:function(t){if(t===this)return!0;if(t&&this._class===t._class){var e=this._stops,i=t._stops,n=e.length;if(n===i.length){for(var r=0;r<n;r++)if(!e[r].equals(i[r]))return!1;return!0}}return!1}}),ci=P.extend({_class:"GradientStop",initialize:function(e,i){var n=e,r=i;typeof e=="object"&&i===k&&(Array.isArray(e)&&typeof e[0]!="number"?(n=e[0],r=e[1]):("color"in e||"offset"in e||"rampPoint"in e)&&(n=e.color,r=e.offset||e.rampPoint||0)),this.setColor(n),this.setOffset(r)},clone:function(){return new ci(this._color.clone(),this._offset)},_serialize:function(t,e){var i=this._color,n=this._offset;return P.serialize(n==null?[i]:[i,n],t,!0,e)},_changed:function(){this._owner&&this._owner._changed(129)},getOffset:function(){return this._offset},setOffset:function(t){this._offset=t,this._changed()},getRampPoint:"#getOffset",setRampPoint:"#setOffset",getColor:function(){return this._color},setColor:function(){Vt._setOwner(this._color,null),this._color=Vt._setOwner(Vt.read(arguments,0),this,"setColor"),this._changed()},equals:function(t){return t===this||t&&this._class===t._class&&this._color.equals(t._color)&&this._offset==t._offset||!1}}),di=P.extend(new function(){var t={fillColor:null,fillRule:"nonzero",strokeColor:null,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",strokeScaling:!0,miterLimit:10,dashOffset:0,dashArray:[],shadowColor:null,shadowBlur:0,shadowOffset:new R,selectedColor:null},e=P.set({},t,{fontFamily:"sans-serif",fontWeight:"normal",fontSize:12,leading:null,justification:"left"}),i=P.set({},e,{fillColor:new Vt}),n={strokeWidth:193,strokeCap:193,strokeJoin:193,strokeScaling:201,miterLimit:193,fontFamily:9,fontWeight:9,fontSize:9,font:9,leading:9,justification:9},r={beans:!0},s={_class:"Style",beans:!0,initialize:function(a,o,l){this._values={},this._owner=o,this._project=o&&o._project||l||bt.project,this._defaults=!o||o instanceof X?e:o instanceof Ke?i:t,a&&this.set(a)}};return P.each(e,function(u,a){var o=/Color$/.test(a),l=a==="shadowOffset",d=P.capitalize(a),_=n[a],c="set"+d,f="get"+d;s[c]=function(y){var v=this._owner,b=v&&v._children,g=b&&b.length>0&&!(v instanceof pe);if(g)for(var m=0,h=b.length;m<h;m++)b[m]._style[c](y);if((a==="selectedColor"||!g)&&a in this._defaults){var p=this._values[a];p!==y&&(o&&(p&&(Vt._setOwner(p,null),p._canvasStyle=null),y&&y.constructor===Vt&&(y=Vt._setOwner(y,v,g&&c))),this._values[a]=y,v&&v._changed(_||129))}},s[f]=function(y){var v=this._owner,b=v&&v._children,g=b&&b.length>0&&!(v instanceof pe),m;if(g&&!y)for(var h=0,p=b.length;h<p;h++){var S=b[h]._style[f]();if(!h)m=S;else if(!P.equals(m,S))return k}else if(a in this._defaults){var m=this._values[a];if(m===k)m=this._defaults[a],m&&m.clone&&(m=m.clone());else{var x=o?Vt:l?R:null;x&&!(m&&m.constructor===x)&&(this._values[a]=m=x.read([m],0,{readNull:!0,clone:!0}))}}return m&&o&&(m=Vt._setOwner(m,v,g&&c)),m},r[f]=function(y){return this._style[f](y)},r[c]=function(y){this._style[c](y)}}),P.each({Font:"FontFamily",WindingRule:"FillRule"},function(u,a){var o="get"+a,l="set"+a;s[o]=r[o]="#get"+u,s[l]=r[l]="#set"+u}),mt.inject(r),s},{set:function(t){var e=t instanceof di,i=e?t._values:t;if(i){for(var n in i)if(n in this._defaults){var r=i[n];this[n]=r&&e&&r.clone?r.clone():r}}},equals:function(t){function e(i,n,r){var s=i._values,u=n._values,a=n._defaults;for(var o in s){var l=s[o],d=u[o];if(!(r&&o in u)&&!P.equals(l,d===k?a[o]:d))return!1}return!0}return t===this||t&&this._class===t._class&&e(this,t)&&e(t,this,!0)||!1},_dispose:function(){var t;t=this.getFillColor(),t&&(t._canvasStyle=null),t=this.getStrokeColor(),t&&(t._canvasStyle=null),t=this.getShadowColor(),t&&(t._canvasStyle=null)},hasFill:function(){var t=this.getFillColor();return!!t&&t.alpha>0},hasStroke:function(){var t=this.getStrokeColor();return!!t&&t.alpha>0&&this.getStrokeWidth()>0},hasShadow:function(){var t=this.getShadowColor();return!!t&&t.alpha>0&&(this.getShadowBlur()>0||!this.getShadowOffset().isZero())},getView:function(){return this._project._view},getFontStyle:function(){var t=this.getFontSize();return this.getFontWeight()+" "+t+(/[a-z]/i.test(t+"")?" ":"px ")+this.getFontFamily()},getFont:"#getFontFamily",setFont:"#setFontFamily",getLeading:function t(){var e=t.base.call(this),i=this.getFontSize();return/pt|em|%|px/.test(i)&&(i=this.getView().getPixelSize(i)),e??i*1.2}}),Lt=new function(){function t(e,i,n,r){for(var s=["","webkit","moz","Moz","ms","o"],u=i[0].toUpperCase()+i.substring(1),a=0;a<6;a++){var o=s[a],l=o?o+u:i;if(l in e){if(n)e[l]=r;else return e[l];break}}}return{getStyles:function(e){var i=e&&e.nodeType!==9?e.ownerDocument:e,n=i&&i.defaultView;return n&&n.getComputedStyle(e,"")},getBounds:function(e,i){var n=e.ownerDocument,r=n.body,s=n.documentElement,u;try{u=e.getBoundingClientRect()}catch{u={left:0,top:0,width:0,height:0}}var a=u.left-(s.clientLeft||r.clientLeft||0),o=u.top-(s.clientTop||r.clientTop||0);if(!i){var l=n.defaultView;a+=l.pageXOffset||s.scrollLeft||r.scrollLeft,o+=l.pageYOffset||s.scrollTop||r.scrollTop}return new ft(a,o,u.width,u.height)},getViewportBounds:function(e){var i=e.ownerDocument,n=i.defaultView,r=i.documentElement;return new ft(0,0,n.innerWidth||r.clientWidth,n.innerHeight||r.clientHeight)},getOffset:function(e,i){return Lt.getBounds(e,i).getPoint()},getSize:function(e){return Lt.getBounds(e,!0).getSize()},isInvisible:function(e){return Lt.getSize(e).equals(new ut(0,0))},isInView:function(e){return!Lt.isInvisible(e)&&Lt.getViewportBounds(e).intersects(Lt.getBounds(e,!0))},isInserted:function(e){return q.body.contains(e)},getPrefixed:function(e,i){return e&&t(e,i)},setPrefixed:function(e,i,n){if(typeof i=="object")for(var r in i)t(e,r,!0,i[r]);else t(e,i,!0,n)}}},Ht={add:function(t,e){if(t)for(var i in e)for(var n=e[i],r=i.split(/[\s,]+/g),s=0,u=r.length;s<u;s++){var a=r[s],o=t===q&&(a==="touchstart"||a==="touchmove")?{passive:!1}:!1;t.addEventListener(a,n,o)}},remove:function(t,e){if(t)for(var i in e)for(var n=e[i],r=i.split(/[\s,]+/g),s=0,u=r.length;s<u;s++)t.removeEventListener(r[s],n,!1)},getPoint:function(t){var e=t.targetTouches?t.targetTouches.length?t.targetTouches[0]:t.changedTouches[0]:t;return new R(e.pageX||e.clientX+q.documentElement.scrollLeft,e.pageY||e.clientY+q.documentElement.scrollTop)},getTarget:function(t){return t.target||t.srcElement},getRelatedTarget:function(t){return t.relatedTarget||t.toElement},getOffset:function(t,e){return Ht.getPoint(t).subtract(Lt.getOffset(e||Ht.getTarget(t)))}};Ht.requestAnimationFrame=new function(){var t=Lt.getPrefixed(F,"requestAnimationFrame"),e=!1,i=[],n;function r(){var s=i;i=[];for(var u=0,a=s.length;u<a;u++)s[u]();e=t&&i.length,e&&t(r)}return function(s){i.push(s),t?e||(t(r),e=!0):n||(n=setInterval(r,1e3/60))}};var zt=P.extend(pt,{_class:"View",initialize:function t(e,i){function n(_){return i[_]||parseInt(i.getAttribute(_),10)}function r(){var _=Lt.getSize(i);return _.isNaN()||_.isZero()?new ut(n("width"),n("height")):_}var s;if(F&&i){this._id=i.getAttribute("id"),this._id==null&&i.setAttribute("id",this._id="paper-view-"+t._id++),Ht.add(i,this._viewEvents);var u="none";if(Lt.setPrefixed(i.style,{userDrag:u,userSelect:u,touchCallout:u,contentZooming:u,tapHighlightColor:"rgba(0,0,0,0)"}),kt.hasAttribute(i,"resize")){var a=this;Ht.add(F,this._windowEvents={resize:function(){a.setViewSize(r())}})}if(s=r(),kt.hasAttribute(i,"stats")&&typeof Stats<"u"){this._stats=new Stats;var o=this._stats.domElement,l=o.style,d=Lt.getOffset(i);l.position="absolute",l.left=d.x+"px",l.top=d.y+"px",q.body.appendChild(o)}}else s=new ut(i),i=null;this._project=e,this._scope=e._scope,this._element=i,this._pixelRatio||(this._pixelRatio=F&&F.devicePixelRatio||1),this._setElementSize(s.width,s.height),this._viewSize=s,t._views.push(this),t._viewsById[this._id]=this,(this._matrix=new Ot)._owner=this,t._focused||(t._focused=this),this._frameItems={},this._frameItemCount=0,this._itemEvents={native:{},virtual:{}},this._autoUpdate=!bt.agent.node,this._needsUpdate=!1},remove:function(){if(!this._project)return!1;zt._focused===this&&(zt._focused=null),zt._views.splice(zt._views.indexOf(this),1),delete zt._viewsById[this._id];var t=this._project;return t._view===this&&(t._view=null),Ht.remove(this._element,this._viewEvents),Ht.remove(F,this._windowEvents),this._element=this._project=null,this.off("frame"),this._animate=!1,this._frameItems={},!0},_events:P.each(mt._itemHandlers.concat(["onResize","onKeyDown","onKeyUp"]),function(t){this[t]={}},{onFrame:{install:function(){this.play()},uninstall:function(){this.pause()}}}),_animate:!1,_time:0,_count:0,getAutoUpdate:function(){return this._autoUpdate},setAutoUpdate:function(t){this._autoUpdate=t,t&&this.requestUpdate()},update:function(){},draw:function(){this.update()},requestUpdate:function(){if(!this._requested){var t=this;Ht.requestAnimationFrame(function(){if(t._requested=!1,t._animate){t.requestUpdate();var e=t._element;(!Lt.getPrefixed(q,"hidden")||kt.getAttribute(e,"keepalive")==="true")&&Lt.isInView(e)&&t._handleFrame()}t._autoUpdate&&t.update()}),this._requested=!0}},play:function(){this._animate=!0,this.requestUpdate()},pause:function(){this._animate=!1},_handleFrame:function(){bt=this._scope;var t=Date.now()/1e3,e=this._last?t-this._last:0;this._last=t,this.emit("frame",new P({delta:e,time:this._time+=e,count:this._count++})),this._stats&&this._stats.update()},_animateItem:function(t,e){var i=this._frameItems;e?(i[t._id]={item:t,time:0,count:0},++this._frameItemCount===1&&this.on("frame",this._handleFrameItems)):(delete i[t._id],--this._frameItemCount===0&&this.off("frame",this._handleFrameItems))},_handleFrameItems:function(t){for(var e in this._frameItems){var i=this._frameItems[e];i.item.emit("frame",new P(t,{time:i.time+=t.delta,count:i.count++}))}},_changed:function(){this._project._changed(4097),this._bounds=this._decomposed=k},getElement:function(){return this._element},getPixelRatio:function(){return this._pixelRatio},getResolution:function(){return this._pixelRatio*72},getViewSize:function(){var t=this._viewSize;return new ne(t.width,t.height,this,"setViewSize")},setViewSize:function(){var t=ut.read(arguments),e=t.subtract(this._viewSize);e.isZero()||(this._setElementSize(t.width,t.height),this._viewSize.set(t),this._changed(),this.emit("resize",{size:t,delta:e}),this._autoUpdate&&this.update())},_setElementSize:function(t,e){var i=this._element;i&&(i.width!==t&&(i.width=t),i.height!==e&&(i.height=e))},getBounds:function(){return this._bounds||(this._bounds=this._matrix.inverted()._transformBounds(new ft(new R,this._viewSize))),this._bounds},getSize:function(){return this.getBounds().getSize()},isVisible:function(){return Lt.isInView(this._element)},isInserted:function(){return Lt.isInserted(this._element)},getPixelSize:function(t){var e=this._element,i;if(e){var n=e.parentNode,r=q.createElement("div");r.style.fontSize=t,n.appendChild(r),i=parseFloat(Lt.getStyles(r).fontSize),n.removeChild(r)}else i=parseFloat(i);return i},getTextWidth:function(t,e){return 0}},P.each(["rotate","scale","shear","skew"],function(t){var e=t==="rotate";this[t]=function(){var i=arguments,n=(e?P:R).read(i),r=R.read(i,0,{readNull:!0});return this.transform(new Ot()[t](n,r||this.getCenter(!0)))}},{_decompose:function(){return this._decomposed||(this._decomposed=this._matrix.decompose())},translate:function(){var t=new Ot;return this.transform(t.translate.apply(t,arguments))},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(){var t=R.read(arguments);this.translate(this.getCenter().subtract(t))},getZoom:function(){var t=this._decompose().scaling;return(t.x+t.y)/2},setZoom:function(t){this.transform(new Ot().scale(t/this.getZoom(),this.getCenter()))},getRotation:function(){return this._decompose().rotation},setRotation:function(t){var e=this.getRotation();e!=null&&t!=null&&this.rotate(t-e)},getScaling:function(){var t=this._decompose().scaling;return new ee(t.x,t.y,this,"setScaling")},setScaling:function(){var t=this.getScaling(),e=R.read(arguments,0,{clone:!0,readNull:!0});t&&e&&this.scale(e.x/t.x,e.y/t.y)},getMatrix:function(){return this._matrix},setMatrix:function(){var t=this._matrix;t.set.apply(t,arguments)},transform:function(t){this._matrix.append(t)},scrollBy:function(){this.translate(R.read(arguments).negate())}}),{projectToView:function(){return this._matrix._transformPoint(R.read(arguments))},viewToProject:function(){return this._matrix._inverseTransform(R.read(arguments))},getEventPoint:function(t){return this.viewToProject(Ht.getOffset(t,this._element))}},{statics:{_views:[],_viewsById:{},_id:0,create:function(t,e){q&&typeof e=="string"&&(e=q.getElementById(e));var i=F?An:zt;return new i(t,e)}}},new function(){if(!F)return;var t,e,i=!1,n=!1;function r(I){var E=Ht.getTarget(I);return E.getAttribute&&zt._viewsById[E.getAttribute("id")]}function s(){var I=zt._focused;if(!I||!I.isVisible()){for(var E=0,L=zt._views.length;E<L;E++)if((I=zt._views[E]).isVisible()){zt._focused=e=I;break}}}function u(I,E,L){I._handleMouseEvent("mousemove",E,L)}var a=F.navigator,o,l,d;a.pointerEnabled||a.msPointerEnabled?(o="pointerdown MSPointerDown",l="pointermove MSPointerMove",d="pointerup pointercancel MSPointerUp MSPointerCancel"):(o="touchstart",l="touchmove",d="touchend touchcancel","ontouchstart"in F&&a.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i)||(o+=" mousedown",l+=" mousemove",d+=" mouseup"));var _={},c={mouseout:function(I){var E=zt._focused,L=Ht.getRelatedTarget(I);if(E&&(!L||L.nodeName==="HTML")){var D=Ht.getOffset(I,E._element),B=D.x,V=Math.abs,j=V(B),K=1<<25,Q=j-K;D.x=V(Q)<j?Q*(B<0?-1:1):B,u(E,I,E.viewToProject(D))}},scroll:s};_[o]=function(I){var E=zt._focused=r(I);i||(i=!0,E._handleMouseEvent("mousedown",I))},c[l]=function(I){var E=zt._focused;if(!n){var L=r(I);L?E!==L&&(E&&u(E,I),t||(t=E),E=zt._focused=e=L):e&&e===E&&(t&&!t.isInserted()&&(t=null),E=zt._focused=t,t=null,s())}E&&u(E,I)},c[o]=function(){n=!0},c[d]=function(I){var E=zt._focused;E&&i&&E._handleMouseEvent("mouseup",I),n=i=!1},Ht.add(q,c),Ht.add(F,{load:s});var f=!1,y=!1,v={doubleclick:"click",mousedrag:"mousemove"},b=!1,g,m,h,p,S,x,w,C;function T(I,E,L,D,B,V,j){var K=!1,Q;function et(U,W){if(U.responds(W)){if(Q||(Q=new zn(W,D,B,E||U,V?B.subtract(V):null)),U.emit(W,Q)&&(f=!0,Q.prevented&&(y=!0),Q.stopped))return K=!0}else{var $=v[W];if($)return et(U,$)}}for(;I&&I!==j&&!et(I,L);)I=I._parent;return K}function M(I,E,L,D,B,V){return I._project.removeOn(L),y=f=!1,S&&T(S,null,L,D,B,V)||E&&E!==S&&!E.isDescendant(S)&&T(E,null,L==="mousedrag"?"mousemove":L,D,B,V,S)||T(I,S||E||I,L,D,B,V)}var z={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}};return{_viewEvents:_,_handleMouseEvent:function(I,E,L){var D=this._itemEvents,B=D.native[I],V=I==="mousemove",j=this._scope.tool,K=this;function Q(ht){return D.virtual[ht]||K.responds(ht)||j&&j.responds(ht)}V&&i&&Q("mousedrag")&&(I="mousedrag"),L||(L=this.getEventPoint(E));var et=this.getBounds().contains(L),U=B&&et&&K._project.hitTest(L,{tolerance:0,fill:!0,stroke:!0}),W=U&&U.item||null,$=!1,rt={};if(rt[I.substr(5)]=!0,B&&W!==p&&(p&&T(p,null,"mouseleave",E,L),W&&T(W,null,"mouseenter",E,L),p=W),b^et&&(T(this,null,et?"mouseenter":"mouseleave",E,L),$=!0),(et||rt.drag)&&!L.equals(m)&&(M(this,W,V?I:"mousemove",E,L,m),$=!0),b=et,rt.down&&et||rt.up&&g){if(M(this,W,I,E,L,g),rt.down){if(C=W===x&&Date.now()-w<300,h=x=W,!y&&W){for(var it=W;it&&!it.responds("mousedrag");)it=it._parent;it&&(S=W)}g=L}else rt.up&&(!y&&W===h&&(w=Date.now(),M(this,W,C?"doubleclick":"click",E,L,g),C=!1),h=S=null);b=!1,$=!0}m=L,$&&j&&(f=j._handleMouseEvent(I,E,L,rt)||f),E.cancelable!==!1&&(f&&!rt.move||rt.down&&Q("mouseup"))&&E.preventDefault()},_handleKeyEvent:function(I,E,L,D){var B=this._scope,V=B.tool,j;function K(Q){Q.responds(I)&&(bt=B,Q.emit(I,j=j||new En(I,E,L,D)))}this.isVisible()&&(K(this),V&&V.responds(I)&&K(V))},_countItemEvent:function(I,E){var L=this._itemEvents,D=L.native,B=L.virtual;for(var V in z)D[V]=(D[V]||0)+(z[V][I]||0)*E;B[I]=(B[I]||0)+E},statics:{updateFocus:s,_resetState:function(){i=n=f=b=!1,t=e=g=m=h=p=S=x=w=C=null}}}}),An=zt.extend({_class:"CanvasView",initialize:function(e,i){if(!(i instanceof F.HTMLCanvasElement)){var n=ut.read(arguments,1);if(n.isZero())throw new Error("Cannot create CanvasView with the provided argument: "+P.slice(arguments,1));i=Ut.getCanvas(n)}var r=this._context=i.getContext("2d");if(r.save(),this._pixelRatio=1,!/^off|false$/.test(kt.getAttribute(i,"hidpi"))){var s=F.devicePixelRatio||1,u=Lt.getPrefixed(r,"backingStorePixelRatio")||1;this._pixelRatio=s/u}zt.call(this,e,i),this._needsUpdate=!0},remove:function t(){return this._context.restore(),t.base.call(this)},_setElementSize:function t(e,i){var n=this._pixelRatio;if(t.base.call(this,e*n,i*n),n!==1){var r=this._element,s=this._context;if(!kt.hasAttribute(r,"resize")){var u=r.style;u.width=e+"px",u.height=i+"px"}s.restore(),s.save(),s.scale(n,n)}},getContext:function(){return this._context},getPixelSize:function t(e){var i=bt.agent,n;if(i&&i.firefox)n=t.base.call(this,e);else{var r=this._context,s=r.font;r.font=e+" serif",n=parseFloat(r.font),r.font=s}return n},getTextWidth:function(t,e){var i=this._context,n=i.font,r=0;i.font=t;for(var s=0,u=e.length;s<u;s++)r=Math.max(r,i.measureText(e[s]).width);return i.font=n,r},update:function(){if(!this._needsUpdate)return!1;var t=this._project,e=this._context,i=this._viewSize;return e.clearRect(0,0,i.width+1,i.height+1),t&&t.draw(e,this._matrix,this._pixelRatio),this._needsUpdate=!1,!0}}),Ye=P.extend({_class:"Event",initialize:function(e){this.event=e,this.type=e&&e.type},prevented:!1,stopped:!1,preventDefault:function(){this.prevented=!0,this.event.preventDefault()},stopPropagation:function(){this.stopped=!0,this.event.stopPropagation()},stop:function(){this.stopPropagation(),this.preventDefault()},getTimeStamp:function(){return this.event.timeStamp},getModifiers:function(){return qi.modifiers}}),En=Ye.extend({_class:"KeyEvent",initialize:function(e,i,n,r){this.type=e,this.event=i,this.key=n,this.character=r},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),qi=new function(){var t={"	":"tab"," ":"space","\b":"backspace","":"delete",Spacebar:"space",Del:"delete",Win:"meta",Esc:"escape"},e={tab:"	",space:" ",enter:"\r"},i={},n={},r,s,u=new P({shift:!1,control:!1,alt:!1,meta:!1,capsLock:!1,space:!1}).inject({option:{get:function(){return this.alt}},command:{get:function(){var l=bt&&bt.agent;return l&&l.mac?this.meta:this.control}}});function a(l){var d=l.key||l.keyIdentifier;return d=/^U\+/.test(d)?String.fromCharCode(parseInt(d.substr(2),16)):/^Arrow[A-Z]/.test(d)?d.substr(5):d==="Unidentified"||d===k?String.fromCharCode(l.keyCode):d,t[d]||(d.length>1?P.hyphenate(d):d.toLowerCase())}function o(l,d,_,c){var f=zt._focused,y;if(i[d]=l,l?n[d]=_:delete n[d],d.length>1&&(y=P.camelize(d))in u){u[y]=l;var v=bt&&bt.agent;if(y==="meta"&&v&&v.mac)if(l)r={};else{for(var b in r)b in n&&o(!1,b,r[b],c);r=null}}else l&&r&&(r[d]=_);f&&f._handleKeyEvent(l?"keydown":"keyup",c,d,_)}return Ht.add(q,{keydown:function(l){var d=a(l),_=bt&&bt.agent;d.length>1||_&&_.chrome&&(l.altKey||_.mac&&l.metaKey||!_.mac&&l.ctrlKey)?o(!0,d,e[d]||(d.length>1?"":d),l):s=d},keypress:function(l){if(s){var d=a(l),_=l.charCode,c=_>=32?String.fromCharCode(_):d.length>1?"":d;d!==s&&(d=c.toLowerCase()),o(!0,d,c,l),s=null}},keyup:function(l){var d=a(l);d in n&&o(!1,d,n[d],l)}}),Ht.add(F,{blur:function(l){for(var d in n)o(!1,d,n[d],l)}}),{modifiers:u,isDown:function(l){return!!i[l]}}},zn=Ye.extend({_class:"MouseEvent",initialize:function(e,i,n,r,s){this.type=e,this.event=i,this.point=n,this.target=r,this.delta=s},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}}),Ln=Ye.extend({_class:"ToolEvent",_item:null,initialize:function(e,i,n){this.tool=e,this.type=i,this.event=n},_choosePoint:function(t,e){return t||(e?e.clone():null)},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function(t){this._point=t},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(t){this._lastPoint=t},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(t){this._downPoint=t},getMiddlePoint:function(){return!this._middlePoint&&this.tool._lastPoint?this.tool._point.add(this.tool._lastPoint).divide(2):this._middlePoint},setMiddlePoint:function(t){this._middlePoint=t},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(t){this._delta=t},getCount:function(){return this.tool[/^mouse(down|up)$/.test(this.type)?"_downCount":"_moveCount"]},setCount:function(t){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=t},getItem:function(){if(!this._item){var t=this.tool._scope.project.hitTest(this.getPoint());if(t){for(var e=t.item,i=e._parent;/^(Group|CompoundPath)$/.test(i._class);)e=i,i=i._parent;this._item=e}}return this._item},setItem:function(t){this._item=t},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}}),Nn=jt.extend({_class:"Tool",_list:"tools",_reference:"tool",_events:["onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onActivate","onDeactivate","onEditOptions","onKeyDown","onKeyUp"],initialize:function(e){jt.call(this),this._moveCount=-1,this._downCount=-1,this.set(e)},getMinDistance:function(){return this._minDistance},setMinDistance:function(t){this._minDistance=t,t!=null&&this._maxDistance!=null&&t>this._maxDistance&&(this._maxDistance=t)},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(t){this._maxDistance=t,this._minDistance!=null&&t!=null&&t<this._minDistance&&(this._minDistance=t)},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(t){this._minDistance=this._maxDistance=t},_handleMouseEvent:function(t,e,i,n){bt=this._scope,n.drag&&!this.responds(t)&&(t="mousemove");var r=n.move||n.drag,s=this.responds(t),u=!1,a=this;function o(d,_){var c=i,f=r?a._point:a._downPoint||c;if(r){if(a._moveCount>=0&&c.equals(f))return!1;if(f&&(d!=null||_!=null)){var y=c.subtract(f),v=y.getLength();if(v<(d||0))return!1;_&&(c=f.add(y.normalize(Math.min(v,_))))}a._moveCount++}return a._point=c,a._lastPoint=f||c,n.down&&(a._moveCount=-1,a._downPoint=c,a._downCount++),!0}function l(){s&&(u=a.emit(t,new Ln(a,t,e))||u)}if(n.down)o(),l();else if(n.up)o(null,this._maxDistance),l();else if(s)for(;o(this._minDistance,this._maxDistance);)l();return u}}),Rn=P.extend(pt,{_class:"Tween",statics:{easings:new P({linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return t<.5?2*t*t:-1+2*(2-t)*t},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return--t*t*t+1},easeInOutCubic:function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return 1- --t*t*t*t},easeInOutQuart:function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return 1+--t*t*t*t*t},easeInOutQuint:function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t}})},initialize:function t(e,i,n,r,s,u){this.object=e;var a=typeof s,o=a==="function";this.type=o?a:a==="string"?s:"linear",this.easing=o?s:t.easings[this.type],this.duration=r,this.running=!1,this._then=null,this._startTime=null;var l=i||n;this._keys=l?Object.keys(l):[],this._parsedKeys=this._parseKeys(this._keys),this._from=l&&this._getState(i),this._to=l&&this._getState(n),u!==!1&&this.start()},then:function(t){return this._then=t,this},start:function(){return this._startTime=null,this.running=!0,this},stop:function(){return this.running=!1,this},update:function(t){if(this.running){t>=1&&(t=1,this.running=!1);for(var e=this.easing(t),i=this._keys,n=function(d){return typeof d=="function"?d(e,t):d},r=0,s=i&&i.length;r<s;r++){var u=i[r],a=n(this._from[u]),o=n(this._to[u]),l=a&&o&&a.__add&&o.__add?o.__subtract(a).__multiply(e).__add(a):(o-a)*e+a;this._setProperty(this._parsedKeys[u],l)}this.responds("update")&&this.emit("update",new P({progress:t,factor:e})),!this.running&&this._then&&this._then(this.object)}return this},_events:{onUpdate:{}},_handleFrame:function(t){var e=this._startTime,i=e?(t-e)/this.duration:0;e||(this._startTime=t),this.update(i)},_getState:function(t){for(var e=this._keys,i={},n=0,r=e.length;n<r;n++){var s=e[n],u=this._parsedKeys[s],a=this._getProperty(u),o;if(t){var l=this._resolveValue(a,t[s]);this._setProperty(u,l),o=this._getProperty(u),o=o&&o.clone?o.clone():o,this._setProperty(u,a)}else o=a&&a.clone?a.clone():a;i[s]=o}return i},_resolveValue:function(t,e){if(e){if(Array.isArray(e)&&e.length===2){var i=e[0];return i&&i.match&&i.match(/^[+\-\*\/]=/)?this._calculate(t,i[0],e[1]):e}else if(typeof e=="string"){var n=e.match(/^[+\-*/]=(.*)/);if(n){var r=JSON.parse(n[1].replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": '));return this._calculate(t,e[0],r)}}}return e},_calculate:function(t,e,i){return bt.PaperScript.calculateBinary(t,e,i)},_parseKeys:function(t){for(var e={},i=0,n=t.length;i<n;i++){var r=t[i],s=r.replace(/\.([^.]*)/g,"/$1").replace(/\[['"]?([^'"\]]*)['"]?\]/g,"/$1");e[r]=s.split("/")}return e},_getProperty:function(t,e){for(var i=this.object,n=0,r=t.length-(e||0);n<r&&i;n++)i=i[t[n]];return i},_setProperty:function(t,e){var i=this._getProperty(t,1);i&&(i[t[t.length-1]]=e)}}),Vi={request:function(t){var e=new A.XMLHttpRequest;return e.open((t.method||"get").toUpperCase(),t.url,P.pick(t.async,!0)),t.mimeType&&e.overrideMimeType(t.mimeType),e.onload=function(){var i=e.status;i===0||i===200?t.onLoad&&t.onLoad.call(e,e.responseText):e.onerror()},e.onerror=function(){var i=e.status,n='Could not load "'+t.url+'" (Status: '+i+")";if(t.onError)t.onError(n,i);else throw new Error(n)},e.send(null)}},Ut=P.exports.CanvasProvider={canvases:[],getCanvas:function(t,e,i){if(!F)return null;var n,r=!0;typeof t=="object"&&(e=t.height,t=t.width),this.canvases.length?n=this.canvases.pop():(n=q.createElement("canvas"),r=!1);var s=n.getContext("2d",i||{});if(!s)throw new Error("Canvas "+n+" is unable to provide a 2D context.");return n.width===t&&n.height===e?r&&s.clearRect(0,0,t+1,e+1):(n.width=t,n.height=e),s.save(),n},getContext:function(t,e,i){var n=this.getCanvas(t,e,i);return n?n.getContext("2d",i||{}):null},release:function(t){var e=t&&t.canvas?t.canvas:t;e&&e.getContext&&(e.getContext("2d").restore(),this.canvases.push(e))}},gi=new function(){var t=Math.min,e=Math.max,i=Math.abs,n,r,s,u,a,o,l,d,_,c,f;function y(S,x,w){return .2989*S+.587*x+.114*w}function v(S,x,w,M){var T=M-y(S,x,w);_=S+T,c=x+T,f=w+T;var M=y(_,c,f),z=t(_,c,f),I=e(_,c,f);if(z<0){var E=M-z;_=M+(_-M)*M/E,c=M+(c-M)*M/E,f=M+(f-M)*M/E}if(I>255){var L=255-M,D=I-M;_=M+(_-M)*L/D,c=M+(c-M)*L/D,f=M+(f-M)*L/D}}function b(S,x,w){return e(S,x,w)-t(S,x,w)}function g(S,x,w,C){var T=[S,x,w],M=e(S,x,w),z=t(S,x,w),I;z=z===S?0:z===x?1:2,M=M===S?0:M===x?1:2,I=t(z,M)===0?e(z,M)===1?2:1:0,T[M]>T[z]?(T[I]=(T[I]-T[z])*C/(T[M]-T[z]),T[M]=C):T[I]=T[M]=0,T[z]=0,_=T[0],c=T[1],f=T[2]}var m={multiply:function(){_=a*n/255,c=o*r/255,f=l*s/255},screen:function(){_=a+n-a*n/255,c=o+r-o*r/255,f=l+s-l*s/255},overlay:function(){_=a<128?2*a*n/255:255-2*(255-a)*(255-n)/255,c=o<128?2*o*r/255:255-2*(255-o)*(255-r)/255,f=l<128?2*l*s/255:255-2*(255-l)*(255-s)/255},"soft-light":function(){var S=n*a/255;_=S+a*(255-(255-a)*(255-n)/255-S)/255,S=r*o/255,c=S+o*(255-(255-o)*(255-r)/255-S)/255,S=s*l/255,f=S+l*(255-(255-l)*(255-s)/255-S)/255},"hard-light":function(){_=n<128?2*n*a/255:255-2*(255-n)*(255-a)/255,c=r<128?2*r*o/255:255-2*(255-r)*(255-o)/255,f=s<128?2*s*l/255:255-2*(255-s)*(255-l)/255},"color-dodge":function(){_=a===0?0:n===255?255:t(255,255*a/(255-n)),c=o===0?0:r===255?255:t(255,255*o/(255-r)),f=l===0?0:s===255?255:t(255,255*l/(255-s))},"color-burn":function(){_=a===255?255:n===0?0:e(0,255-(255-a)*255/n),c=o===255?255:r===0?0:e(0,255-(255-o)*255/r),f=l===255?255:s===0?0:e(0,255-(255-l)*255/s)},darken:function(){_=a<n?a:n,c=o<r?o:r,f=l<s?l:s},lighten:function(){_=a>n?a:n,c=o>r?o:r,f=l>s?l:s},difference:function(){_=a-n,_<0&&(_=-_),c=o-r,c<0&&(c=-c),f=l-s,f<0&&(f=-f)},exclusion:function(){_=a+n*(255-a-a)/255,c=o+r*(255-o-o)/255,f=l+s*(255-l-l)/255},hue:function(){g(n,r,s,b(a,o,l)),v(_,c,f,y(a,o,l))},saturation:function(){g(a,o,l,b(n,r,s)),v(_,c,f,y(a,o,l))},luminosity:function(){v(a,o,l,y(n,r,s))},color:function(){v(n,r,s,y(a,o,l))},add:function(){_=t(a+n,255),c=t(o+r,255),f=t(l+s,255)},subtract:function(){_=e(a-n,0),c=e(o-r,0),f=e(l-s,0)},average:function(){_=(a+n)/2,c=(o+r)/2,f=(l+s)/2},negation:function(){_=255-i(255-n-a),c=255-i(255-r-o),f=255-i(255-s-l)}},h=this.nativeModes=P.each(["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],function(S){this[S]=!0},{}),p=Ut.getContext(1,1,{willReadFrequently:!0});p&&(P.each(m,function(S,x){var w=x==="darken",C=!1;p.save();try{p.fillStyle=w?"#300":"#a00",p.fillRect(0,0,1,1),p.globalCompositeOperation=x,p.globalCompositeOperation===x&&(p.fillStyle=w?"#a00":"#300",p.fillRect(0,0,1,1),C=p.getImageData(0,0,1,1).data[0]!==w?170:51)}catch{}p.restore(),h[x]=C}),Ut.release(p)),this.process=function(S,x,w,C,T){var M=x.canvas,z=S==="normal";if(z||h[S])w.save(),w.setTransform(1,0,0,1,0,0),w.globalAlpha=C,z||(w.globalCompositeOperation=S),w.drawImage(M,T.x,T.y),w.restore();else{var I=m[S];if(!I)return;for(var E=w.getImageData(T.x,T.y,M.width,M.height),L=E.data,D=x.getImageData(0,0,M.width,M.height).data,B=0,V=L.length;B<V;B+=4){n=D[B],a=L[B],r=D[B+1],o=L[B+1],s=D[B+2],l=L[B+2],u=D[B+3],d=L[B+3],I();var j=u*C/255,K=1-j;L[B]=j*_+K*a,L[B+1]=j*c+K*o,L[B+2]=j*f+K*l,L[B+3]=u*C+K*d}w.putImageData(E,T.x,T.y)}}},Nt=new function(){var t="http://www.w3.org/2000/svg",e="http://www.w3.org/2000/xmlns",i="http://www.w3.org/1999/xlink",n={href:i,xlink:e,xmlns:e+"/","xmlns:xlink":e+"/"};function r(a,o,l){return u(q.createElementNS(t,a),o,l)}function s(a,o){var l=n[o],d=l?a.getAttributeNS(l,o):a.getAttribute(o);return d==="null"?null:d}function u(a,o,l){for(var d in o){var _=o[d],c=n[d];typeof _=="number"&&l&&(_=l.number(_)),c?a.setAttributeNS(c,d,_):a.setAttribute(d,_)}return a}return{svg:t,xmlns:e,xlink:i,create:r,get:s,set:u}},Hi=P.each({fillColor:["fill","color"],fillRule:["fill-rule","string"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],strokeScaling:["vector-effect","lookup",{true:"none",false:"non-scaling-stroke"},function(t,e){return!e&&(t instanceof re||t instanceof Y||t instanceof Ke)}],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],fontFamily:["font-family","string"],fontWeight:["font-weight","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","style"]},function(t,e){var i=P.capitalize(e),n=t[2];this[e]={type:t[1],property:e,attribute:t[0],toSVG:n,fromSVG:n&&P.each(n,function(r,s){this[r]=s},{}),exportFilter:t[3],get:"get"+i,set:"set"+i}},{});new function(){var t;function e(m,h,p){var S=new P,x=m.getTranslation();if(h){var w;m.isInvertible()?(m=m._shiftless(),w=m._inverseTransform(x),x=null):w=new R,S[p?"cx":"x"]=w.x,S[p?"cy":"y"]=w.y}if(!m.isIdentity()){var C=m.decompose();if(C){var T=[],M=C.rotation,z=C.scaling,I=C.skewing;x&&!x.isZero()&&T.push("translate("+t.point(x)+")"),M&&T.push("rotate("+t.number(M)+")"),(!St.isZero(z.x-1)||!St.isZero(z.y-1))&&T.push("scale("+t.point(z)+")"),I.x&&T.push("skewX("+t.number(I.x)+")"),I.y&&T.push("skewY("+t.number(I.y)+")"),S.transform=T.join(" ")}else S.transform="matrix("+m.getValues().join(",")+")"}return S}function i(m,h){for(var p=e(m._matrix),S=m._children,x=Nt.create("g",p,t),w=0,C=S.length;w<C;w++){var T=S[w],M=b(T,h);if(M)if(T.isClipMask()){var z=Nt.create("clipPath");z.appendChild(M),y(T,z,"clip"),Nt.set(x,{"clip-path":"url(#"+z.id+")"})}else x.appendChild(M)}return x}function n(m,h){var p=e(m._matrix,!0),S=m.getSize(),x=m.getImage();return p.x-=S.width/2,p.y-=S.height/2,p.width=S.width,p.height=S.height,p.href=h.embedImages==!1&&x&&x.src||m.toDataURL(),Nt.create("image",p,t)}function r(m,h){var p=h.matchShapes;if(p){var S=m.toShape(!1);if(S)return s(S)}var x=m._segments,w=x.length,C,T=e(m._matrix);if(p&&w>=2&&!m.hasHandles())if(w>2){C=m._closed?"polygon":"polyline";for(var M=[],z=0;z<w;z++)M.push(t.point(x[z]._point));T.points=M.join(" ")}else{C="line";var I=x[0]._point,E=x[1]._point;T.set({x1:I.x,y1:I.y,x2:E.x,y2:E.y})}else C="path",T.d=m.getPathData(null,h.precision);return Nt.create(C,T,t)}function s(m){var h=m._type,p=m._radius,S=e(m._matrix,!0,h!=="rectangle");if(h==="rectangle"){h="rect";var x=m._size,w=x.width,C=x.height;S.x-=w/2,S.y-=C/2,S.width=w,S.height=C,p.isZero()&&(p=null)}return p&&(h==="circle"?S.r=p:(S.rx=p.width,S.ry=p.height)),Nt.create(h,S,t)}function u(m,h){var p=e(m._matrix),S=m.getPathData(null,h.precision);return S&&(p.d=S),Nt.create("path",p,t)}function a(m,h){var p=e(m._matrix,!0),S=m._definition,x=f(S,"symbol"),w=S._item,C=w.getStrokeBounds();return x||(x=Nt.create("symbol",{viewBox:t.rectangle(C)}),x.appendChild(b(w,h)),y(S,x,"symbol")),p.href="#"+x.id,p.x+=C.x,p.y+=C.y,p.width=C.width,p.height=C.height,p.overflow="visible",Nt.create("use",p,t)}function o(m){var h=f(m,"color");if(!h){var p=m.getGradient(),S=p._radial,x=m.getOrigin(),w=m.getDestination(),C;if(S){C={cx:x.x,cy:x.y,r:x.getDistance(w)};var T=m.getHighlight();T&&(C.fx=T.x,C.fy=T.y)}else C={x1:x.x,y1:x.y,x2:w.x,y2:w.y};C.gradientUnits="userSpaceOnUse",h=Nt.create((S?"radial":"linear")+"Gradient",C,t);for(var M=p._stops,z=0,I=M.length;z<I;z++){var E=M[z],L=E._color,D=L.getAlpha(),B=E._offset;C={offset:B??z/(I-1)},L&&(C["stop-color"]=L.toCSS(!0)),D<1&&(C["stop-opacity"]=D),h.appendChild(Nt.create("stop",C,t))}y(m,h,"color")}return"url(#"+h.id+")"}function l(m){var h=Nt.create("text",e(m._matrix,!0),t);return h.textContent=m._content,h}var d={Group:i,Layer:i,Raster:n,Path:r,Shape:s,CompoundPath:u,SymbolItem:a,PointText:l};function _(m,h,p,S){var x={},w=!S&&m.getParent(),C=[];return m._name!=null&&(x.id=m._name),P.each(Hi,function(T){var M=T.get,z=T.type,I=m[M]();if(T.exportFilter?T.exportFilter(m,I):p.reduceAttributes==!1||!w||!P.equals(w[M](),I)){if(z==="color"&&I!=null){var E=I.getAlpha();E<1&&(x[T.attribute+"-opacity"]=E)}z==="style"?C.push(T.attribute+": "+I):x[T.attribute]=I==null?"none":z==="color"?I.gradient?o(I):I.toCSS(!0):z==="array"?I.join(","):z==="lookup"?T.toSVG[I]:I}}),C.length&&(x.style=C.join(";")),x.opacity===1&&delete x.opacity,m._visible||(x.visibility="hidden"),Nt.set(h,x,t)}var c;function f(m,h){return c||(c={ids:{},svgs:{}}),m&&c.svgs[h+"-"+(m._id||m.__id||(m.__id=ze.get("svg")))]}function y(m,h,p){c||f();var S=c.ids[p]=(c.ids[p]||0)+1;h.id=p+"-"+S,c.svgs[p+"-"+(m._id||m.__id)]=h}function v(m,h){var p=m,S=null;if(c){p=m.nodeName.toLowerCase()==="svg"&&m;for(var x in c.svgs)S||(p||(p=Nt.create("svg"),p.appendChild(m)),S=p.insertBefore(Nt.create("defs"),p.firstChild)),S.appendChild(c.svgs[x]);c=null}return h.asString?new A.XMLSerializer().serializeToString(p):p}function b(m,h,p){var S=d[m._class],x=S&&S(m,h);if(x){var w=h.onExport;w&&(x=w(m,x,h)||x);var C=JSON.stringify(m._data);C&&C!=="{}"&&C!=="null"&&x.setAttribute("data-paper-data",C)}return x&&_(m,x,h,p)}function g(m){return m||(m={}),t=new $t(m.precision),m}mt.inject({exportSVG:function(m){return m=g(m),v(b(this,m,!0),m)}}),Ne.inject({exportSVG:function(m){m=g(m);var h=this._children,p=this.getView(),S=P.pick(m.bounds,"view"),x=m.matrix||S==="view"&&p._matrix,w=x&&Ot.read([x]),C=S==="view"?new ft([0,0],p.getViewSize()):S==="content"?mt._getBounds(h,w,{stroke:!0}).rect:ft.read([S],0,{readNull:!0}),T={version:"1.1",xmlns:Nt.svg,"xmlns:xlink":Nt.xlink};C&&(T.width=C.width,T.height=C.height,(C.x||C.x===0||C.y||C.y===0)&&(T.viewBox=t.rectangle(C)));var M=Nt.create("svg",T,t),z=M;w&&!w.isIdentity()&&(z=M.appendChild(Nt.create("g",e(w),t)));for(var I=0,E=h.length;I<E;I++)z.appendChild(b(h[I],m,!0));return v(M,m)}})},new function(){var t={},e;function i(h,p,S,x,w,C){var T=Nt.get(h,p)||C,M=T==null?x?null:S?"":0:S?T:parseFloat(T);return/%\s*$/.test(T)?M/100*(w?1:e[/x|^width/.test(p)?"width":"height"]):M}function n(h,p,S,x,w,C,T){return p=i(h,p||"x",!1,x,w,C),S=i(h,S||"y",!1,x,w,T),x&&(p==null||S==null)?null:new R(p,S)}function r(h,p,S,x,w){return p=i(h,p||"width",!1,x,w),S=i(h,S||"height",!1,x,w),x&&(p==null||S==null)?null:new ut(p,S)}function s(h,p,S){return h==="none"?null:p==="number"?parseFloat(h):p==="array"?h?h.split(/[\s,]+/g).map(parseFloat):[]:p==="color"?b(h)||h:p==="lookup"?S[h]:h}function u(h,p,S,x){var w=h.childNodes,C=p==="clippath",T=p==="defs",M=new X,z=M._project,I=z._currentStyle,E=[];if(!C&&!T&&(M=v(M,h,x),z._currentStyle=M._style.clone()),x)for(var L=h.querySelectorAll("defs"),D=0,B=L.length;D<B;D++)g(L[D],S,!1);for(var D=0,B=w.length;D<B;D++){var V=w[D],j;V.nodeType===1&&!/^defs$/i.test(V.nodeName)&&(j=g(V,S,!1))&&!(j instanceof xt)&&E.push(j)}return M.addChildren(E),C&&(M=v(M.reduce(),h,x)),z._currentStyle=I,(C||T)&&(M.remove(),M=null),M}function a(h,p){for(var S=h.getAttribute("points").match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),x=[],w=0,C=S.length;w<C;w+=2)x.push(new R(parseFloat(S[w]),parseFloat(S[w+1])));var T=new Pt(x);return p==="polygon"&&T.closePath(),T}function o(h){return re.create(h.getAttribute("d"))}function l(h,p){var S=(i(h,"href",!0)||"").substring(1),x=p==="radialgradient",w;if(S)w=t[S].getGradient(),w._radial^x&&(w=w.clone(),w._radial=x);else{for(var C=h.childNodes,T=[],M=0,z=C.length;M<z;M++){var I=C[M];I.nodeType===1&&T.push(v(new ci,I))}w=new Je(T,x)}var E,L,D,B=i(h,"gradientUnits",!0)!=="userSpaceOnUse";x?(E=n(h,"cx","cy",!1,B,"50%","50%"),L=E.add(i(h,"r",!1,!1,B,"50%"),0),D=n(h,"fx","fy",!0,B)):(E=n(h,"x1","y1",!1,B,"0%","0%"),L=n(h,"x2","y2",!1,B,"100%","0%"));var V=v(new Vt(w,E,L,D),h);return V._scaleToBounds=B,null}var d={"#document":function(h,p,S,x){for(var w=h.childNodes,C=0,T=w.length;C<T;C++){var M=w[C];if(M.nodeType===1)return g(M,S,x)}},g:u,svg:u,clippath:u,polygon:a,polyline:a,path:o,lineargradient:l,radialgradient:l,image:function(h){var p=new st(i(h,"href",!0));return p.on("load",function(){var S=r(h);this.setSize(S);var x=n(h).add(S.divide(2));this._matrix.append(new Ot().translate(x))}),p},symbol:function(h,p,S,x){return new xt(u(h,p,S,x),!0)},defs:u,use:function(h){var p=(i(h,"href",!0)||"").substring(1),S=t[p],x=n(h);return S?S instanceof xt?S.place(x):S.clone().translate(x):null},circle:function(h){return new Y.Circle(n(h,"cx","cy"),i(h,"r"))},ellipse:function(h){return new Y.Ellipse({center:n(h,"cx","cy"),radius:r(h,"rx","ry")})},rect:function(h){return new Y.Rectangle(new ft(n(h),r(h)),r(h,"rx","ry"))},line:function(h){return new Pt.Line(n(h,"x1","y1"),n(h,"x2","y2"))},text:function(h){var p=new On(n(h).add(n(h,"dx","dy")));return p.setContent(h.textContent.trim()||""),p},switch:u};function _(h,p,S,x){if(h.transform){for(var w=(x.getAttribute(S)||"").split(/\)\s*/g),C=new Ot,T=0,M=w.length;T<M;T++){var z=w[T];if(!z)break;for(var I=z.split(/\(\s*/),E=I[0].trim(),L=I[1].split(/[\s,]+/g),D=0,B=L.length;D<B;D++)L[D]=parseFloat(L[D]);switch(E){case"matrix":C.append(new Ot(L[0],L[1],L[2],L[3],L[4],L[5]));break;case"rotate":C.rotate(L[0],L[1]||0,L[2]||0);break;case"translate":C.translate(L[0],L[1]||0);break;case"scale":C.scale(L);break;case"skewX":C.skew(L[0],0);break;case"skewY":C.skew(0,L[0]);break}}h.transform(C)}}function c(h,p,S){var x=S==="fill-opacity"?"getFillColor":"getStrokeColor",w=h[x]&&h[x]();w&&w.setAlpha(parseFloat(p))}var f=P.set(P.each(Hi,function(h){this[h.attribute]=function(p,S){if(p[h.set]&&(p[h.set](s(S,h.type,h.fromSVG)),h.type==="color")){var x=p[h.get]();if(x&&x._scaleToBounds){var w=p.getBounds();x.transform(new Ot().translate(w.getPoint()).scale(w.getSize()))}}}},{}),{id:function(h,p){t[p]=h,h.setName&&h.setName(p)},"clip-path":function(h,p){var S=b(p);if(S)if(S=S.clone(),S.setClipMask(!0),h instanceof X)h.insertChild(0,S);else return new X(S,h)},gradientTransform:_,transform:_,"fill-opacity":c,"stroke-opacity":c,visibility:function(h,p){h.setVisible&&h.setVisible(p==="visible")},display:function(h,p){h.setVisible&&h.setVisible(p!==null)},"stop-color":function(h,p){h.setColor&&h.setColor(p)},"stop-opacity":function(h,p){h._color&&h._color.setAlpha(parseFloat(p))},offset:function(h,p){if(h.setOffset){var S=p.match(/(.*)%$/);h.setOffset(S?S[1]/100:parseFloat(p))}},viewBox:function(h,p,S,x,w){var C=new ft(s(p,"array")),T=r(x,null,null,!0),M,z;if(h instanceof X){var I=T?T.divide(C.getSize()):1,z=new Ot().scale(I).translate(C.getPoint().negate());M=h}else h instanceof xt&&(T&&C.setSize(T),M=h._item);if(M){if(y(x,"overflow",w)!=="visible"){var E=new Y.Rectangle(C);E.setClipMask(!0),M.addChild(E)}z&&M.transform(z)}}});function y(h,p,S){var x=h.attributes[p],w=x&&x.value;if(!w&&h.style){var C=P.camelize(p);w=h.style[C],!w&&S.node[C]!==S.parent[C]&&(w=S.node[C])}return w?w==="none"?null:w:k}function v(h,p,S){var x=p.parentNode,w={node:Lt.getStyles(p)||{},parent:!S&&!/^defs$/i.test(x.tagName)&&Lt.getStyles(x)||{}};return P.each(f,function(C,T){var M=y(p,T,w);h=M!==k&&C(h,M,T,p,w)||h}),h}function b(h){var p=h&&h.match(/\((?:["'#]*)([^"')]+)/),S=p&&p[1],x=S&&t[F?S.replace(F.location.href.split("#")[0]+"#",""):S];return x&&x._scaleToBounds&&(x=x.clone(),x._scaleToBounds=!0),x}function g(h,p,S){var x=h.nodeName.toLowerCase(),w=x!=="#document",C=q.body,T,M,z;S&&w&&(e=bt.getView().getSize(),e=r(h,null,null,!0)||e,T=Nt.create("svg",{style:"stroke-width: 1px; stroke-miterlimit: 10"}),M=h.parentNode,z=h.nextSibling,T.appendChild(h),C.appendChild(T));var I=bt.settings,E=I.applyMatrix,L=I.insertItems;I.applyMatrix=!1,I.insertItems=!1;var D=d[x],B=D&&D(h,x,p,S)||null;if(I.insertItems=L,I.applyMatrix=E,B){w&&!(B instanceof X)&&(B=v(B,h,S));var V=p.onImport,j=w&&h.getAttribute("data-paper-data");V&&(B=V(h,B,p)||B),p.expandShapes&&B instanceof Y&&(B.remove(),B=B.toPath()),j&&(B._data=JSON.parse(j))}return T&&(C.removeChild(T),M&&(z?M.insertBefore(h,z):M.appendChild(h))),S&&(t={},B&&P.pick(p.applyMatrix,E)&&B.matrix.apply(!0,!0)),B}function m(h,p,S){if(!h)return null;p=typeof p=="function"?{onLoad:p}:p||{};var x=bt,w=null;function C(I){try{var E=typeof I=="object"?I:new A.DOMParser().parseFromString(I.trim(),"image/svg+xml");if(!E.nodeName)throw E=null,new Error("Unsupported SVG source: "+h);bt=x,w=g(E,p,!0),(!p||p.insert!==!1)&&S._insertItem(k,w);var L=p.onLoad;L&&L(w,I)}catch(D){T(D)}}function T(I,E){var L=p.onError;if(L)L(I,E);else throw new Error(I)}if(typeof h=="string"&&!/^[\s\S]*</.test(h)){var M=q.getElementById(h);M?C(M):Vi.request({url:h,async:!0,onLoad:C,onError:T})}else if(typeof File<"u"&&h instanceof File){var z=new FileReader;return z.onload=function(){C(z.result)},z.onerror=function(){T(z.error)},z.readAsText(h)}else C(h);return w}mt.inject({importSVG:function(h,p){return m(h,p,this)}}),Ne.inject({importSVG:function(h,p){return this.activate(),m(h,p,this)}})},P.exports.PaperScript=(function(){var t=this,e=t.acorn;if(!e&&typeof br<"u")try{e=require("acorn")}catch{}if(!e){var i,n;e=i=n={},function(v,b){if(typeof i=="object"&&typeof n=="object")return b(i);if(typeof k=="function"&&k.amd)return k(["exports"],b);b(v.acorn||(v.acorn={}))}(this,function(v){v.version="0.5.0";var b,g,m,h;v.parse=function(O,N){return g=String(O),m=g.length,S(N),nn(),hr(b.program)};var p=v.defaultOptions={ecmaVersion:5,strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,allowReturnOutsideFunction:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null};function S(O){b=O||{};for(var N in p)Object.prototype.hasOwnProperty.call(b,N)||(b[N]=p[N]);h=b.sourceFile||null}var x=v.getLineInfo=function(O,N){for(var H=1,G=0;;){Be.lastIndex=G;var ct=Be.exec(O);if(ct&&ct.index<N)++H,G=ct.index+ct[0].length;else break}return{line:H,column:N-G}};v.tokenize=function(O,N){g=String(O),m=g.length,S(N),nn();var H={};function G(ct){return j=T,Oe(ct),H.start=C,H.end=T,H.startLoc=M,H.endLoc=z,H.type=I,H.value=E,H}return G.jumpTo=function(ct,dt){if(w=ct,b.locations){D=1,B=Be.lastIndex=0;for(var vt;(vt=Be.exec(g))&&vt.index<ct;)++D,B=vt.index+vt[0].length}L=dt,Fe()},G};var w,C,T,M,z,I,E,L,D,B,V,j,K,Q,et,U;function W(O,N){var H=x(g,O);N+=" ("+H.line+":"+H.column+")";var G=new SyntaxError(N);throw G.pos=O,G.loc=H,G.raisedAt=w,G}var $=[],rt={type:"num"},it={type:"regexp"},ht={type:"string"},ot={type:"name"},_t={type:"eof"},wt={keyword:"break"},gt={keyword:"case",beforeExpr:!0},Zt={keyword:"catch"},Wt={keyword:"continue"},Yt={keyword:"debugger"},Rt={keyword:"default"},At={keyword:"do",isLoop:!0},Dt={keyword:"else",beforeExpr:!0},se={keyword:"finally"},Gt={keyword:"for",isLoop:!0},le={keyword:"function"},xe={keyword:"if"},he={keyword:"return",beforeExpr:!0},fe={keyword:"switch"},ae={keyword:"throw",beforeExpr:!0},ue={keyword:"try"},Ce={keyword:"var"},ce={keyword:"while",isLoop:!0},Qe={keyword:"with"},Ui={keyword:"new",beforeExpr:!0},Zi={keyword:"this"},Wi={keyword:"null",atomValue:null},Gi={keyword:"true",atomValue:!0},ji={keyword:"false",atomValue:!1},$e={keyword:"in",binop:7,beforeExpr:!0},_i={break:wt,case:gt,catch:Zt,continue:Wt,debugger:Yt,default:Rt,do:At,else:Dt,finally:se,for:Gt,function:le,if:xe,return:he,switch:fe,throw:ae,try:ue,var:Ce,while:ce,with:Qe,null:Wi,true:Gi,false:ji,new:Ui,in:$e,instanceof:{keyword:"instanceof",binop:7,beforeExpr:!0},this:Zi,typeof:{keyword:"typeof",prefix:!0,beforeExpr:!0},void:{keyword:"void",prefix:!0,beforeExpr:!0},delete:{keyword:"delete",prefix:!0,beforeExpr:!0}},ti={type:"[",beforeExpr:!0},ei={type:"]"},Re={type:"{",beforeExpr:!0},Te={type:"}"},me={type:"(",beforeExpr:!0},de={type:")"},be={type:",",beforeExpr:!0},we={type:";",beforeExpr:!0},De={type:":",beforeExpr:!0},vi={type:"."},pi={type:"?",beforeExpr:!0},mi={binop:10,beforeExpr:!0},wi={isAssign:!0,beforeExpr:!0},Me={isAssign:!0,beforeExpr:!0},Dn={postfix:!0,prefix:!0,isUpdate:!0},Xi={prefix:!0,beforeExpr:!0},Ki={binop:1,beforeExpr:!0},Ji={binop:2,beforeExpr:!0},Bn={binop:3,beforeExpr:!0},Fn={binop:4,beforeExpr:!0},qn={binop:5,beforeExpr:!0},Vn={binop:6,beforeExpr:!0},Hn={binop:7,beforeExpr:!0},Un={binop:8,beforeExpr:!0},Zn={binop:9,prefix:!0,beforeExpr:!0},Wn={binop:10,beforeExpr:!0};v.tokTypes={bracketL:ti,bracketR:ei,braceL:Re,braceR:Te,parenL:me,parenR:de,comma:be,semi:we,colon:De,dot:vi,question:pi,slash:mi,eq:wi,name:ot,eof:_t,num:rt,regexp:it,string:ht};for(var Yi in _i)v.tokTypes["_"+Yi]=_i[Yi];function Ve(O){O=O.split(" ");var N="",H=[];t:for(var G=0;G<O.length;++G){for(var ct=0;ct<H.length;++ct)if(H[ct][0].length==O[G].length){H[ct].push(O[G]);continue t}H.push([O[G]])}function dt(Mt){if(Mt.length==1)return N+="return str === "+JSON.stringify(Mt[0])+";";N+="switch(str){";for(var _e=0;_e<Mt.length;++_e)N+="case "+JSON.stringify(Mt[_e])+":";N+="return true}return false;"}if(H.length>3){H.sort(function(Mt,_e){return _e.length-Mt.length}),N+="switch(str.length){";for(var G=0;G<H.length;++G){var vt=H[G];N+="case "+vt[0].length+":",dt(vt)}N+="}"}else dt(O);return new Function("str",N)}var Gn=Ve("abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile"),jn=Ve("class enum extends super const export import"),Qi=Ve("implements interface let package private protected public static yield"),ii=Ve("eval arguments"),Xn=Ve("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),Kn=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/,$i="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",Jn="̀-ͯ҃-֑҇-ׇֽֿׁׂׅׄؐ-ؚؠ-ىٲ-ۓۧ-ۨۻ-ۼܰ-݊ࠀ-ࠔࠛ-ࠣࠥ-ࠧࠩ-࠭ࡀ-ࡗࣤ-ࣾऀ-ःऺ-़ा-ॏ॑-ॗॢ-ॣ०-९ঁ-ঃ়া-ৄেৈৗয়-ৠਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢ-ૣ૦-૯ଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୟ-ୠ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఁ-ఃె-ైొ-్ౕౖౢ-ౣ౦-౯ಂಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢ-ೣ೦-೯ംഃെ-ൈൗൢ-ൣ൦-൯ංඃ්ා-ුූෘ-ෟෲෳิ-ฺเ-ๅ๐-๙ິ-ູ່-ໍ໐-໙༘༙༠-༩༹༵༷ཁ-ཇཱ-྄྆-྇ྍ-ྗྙ-ྼ࿆က-ဩ၀-၉ၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟ᜎ-ᜐᜠ-ᜰᝀ-ᝐᝲᝳក-ឲ៝០-៩᠋-᠍᠐-᠙ᤠ-ᤫᤰ-᤻ᥑ-ᥭᦰ-ᧀᧈ-ᧉ᧐-᧙ᨀ-ᨕᨠ-ᩓ᩠-᩿᩼-᪉᪐-᪙ᭆ-ᭋ᭐-᭙᭫-᭳᮰-᮹᯦-᯳ᰀ-ᰢ᱀-᱉ᱛ-ᱽ᳐-᳒ᴀ-ᶾḁ-ἕ‌‍‿⁀⁔⃐-⃥⃜⃡-⃰ⶁ-ⶖⷠ-ⷿ〡-〨゙゚Ꙁ-ꙭꙴ-꙽ꚟ꛰-꛱ꟸ-ꠀ꠆ꠋꠣ-ꠧꢀ-ꢁꢴ-꣄꣐-꣙ꣳ-ꣷ꤀-꤉ꤦ-꤭ꤰ-ꥅꦀ-ꦃ꦳-꧀ꨀ-ꨧꩀ-ꩁꩌ-ꩍ꩐-꩙ꩻꫠ-ꫩꫲ-ꫳꯀ-ꯡ꯬꯭꯰-꯹ﬠ-ﬨ︀-️︠-︦︳︴﹍-﹏０-９＿",tn=new RegExp("["+$i+"]"),Yn=new RegExp("["+$i+Jn+"]"),ni=/[\n\r\u2028\u2029]/,Be=/\r\n|[\n\r\u2028\u2029]/g,ri=v.isIdentifierStart=function(O){return O<65?O===36:O<91?!0:O<97?O===95:O<123?!0:O>=170&&tn.test(String.fromCharCode(O))},en=v.isIdentifierChar=function(O){return O<48?O===36:O<58?!0:O<65?!1:O<91?!0:O<97?O===95:O<123?!0:O>=170&&Yn.test(String.fromCharCode(O))};function ke(){this.line=D,this.column=w-B}function nn(){D=1,w=B=0,L=!0,Fe()}function Kt(O,N){T=w,b.locations&&(z=new ke),I=O,Fe(),E=N,L=O.beforeExpr}function Qn(){var O=b.onComment&&b.locations&&new ke,N=w,H=g.indexOf("*/",w+=2);if(H===-1&&W(w-2,"Unterminated comment"),w=H+2,b.locations){Be.lastIndex=N;for(var G;(G=Be.exec(g))&&G.index<w;)++D,B=G.index+G[0].length}b.onComment&&b.onComment(!0,g.slice(N+2,H),N,w,O,b.locations&&new ke)}function yi(){for(var O=w,N=b.onComment&&b.locations&&new ke,H=g.charCodeAt(w+=2);w<m&&H!==10&&H!==13&&H!==8232&&H!==8233;)++w,H=g.charCodeAt(w);b.onComment&&b.onComment(!1,g.slice(O+2,w),O,w,N,b.locations&&new ke)}function Fe(){for(;w<m;){var O=g.charCodeAt(w);if(O===32)++w;else if(O===13){++w;var N=g.charCodeAt(w);N===10&&++w,b.locations&&(++D,B=w)}else if(O===10||O===8232||O===8233)++w,b.locations&&(++D,B=w);else if(O>8&&O<14)++w;else if(O===47){var N=g.charCodeAt(w+1);if(N===42)Qn();else if(N===47)yi();else break}else if(O===160)++w;else if(O>=5760&&Kn.test(String.fromCharCode(O)))++w;else break}}function $n(){var O=g.charCodeAt(w+1);return O>=48&&O<=57?sn(!0):(++w,Kt(vi))}function tr(){var O=g.charCodeAt(w+1);return L?(++w,rn()):O===61?Jt(Me,2):Jt(mi,1)}function er(){var O=g.charCodeAt(w+1);return O===61?Jt(Me,2):Jt(Wn,1)}function ir(O){var N=g.charCodeAt(w+1);return N===O?Jt(O===124?Ki:Ji,2):N===61?Jt(Me,2):Jt(O===124?Bn:qn,1)}function nr(){var O=g.charCodeAt(w+1);return O===61?Jt(Me,2):Jt(Fn,1)}function rr(O){var N=g.charCodeAt(w+1);return N===O?N==45&&g.charCodeAt(w+2)==62&&ni.test(g.slice(j,w))?(w+=3,yi(),Fe(),Oe()):Jt(Dn,2):N===61?Jt(Me,2):Jt(Zn,1)}function sr(O){var N=g.charCodeAt(w+1),H=1;return N===O?(H=O===62&&g.charCodeAt(w+2)===62?3:2,g.charCodeAt(w+H)===61?Jt(Me,H+1):Jt(Un,H)):N==33&&O==60&&g.charCodeAt(w+2)==45&&g.charCodeAt(w+3)==45?(w+=4,yi(),Fe(),Oe()):(N===61&&(H=g.charCodeAt(w+2)===61?3:2),Jt(Hn,H))}function ar(O){var N=g.charCodeAt(w+1);return N===61?Jt(Vn,g.charCodeAt(w+2)===61?3:2):Jt(O===61?wi:Xi,1)}function ur(O){switch(O){case 46:return $n();case 40:return++w,Kt(me);case 41:return++w,Kt(de);case 59:return++w,Kt(we);case 44:return++w,Kt(be);case 91:return++w,Kt(ti);case 93:return++w,Kt(ei);case 123:return++w,Kt(Re);case 125:return++w,Kt(Te);case 58:return++w,Kt(De);case 63:return++w,Kt(pi);case 48:var N=g.charCodeAt(w+1);if(N===120||N===88)return or();case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return sn(!1);case 34:case 39:return lr(O);case 47:return tr();case 37:case 42:return er();case 124:case 38:return ir(O);case 94:return nr();case 43:case 45:return rr(O);case 60:case 62:return sr(O);case 61:case 33:return ar(O);case 126:return Jt(Xi,1)}return!1}function Oe(O){if(O?w=C+1:C=w,b.locations&&(M=new ke),O)return rn();if(w>=m)return Kt(_t);var N=g.charCodeAt(w);if(ri(N)||N===92)return un();var H=ur(N);if(H===!1){var G=String.fromCharCode(N);if(G==="\\"||tn.test(G))return un();W(w,"Unexpected character '"+G+"'")}return H}function Jt(O,N){var H=g.slice(w,w+N);w+=N,Kt(O,H)}function rn(){for(var ct="",O,N,H=w;;){w>=m&&W(H,"Unterminated regular expression");var G=g.charAt(w);if(ni.test(G)&&W(H,"Unterminated regular expression"),O)O=!1;else{if(G==="[")N=!0;else if(G==="]"&&N)N=!1;else if(G==="/"&&!N)break;O=G==="\\"}++w}var ct=g.slice(H,w);++w;var dt=an();dt&&!/^[gmsiy]*$/.test(dt)&&W(H,"Invalid regexp flag");try{var vt=new RegExp(ct,dt)}catch(Mt){Mt instanceof SyntaxError&&W(H,Mt.message),W(Mt)}return Kt(it,vt)}function He(O,N){for(var H=w,G=0,ct=0,dt=N??1/0;ct<dt;++ct){var vt=g.charCodeAt(w),Mt;if(vt>=97?Mt=vt-97+10:vt>=65?Mt=vt-65+10:vt>=48&&vt<=57?Mt=vt-48:Mt=1/0,Mt>=O)break;++w,G=G*O+Mt}return w===H||N!=null&&w-H!==N?null:G}function or(){w+=2;var O=He(16);return O==null&&W(C+2,"Expected hexadecimal number"),ri(g.charCodeAt(w))&&W(w,"Identifier directly after number"),Kt(rt,O)}function sn(O){var N=w,H=!1,G=g.charCodeAt(w)===48;!O&&He(10)===null&&W(N,"Invalid number"),g.charCodeAt(w)===46&&(++w,He(10),H=!0);var ct=g.charCodeAt(w);(ct===69||ct===101)&&(ct=g.charCodeAt(++w),(ct===43||ct===45)&&++w,He(10)===null&&W(N,"Invalid number"),H=!0),ri(g.charCodeAt(w))&&W(w,"Identifier directly after number");var dt=g.slice(N,w),vt;return H?vt=parseFloat(dt):!G||dt.length===1?vt=parseInt(dt,10):/[89]/.test(dt)||U?W(N,"Invalid number"):vt=parseInt(dt,8),Kt(rt,vt)}function lr(O){w++;for(var N="";;){w>=m&&W(C,"Unterminated string constant");var H=g.charCodeAt(w);if(H===O)return++w,Kt(ht,N);if(H===92){H=g.charCodeAt(++w);var G=/^[0-7]+/.exec(g.slice(w,w+3));for(G&&(G=G[0]);G&&parseInt(G,8)>255;)G=G.slice(0,-1);if(G==="0"&&(G=null),++w,G)U&&W(w-2,"Octal literal in strict mode"),N+=String.fromCharCode(parseInt(G,8)),w+=G.length-1;else switch(H){case 110:N+=`
`;break;case 114:N+="\r";break;case 120:N+=String.fromCharCode(si(2));break;case 117:N+=String.fromCharCode(si(4));break;case 85:N+=String.fromCharCode(si(8));break;case 116:N+="	";break;case 98:N+="\b";break;case 118:N+="\v";break;case 102:N+="\f";break;case 48:N+="\0";break;case 13:g.charCodeAt(w)===10&&++w;case 10:b.locations&&(B=w,++D);break;default:N+=String.fromCharCode(H);break}}else(H===13||H===10||H===8232||H===8233)&&W(C,"Unterminated string constant"),N+=String.fromCharCode(H),++w}}function si(O){var N=He(16,O);return N===null&&W(C,"Bad character escape sequence"),N}var qe;function an(){qe=!1;for(var O,N=!0,H=w;;){var G=g.charCodeAt(w);if(en(G))qe&&(O+=g.charAt(w)),++w;else if(G===92){qe||(O=g.slice(H,w)),qe=!0,g.charCodeAt(++w)!=117&&W(w,"Expecting Unicode escape sequence \\uXXXX"),++w;var ct=si(4),dt=String.fromCharCode(ct);dt||W(w-1,"Invalid Unicode escape"),(N?ri(ct):en(ct))||W(w-4,"Invalid Unicode escape"),O+=dt}else break;N=!1}return qe?O:g.slice(H,w)}function un(){var O=an(),N=ot;return!qe&&Xn(O)&&(N=_i[O]),Kt(N,O)}function It(){V=C,j=T,K=z,Oe()}function bi(O){if(U=O,w=C,b.locations)for(;w<B;)B=g.lastIndexOf(`
`,B-2)+1,--D;Fe(),Oe()}function on(){this.type=null,this.start=C,this.end=null}function ln(){this.start=M,this.end=null,h!==null&&(this.source=h)}function Qt(){var O=new on;return b.locations&&(O.loc=new ln),b.directSourceFile&&(O.sourceFile=b.directSourceFile),b.ranges&&(O.range=[C,0]),O}function Pe(O){var N=new on;return N.start=O.start,b.locations&&(N.loc=new ln,N.loc.start=O.loc.start),b.ranges&&(N.range=[O.range[0],0]),N}function yt(O,N){return O.type=N,O.end=j,b.locations&&(O.loc.end=K),b.ranges&&(O.range[1]=j),O}function Si(O){return b.ecmaVersion>=5&&O.type==="ExpressionStatement"&&O.expression.type==="Literal"&&O.expression.value==="use strict"}function Et(O){if(I===O)return It(),!0}function ai(){return!b.strictSemicolons&&(I===_t||I===Te||ni.test(g.slice(j,C)))}function Ae(){!Et(we)&&!ai()&&Se()}function Ft(O){I===O?It():Se()}function Se(){W(C,"Unexpected token")}function ui(O){O.type!=="Identifier"&&O.type!=="MemberExpression"&&W(O.start,"Assigning to rvalue"),U&&O.type==="Identifier"&&ii(O.name)&&W(O.start,"Assigning to "+O.name+" in strict mode")}function hr(O){V=j=w,b.locations&&(K=new ke),Q=U=null,et=[],Oe();var N=O||Qt(),H=!0;for(O||(N.body=[]);I!==_t;){var G=ge();N.body.push(G),H&&Si(G)&&bi(!0),H=!1}return yt(N,"Program")}var xi={kind:"loop"},fr={kind:"switch"};function ge(){(I===mi||I===Me&&E=="/=")&&Oe(!0);var O=I,N=Qt();switch(O){case wt:case Wt:It();var H=O===wt;Et(we)||ai()?N.label=null:I!==ot?Se():(N.label=Ie(),Ae());for(var G=0;G<et.length;++G){var ct=et[G];if((N.label==null||ct.name===N.label.name)&&(ct.kind!=null&&(H||ct.kind==="loop")||N.label&&H))break}return G===et.length&&W(N.start,"Unsyntactic "+O.keyword),yt(N,H?"BreakStatement":"ContinueStatement");case Yt:return It(),Ae(),yt(N,"DebuggerStatement");case At:return It(),et.push(xi),N.body=ge(),et.pop(),Ft(ce),N.test=Ue(),Ae(),yt(N,"DoWhileStatement");case Gt:if(It(),et.push(xi),Ft(me),I===we)return Ci(N,null);if(I===Ce){var dt=Qt();return It(),fn(dt,!0),yt(dt,"VariableDeclaration"),dt.declarations.length===1&&Et($e)?hn(N,dt):Ci(N,dt)}var dt=te(!1,!0);return Et($e)?(ui(dt),hn(N,dt)):Ci(N,dt);case le:return It(),ki(N,!0);case xe:return It(),N.test=Ue(),N.consequent=ge(),N.alternate=Et(Dt)?ge():null,yt(N,"IfStatement");case he:return!Q&&!b.allowReturnOutsideFunction&&W(C,"'return' outside of function"),It(),Et(we)||ai()?N.argument=null:(N.argument=te(),Ae()),yt(N,"ReturnStatement");case fe:It(),N.discriminant=Ue(),N.cases=[],Ft(Re),et.push(fr);for(var vt,Mt;I!=Te;)if(I===gt||I===Rt){var _e=I===gt;vt&&yt(vt,"SwitchCase"),N.cases.push(vt=Qt()),vt.consequent=[],It(),_e?vt.test=te():(Mt&&W(V,"Multiple default clauses"),Mt=!0,vt.test=null),Ft(De)}else vt||Se(),vt.consequent.push(ge());return vt&&yt(vt,"SwitchCase"),It(),et.pop(),yt(N,"SwitchStatement");case ae:return It(),ni.test(g.slice(j,C))&&W(j,"Illegal newline after throw"),N.argument=te(),Ae(),yt(N,"ThrowStatement");case ue:if(It(),N.block=Ze(),N.handler=null,I===Zt){var Ee=Qt();It(),Ft(me),Ee.param=Ie(),U&&ii(Ee.param.name)&&W(Ee.param.start,"Binding "+Ee.param.name+" in strict mode"),Ft(de),Ee.guard=null,Ee.body=Ze(),N.handler=yt(Ee,"CatchClause")}return N.guardedHandlers=$,N.finalizer=Et(se)?Ze():null,!N.handler&&!N.finalizer&&W(N.start,"Missing catch or finally clause"),yt(N,"TryStatement");case Ce:return It(),fn(N),Ae(),yt(N,"VariableDeclaration");case ce:return It(),N.test=Ue(),et.push(xi),N.body=ge(),et.pop(),yt(N,"WhileStatement");case Qe:return U&&W(C,"'with' in strict mode"),It(),N.object=Ue(),N.body=ge(),yt(N,"WithStatement");case Re:return Ze();case we:return It(),yt(N,"EmptyStatement");default:var Ai=E,oi=te();if(O===ot&&oi.type==="Identifier"&&Et(De)){for(var G=0;G<et.length;++G)et[G].name===Ai&&W(oi.start,"Label '"+Ai+"' is already declared");var pr=I.isLoop?"loop":I===fe?"switch":null;return et.push({name:Ai,kind:pr}),N.body=ge(),et.pop(),N.label=oi,yt(N,"LabeledStatement")}else return N.expression=oi,Ae(),yt(N,"ExpressionStatement")}}function Ue(){Ft(me);var O=te();return Ft(de),O}function Ze(O){var N=Qt(),H=!0,G=!1,ct;for(N.body=[],Ft(Re);!Et(Te);){var dt=ge();N.body.push(dt),H&&O&&Si(dt)&&(ct=G,bi(G=!0)),H=!1}return G&&!ct&&bi(!1),yt(N,"BlockStatement")}function Ci(O,N){return O.init=N,Ft(we),O.test=I===we?null:te(),Ft(we),O.update=I===de?null:te(),Ft(de),O.body=ge(),et.pop(),yt(O,"ForStatement")}function hn(O,N){return O.left=N,O.right=te(),Ft(de),O.body=ge(),et.pop(),yt(O,"ForInStatement")}function fn(O,N){for(O.declarations=[],O.kind="var";;){var H=Qt();if(H.id=Ie(),U&&ii(H.id.name)&&W(H.id.start,"Binding "+H.id.name+" in strict mode"),H.init=Et(wi)?te(!0,N):null,O.declarations.push(yt(H,"VariableDeclarator")),!Et(be))break}return O}function te(O,N){var H=Pi(N);if(!O&&I===be){var G=Pe(H);for(G.expressions=[H];Et(be);)G.expressions.push(Pi(N));return yt(G,"SequenceExpression")}return H}function Pi(O){var N=cr(O);if(I.isAssign){var H=Pe(N);return H.operator=E,H.left=N,It(),H.right=Pi(O),ui(N),yt(H,"AssignmentExpression")}return N}function cr(O){var N=dr(O);if(Et(pi)){var H=Pe(N);return H.test=N,H.consequent=te(!0),Ft(De),H.alternate=te(!0,O),yt(H,"ConditionalExpression")}return N}function dr(O){return Ii(Ti(),-1,O)}function Ii(O,N,H){var G=I.binop;if(G!=null&&(!H||I!==$e)&&G>N){var ct=Pe(O);ct.left=O,ct.operator=E;var dt=I;It(),ct.right=Ii(Ti(),G,H);var vt=yt(ct,dt===Ki||dt===Ji?"LogicalExpression":"BinaryExpression");return Ii(vt,N,H)}return O}function Ti(){if(I.prefix){var O=Qt(),N=I.isUpdate;return O.operator=E,O.prefix=!0,L=!0,It(),O.argument=Ti(),N?ui(O.argument):U&&O.operator==="delete"&&O.argument.type==="Identifier"&&W(O.start,"Deleting local variable in strict mode"),yt(O,N?"UpdateExpression":"UnaryExpression")}for(var H=gr();I.postfix&&!ai();){var O=Pe(H);O.operator=E,O.prefix=!1,O.argument=H,ui(H),It(),H=yt(O,"UpdateExpression")}return H}function gr(){return We(Mi())}function We(O,N){if(Et(vi)){var H=Pe(O);return H.object=O,H.property=Ie(!0),H.computed=!1,We(yt(H,"MemberExpression"),N)}else if(Et(ti)){var H=Pe(O);return H.object=O,H.property=te(),H.computed=!0,Ft(ei),We(yt(H,"MemberExpression"),N)}else if(!N&&Et(me)){var H=Pe(O);return H.callee=O,H.arguments=Oi(de,!1),We(yt(H,"CallExpression"),N)}else return O}function Mi(){switch(I){case Zi:var G=Qt();return It(),yt(G,"ThisExpression");case ot:return Ie();case rt:case ht:case it:var G=Qt();return G.value=E,G.raw=g.slice(C,T),It(),yt(G,"Literal");case Wi:case Gi:case ji:var G=Qt();return G.value=I.atomValue,G.raw=I.keyword,It(),yt(G,"Literal");case me:var O=M,N=C;It();var H=te();return H.start=N,H.end=T,b.locations&&(H.loc.start=O,H.loc.end=z),b.ranges&&(H.range=[N,T]),Ft(de),H;case ti:var G=Qt();return It(),G.elements=Oi(ei,!0,!0),yt(G,"ArrayExpression");case Re:return vr();case le:var G=Qt();return It(),ki(G,!1);case Ui:return _r();default:Se()}}function _r(){var O=Qt();return It(),O.callee=We(Mi(),!0),Et(me)?O.arguments=Oi(de,!1):O.arguments=$,yt(O,"NewExpression")}function vr(){var O=Qt(),N=!0,H=!1;for(O.properties=[],It();!Et(Te);){if(N)N=!1;else if(Ft(be),b.allowTrailingCommas&&Et(Te))break;var G={key:cn()},ct=!1,dt;if(Et(De)?(G.value=te(!0),dt=G.kind="init"):b.ecmaVersion>=5&&G.key.type==="Identifier"&&(G.key.name==="get"||G.key.name==="set")?(ct=H=!0,dt=G.kind=G.key.name,G.key=cn(),I!==me&&Se(),G.value=ki(Qt(),!1)):Se(),G.key.type==="Identifier"&&(U||H))for(var vt=0;vt<O.properties.length;++vt){var Mt=O.properties[vt];if(Mt.key.name===G.key.name){var _e=dt==Mt.kind||ct&&Mt.kind==="init"||dt==="init"&&(Mt.kind==="get"||Mt.kind==="set");_e&&!U&&dt==="init"&&Mt.kind==="init"&&(_e=!1),_e&&W(G.key.start,"Redefinition of property")}}O.properties.push(G)}return yt(O,"ObjectExpression")}function cn(){return I===rt||I===ht?Mi():Ie(!0)}function ki(O,N){I===ot?O.id=Ie():N?Se():O.id=null,O.params=[];var H=!0;for(Ft(me);!Et(de);)H?H=!1:Ft(be),O.params.push(Ie());var G=Q,ct=et;if(Q=!0,et=[],O.body=Ze(!0),Q=G,et=ct,U||O.body.body.length&&Si(O.body.body[0]))for(var dt=O.id?-1:0;dt<O.params.length;++dt){var vt=dt<0?O.id:O.params[dt];if((Qi(vt.name)||ii(vt.name))&&W(vt.start,"Defining '"+vt.name+"' in strict mode"),dt>=0)for(var Mt=0;Mt<dt;++Mt)vt.name===O.params[Mt].name&&W(vt.start,"Argument name clash in strict mode")}return yt(O,N?"FunctionDeclaration":"FunctionExpression")}function Oi(O,N,H){for(var G=[],ct=!0;!Et(O);){if(ct)ct=!1;else if(Ft(be),N&&b.allowTrailingCommas&&Et(O))break;H&&I===be?G.push(null):G.push(te(!0))}return G}function Ie(O){var N=Qt();return O&&b.forbidReserved=="everywhere"&&(O=!1),I===ot?(!O&&(b.forbidReserved&&(b.ecmaVersion===3?Gn:jn)(E)||U&&Qi(E))&&g.slice(C,T).indexOf("\\")==-1&&W(C,"The keyword '"+E+"' is reserved"),N.name=E):O&&I.keyword?N.name=I.keyword:Se(),L=!1,It(),yt(N,"Identifier")}}),e.version||(e=null)}function r(v,b){return(t.acorn||e).parse(v,b)}var s={"+":"__add","-":"__subtract","*":"__multiply","/":"__divide","%":"__modulo","==":"__equals","!=":"__equals"},u={"-":"__negate","+":"__self"},a=P.each(["add","subtract","multiply","divide","modulo","equals","negate"],function(v){this["__"+v]="#"+v},{__self:function(){return this}});R.inject(a),ut.inject(a),Vt.inject(a);function o(v,b,g){var m=s[b];if(v&&v[m]){var h=v[m](g);return b==="!="?!h:h}switch(b){case"+":return v+g;case"-":return v-g;case"*":return v*g;case"/":return v/g;case"%":return v%g;case"==":return v==g;case"!=":return v!=g}}function l(v,b){var g=u[v];if(b&&b[g])return b[g]();switch(v){case"+":return+b;case"-":return-b}}function d(v,b){if(!v)return"";b=b||{};var g=[];function m(U){for(var W=0,$=g.length;W<$;W++){var rt=g[W];if(rt[0]>=U)break;U+=rt[1]}return U}function h(U){return v.substring(m(U.range[0]),m(U.range[1]))}function p(U,W){return v.substring(m(U.range[1]),m(W.range[0]))}function S(U,W){for(var $=m(U.range[0]),rt=m(U.range[1]),it=0,ht=g.length-1;ht>=0;ht--)if($>g[ht][0]){it=ht+1;break}g.splice(it,0,[$,W.length-rt+$]),v=v.substring(0,$)+W+v.substring(rt)}function x(U,W){switch(U.type){case"UnaryExpression":if(U.operator in u&&U.argument.type!=="Literal"){var $=h(U.argument);S(U,'$__("'+U.operator+'", '+$+")")}break;case"BinaryExpression":if(U.operator in s&&U.left.type!=="Literal"){var rt=h(U.left),it=h(U.right),ht=p(U.left,U.right),ot=U.operator;S(U,"__$__("+rt+","+ht.replace(new RegExp("\\"+ot),'"'+ot+'"')+", "+it+")")}break;case"UpdateExpression":case"AssignmentExpression":var _t=W&&W.type;if(!(_t==="ForStatement"||_t==="BinaryExpression"&&/^[=!<>]/.test(W.operator)||_t==="MemberExpression"&&W.computed)){if(U.type==="UpdateExpression"){var $=h(U.argument),wt="__$__("+$+', "'+U.operator[0]+'", 1)',gt=$+" = "+wt;U.prefix?gt="("+gt+")":(_t==="AssignmentExpression"||_t==="VariableDeclarator"||_t==="BinaryExpression")&&(h(W.left||W.id)===$&&(gt=wt),gt=$+"; "+gt),S(U,gt)}else if(/^.=$/.test(U.operator)&&U.left.type!=="Literal"){var rt=h(U.left),it=h(U.right),wt=rt+" = __$__("+rt+', "'+U.operator[0]+'", '+it+")";S(U,/^\(.*\)$/.test(h(U))?"("+wt+")":wt)}}break}}function w(U){switch(U.type){case"ExportDefaultDeclaration":S({range:[U.start,U.declaration.start]},"module.exports = ");break;case"ExportNamedDeclaration":var W=U.declaration,$=U.specifiers;if(W){var rt=W.declarations;rt&&(rt.forEach(function(ht){S(ht,"module.exports."+h(ht))}),S({range:[U.start,W.start+W.kind.length]},""))}else if($){var it=$.map(function(ht){var ot=h(ht);return"module.exports."+ot+" = "+ot+"; "}).join("");it&&S(U,it)}break}}function C(U,W,$){if(U){for(var rt in U)if(rt!=="range"&&rt!=="loc"){var it=U[rt];if(Array.isArray(it))for(var ht=0,ot=it.length;ht<ot;ht++)C(it[ht],U,$);else it&&typeof it=="object"&&C(it,U,$)}$.operatorOverloading!==!1&&x(U,W),$.moduleExports!==!1&&w(U)}}function T(U){var W="",$="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(U=(Math.abs(U)<<1)+(U<0?1:0);U||!W;){var rt=U&31;U>>=5,U&&(rt|=32),W+=$[rt]}return W}var M=b.url||"",z=b.sourceMaps,I=b.paperFeatures||{},E=b.source||v,L=b.offset||0,D=bt.agent,B=D.versionNumber,V=!1,j=/\r\n|\n|\r/mg,K;if(z&&(D.chrome&&B>=30||D.webkit&&B>=537.76||D.firefox&&B>=23||D.node)){if(D.node)L-=2;else if(F&&M&&!F.location.href.indexOf(M)){var Q=q.getElementsByTagName("html")[0].innerHTML;L=Q.substr(0,Q.indexOf(v)+1).match(j).length+1}V=L>0&&!(D.chrome&&B>=36||D.safari&&B>=600||D.firefox&&B>=40||D.node);var et=["AA"+T(V?0:L)+"A"];et.length=(v.match(j)||[]).length+1+(V?L:0),K={version:3,file:M,names:[],mappings:et.join(";AACA"),sourceRoot:"",sources:[M],sourcesContent:[E]}}return(I.operatorOverloading!==!1||I.moduleExports!==!1)&&C(r(v,{ranges:!0,preserveParens:!0,sourceType:"module"}),null,I),K&&(V&&(v=new Array(L+1).join(`
`)+v),/^(inline|both)$/.test(z)&&(v+=`
//# sourceMappingURL=data:application/json;base64,`+A.btoa(unescape(encodeURIComponent(JSON.stringify(K))))),v+=`
//# sourceURL=`+(M||"paperscript")),{url:M,source:E,code:v,map:K}}function _(v,b,g){bt=b;var m=b.getView(),h=/\btool\.\w+|\s+on(?:Key|Mouse)(?:Up|Down|Move|Drag)\b/.test(v)&&!/\bnew\s+Tool\b/.test(v)?new Nn:null,p=h?h._events:[],S=["onFrame","onResize"].concat(p),x=[],w=[],C,T=typeof v=="object"?v:d(v,g);v=T.code;function M(B,V){for(var j in B)(V||!/^_/.test(j))&&new RegExp("([\\b\\s\\W]|^)"+j.replace(/\$/g,"\\$")+"\\b").test(v)&&(x.push(j),w.push(B[j]))}M({__$__:o,$__:l,paper:b,tool:h},!0),M(b),v="var module = { exports: {} }; "+v;var L=P.each(S,function(B){new RegExp("\\s+"+B+"\\b").test(v)&&(x.push(B),this.push("module.exports."+B+" = "+B+";"))},[]).join(`
`);L&&(v+=`
`+L),v+=`
return module.exports;`;var z=bt.agent;if(q&&(z.chrome||z.firefox&&z.versionNumber<40)){var I=q.createElement("script"),E=q.head||q.getElementsByTagName("head")[0];z.firefox&&(v=`
`+v),I.appendChild(q.createTextNode("document.__paperscript__ = function("+x+") {"+v+`
}`)),E.appendChild(I),C=q.__paperscript__,delete q.__paperscript__,E.removeChild(I)}else C=Function(x,v);var L=C&&C.apply(b,w),D=L||{};return P.each(p,function(B){var V=D[B];V&&(h[B]=V)}),m&&(D.onResize&&m.setOnResize(D.onResize),m.emit("resize",{size:m.size,delta:new R}),D.onFrame&&m.setOnFrame(D.onFrame),m.requestUpdate()),L}function c(v){if(/^text\/(?:x-|)paperscript$/.test(v.type)&&kt.getAttribute(v,"ignore")!=="true"){var b=kt.getAttribute(v,"canvas"),g=q.getElementById(b),m=v.src||v.getAttribute("data-src"),h=kt.hasAttribute(v,"async"),p="data-paper-scope";if(!g)throw new Error('Unable to find canvas with id "'+b+'"');var S=kt.get(g.getAttribute(p))||new kt().setup(g);return g.setAttribute(p,S._id),m?Vi.request({url:m,async:h,mimeType:"text/plain",onLoad:function(x){_(x,S,m)}}):_(v.innerHTML,S,v.baseURI),v.setAttribute("data-paper-ignore","true"),S}}function f(){P.each(q&&q.getElementsByTagName("script"),c)}function y(v){return v?c(v):f()}return F&&(q.readyState==="complete"?setTimeout(f):Ht.add(F,{load:f})),{compile:d,execute:_,load:y,parse:r,calculateBinary:o,calculateUnary:l}}).call(this);var bt=new(kt.inject(P.exports,{Base:P,Numerical:St,Key:qi,DomEvent:Ht,DomElement:Lt,document:q,window:F,Symbol:xt,PlacedSymbol:lt}));return bt.agent.node&&dn(bt),typeof k=="function"&&k.amd?k("paper",bt):Z&&(Z.exports=bt),bt}).call(Cr,typeof self=="object"?self:null)}(hi)),hi.exports}var Ir=Pr();const nt=Sn(Ir);function _n(Z){return Z>.1?1:Z<-.1?-1:0}function Tr(Z){return new nt.Point(_n(Z.x),_n(Z.y))}function fi(Z){return Z.multiply(2).round().multiply(.5)}function Mr(Z){return Math.abs(Z-Math.round(Z))<.01?Math.round(Z):Math.ceil(Z)}function kr(Z){return new nt.Point(Math.abs(Z.x-Math.round(Z.x))<.01?Math.round(Z.x):Math.floor(Z.x),Math.abs(Z.y-Math.round(Z.y))<.01?Math.round(Z.y):Math.floor(Z.y))}function Or(Z){return new nt.Point(Math.abs(Z.x-Math.round(Z.x))<.01?Math.round(Z.x):Math.ceil(Z.x),Math.abs(Z.y-Math.round(Z.y))<.01?Math.round(Z.y):Math.ceil(Z.y))}function xn(Z){return Number.isInteger(Z.x)&&Number.isInteger(Z.y)}function Ar(Z){return Number.isInteger(Z.x*2)&&Number.isInteger(Z.y*2)}const qt={N:"N",E:"E",S:"S",W:"W"},Ei=[qt.N,qt.E,qt.S,qt.W];function li(Z,A,k=.1){return Math.abs(Z-A)<k}const Ge={Shape:"Shape",Background:"Background"};class vn{constructor(A=null){Tt(this,"states",new Map);for(const k of Ei)this.states.set(k,A)}static makePolygon(A){const k=new nt.Path([new nt.Point(0,0),new nt.Point(1,0),new nt.Point(.5,.5)]);return k.closed=!0,k.rotate({[qt.N]:0,[qt.E]:90,[qt.S]:180,[qt.W]:270}[A],new nt.Point(.5,.5)),k}}function Er(Z){if(xn(Z))return"corners";if(Ar(Z))return"midpoints";throw new Error(`Vertex (${Z.x}, ${Z.y}) is not a valid vertex of the lattice. It must be either a cell coordinate or a half-integer coordinate.`)}class Xe{constructor(A,k,F=null){Tt(this,"cells");this.cells=this.createEmptyGrid(A,k,F)}get width(){return this.cells.length}get height(){return this.cells[0].length}createEmptyGrid(A,k,F){const q=[];for(let P=0;P<A;P++){const pt=[];for(let kt=0;kt<k;kt++)pt.push(new vn(F));q.push(pt)}return q}getState(A){if(!xn(A.cell))throw new Error(`Cell coordinates must be integers, given (${A.cell.x}, ${A.cell.y})`);return this.cells[A.cell.x][A.cell.y].states.get(A.cardinalDirection)}setState(A,k){this.cells[A.cell.x][A.cell.y].states.set(A.cardinalDirection,k)}makeTrianglePolygon(A){let k=vn.makePolygon(A.cardinalDirection);return k.translate(new nt.Point(A.cell.x,A.cell.y)),k}vertexNeighbors(A){let k=[];if(Er(A)==="midpoints")for(let q of Ei)k.push({cell:new nt.Point(A.x-.5,A.y-.5),cardinalDirection:q});else A.x>0&&(A.y>0&&(k.push({cell:new nt.Point(A.x-1,A.y-1),cardinalDirection:qt.S}),k.push({cell:new nt.Point(A.x-1,A.y-1),cardinalDirection:qt.E})),A.y<this.height&&(k.push({cell:new nt.Point(A.x-1,A.y),cardinalDirection:qt.N}),k.push({cell:new nt.Point(A.x-1,A.y),cardinalDirection:qt.E}))),A.x<this.width&&(A.y>0&&(k.push({cell:new nt.Point(A.x,A.y-1),cardinalDirection:qt.S}),k.push({cell:new nt.Point(A.x,A.y-1),cardinalDirection:qt.W})),A.y<this.height&&(k.push({cell:new nt.Point(A.x,A.y),cardinalDirection:qt.N}),k.push({cell:new nt.Point(A.x,A.y),cardinalDirection:qt.W})));let F=k.map(q=>({cell:q.cell.round(),cardinalDirection:q.cardinalDirection}));for(let q of F){let P=q.cell;if(!(P.x>=0&&P.x<this.width&&P.y>=0&&P.y<this.height))throw new Error(`Failed to produce cell index within valid bounds (${P.x}, ${P.y})`)}return F}scanStatesAroundVertex(A){let k=new Set;for(let F of this.vertexNeighbors(A)){let q=this.getState(F);k.add(q)}return Array.from(k)}vertexIsClear(A){let k=this.scanStatesAroundVertex(A);for(let F of k)if(typeof F=="number")return!1;return!0}lineIsAvailable(A,k){let F=k.subtract(A),q=Tr(F);q.x!=0&&q.y!=0&&(q=q.multiply(.5));for(let P=0;P<Math.round(F.length/q.length);P++){let pt=A.add(q.multiply(P));if(!this.vertexIsClear(pt))return!1}return!0}allVertices(){let A=[];for(let k=0;k<this.height;k++)for(let F=0;F<this.width;F++)F==0&&k==0&&A.push(new nt.Point(F,k)),k==0&&A.push(new nt.Point(F+1,k)),F==0&&A.push(new nt.Point(F,k+1)),A.push(new nt.Point(F+1,k+1)),A.push(new nt.Point(F+.5,k+.5));return A}isPerimeterVertex(A){return li(A.x,0)||li(A.x,this.width)||li(A.y,0)||li(A.y,this.height)}static rasterizePatch(A,k){let F=new Xe(A.x,A.y,null);for(let q of F.allTriangleIndices()){const P=Xe.centroid(q);k.contains(P)&&F.cells[q.cell.x][q.cell.y].states.set(q.cardinalDirection,Ge.Shape)}return F}allTriangleIndices(){let A=[];for(let k=0;k<this.width;k++)for(let F=0;F<this.height;F++){const q=new nt.Point(k,F);for(const P of Ei)A.push({cell:q,cardinalDirection:P})}return A}static centroid(A){let k=new nt.Point(0,-.3333333333333333),F={[qt.N]:0,[qt.E]:90,[qt.S]:180,[qt.W]:270}[A.cardinalDirection],q=k.rotate(F,new nt.Point(0,0));return A.cell.add(new nt.Point(.5,.5)).add(q)}}class ye{constructor(A,k){Tt(this,"width");Tt(this,"height");Tt(this,"nextShapeId",0);Tt(this,"lattice");Tt(this,"shapes",new Map);this.width=A,this.height=k,this.lattice=new Xe(A,k,Ge.Background)}static snapToNearestVertex(A){let q=A.rotate(-45,new nt.Point(0,0)).multiply(Math.sqrt(2)).round().rotate(45,new nt.Point(0,0)).multiply(1/Math.sqrt(2));return fi(q)}static validSquareRays(A){let k=[];if(A.x%1==0&&A.y%1==0)k.push(new nt.Point(2,0)),k.push(new nt.Point(1,1));else if(A.x%.5==0&&A.y%.5==0)k.push(new nt.Point(1,0));else throw new Error(`Invalid vertex provided (${A.x}, ${A.y})`);let F=[];for(let q of[0,90,180,270])for(let P of k)F.push(P.rotate(q,new nt.Point(0,0)));return F}vertexIsInBounds(A){return A.x>=-.01&&A.x<=this.width+.01&&A.y>=-.01&&A.y<=this.height+.01}static rasterize(A){let k=A.bounds,F=kr(k.topLeft),q=Or(k.bottomRight);if([F.x,F.y,q.x,q.y].some(kt=>kt%1>.1))throw new Error("Polygon is not aligned to the grid");let P=A.clone();P.translate(F.multiply(-1));let pt=q.add(F.multiply(-1));return{offset:F,lattice:Xe.rasterizePatch(pt,P)}}applyPatch(A,k){for(let F of A.lattice.allTriangleIndices())A.lattice.getState(F)==Ge.Shape&&this.lattice.setState({cell:F.cell.add(A.offset),cardinalDirection:F.cardinalDirection},k)}pathInBounds(A){return A.segments.every(k=>this.vertexIsInBounds(k.point))}pathClear(A){let k=ye.rasterize(A),F=this.scanStatesUnderPatch(k);for(let q of F)if(q!=Ge.Background)return!1;return!0}static walkAlongLine(A,k){let F=[],q=k.subtract(A),P=Math.abs(q.x)<.1||Math.abs(q.y)<.1?1:Math.sqrt(2)/2,pt=q.normalize().multiply(P),kt=Mr(q.length/P);for(let jt=0;jt<=kt;jt++){let oe=fi(A.add(pt.multiply(jt)));F.push(oe)}return F}static walkAlongPath(A){let k=[],F=A.segments[A.segments.length-1].point;for(let q of A.segments){let P=ye.walkAlongLine(F,q.point);k.push(...P.slice(0,P.length-1)),F=q.point}return k}perimeterIsClear(A){let k=ye.walkAlongPath(A);for(let F of k)for(let q of this.lattice.scanStatesAroundVertex(F))if(typeof q=="number")return!1;return!0}scanStatesUnderPatch(A){let k=new Set;for(let F of A.lattice.allTriangleIndices())if(A.lattice.getState(F)==Ge.Shape){let P=this.lattice.getState({cell:F.cell.add(A.offset),cardinalDirection:F.cardinalDirection});k.add(P)}return Array.from(k)}newShape(A){const k=this.nextShapeId;this.nextShapeId++;let F=A.clone();this.shapes.set(k,F);let q=ye.rasterize(F);return this.applyPatch(q,k),k}}function zr(Z){return(-Math.cos(Z*Math.PI)+1)/2}function Lr(Z){return Z<1/2.75?7.5625*Z*Z:Z<2/2.75?7.5625*(Z-=1.5/2.75)*Z+.75:Z<2.5/2.75?7.5625*(Z-=2.25/2.75)*Z+.9375:7.5625*(Z-=2.625/2.75)*Z+.984375}function Cn(Z,A){const k=[];function F(q,P){const pt=Z-q,kt=A-P,jt=Math.min(pt,kt);return new nt.Point(q+jt,P+jt)}for(let q=1;q<A;q++)k.push([new nt.Point(0,q),F(0,q)]);for(let q=0;q<Z;q++)k.push([new nt.Point(q,0),F(q,0)]);return k}function Nr(Z,A){return Cn(A,Z).map(F=>F.map(q=>q.rotate(90,new nt.Point(0,0)).add(new nt.Point(Z,0))))}function Rr(Z,A){return Cn(Z,A).concat(Nr(Z,A))}function zi(Z,A){let k=A.subtract(Z),F=Z.add(k.multiply(.5));return{start:Z,hinges:[fi(F.add(k.multiply(.5).rotate(90,new nt.Point(0,0)))),fi(F.add(k.multiply(.5).rotate(-90,new nt.Point(0,0))))],end:A}}function Li(Z){let A=new nt.Path;return A.add(Z.start),A.add(Z.hinges[0]),A.add(Z.end),A.add(Z.hinges[1]),A.closed=!0,A}var je={exports:{}},Dr=je.exports,pn;function Br(){return pn||(pn=1,function(Z,A){(function(k,F){{var q=F();Z&&Z.exports&&(A=Z.exports=q),A.randomColor=q}})(Dr,function(){var k=null,F={};ft();var q=[],P=function(X){if(X=X||{},X.seed!==void 0&&X.seed!==null&&X.seed===parseInt(X.seed,10))k=X.seed;else if(typeof X.seed=="string")k=Ne(X.seed);else{if(X.seed!==void 0&&X.seed!==null)throw new TypeError("The seed value must be an integer or string");k=null}var tt,Y,st;if(X.count!==null&&X.count!==void 0){for(var lt=X.count,xt=[],Ct=0;Ct<X.count;Ct++)q.push(!1);for(X.count=null;lt>xt.length;){var at=P(X);k!==null&&(X.seed=k),xt.push(at)}return X.count=lt,xt}return tt=pt(X),Y=kt(tt,X),st=jt(tt,Y,X),oe([tt,Y,st],X)};function pt(X){if(q.length>0){var tt=mt(X.hue),Y=ee(tt),st=(tt[1]-tt[0])/q.length,lt=parseInt((Y-tt[0])/st);q[lt]===!0?lt=(lt+2)%q.length:q[lt]=!0;var xt=(tt[0]+lt*st)%359,Ct=(tt[0]+(lt+1)*st)%359;return tt=[xt,Ct],Y=ee(tt),Y<0&&(Y=360+Y),Y}else{var tt=St(X.hue);return Y=ee(tt),Y<0&&(Y=360+Y),Y}}function kt(X,tt){if(tt.hue==="monochrome")return 0;if(tt.luminosity==="random")return ee([0,100]);var Y=ze(X),st=Y[0],lt=Y[1];switch(tt.luminosity){case"bright":st=55;break;case"dark":st=lt-10;break;case"light":lt=55;break}return ee([st,lt])}function jt(X,tt,Y){var st=$t(X,tt),lt=100;switch(Y.luminosity){case"dark":lt=st+20;break;case"light":st=(lt+st)/2;break;case"random":st=0,lt=100;break}return ee([st,lt])}function oe(X,tt){switch(tt.format){case"hsvArray":return X;case"hslArray":return Bt(X);case"hsl":var Y=Bt(X);return"hsl("+Y[0]+", "+Y[1]+"%, "+Y[2]+"%)";case"hsla":var st=Bt(X),Ct=tt.alpha||Math.random();return"hsla("+st[0]+", "+st[1]+"%, "+st[2]+"%, "+Ct+")";case"rgbArray":return Le(X);case"rgb":var lt=Le(X);return"rgb("+lt.join(", ")+")";case"rgba":var xt=Le(X),Ct=tt.alpha||Math.random();return"rgba("+xt.join(", ")+", "+Ct+")";default:return ut(X)}}function $t(X,tt){for(var Y=R(X).lowerBounds,st=0;st<Y.length-1;st++){var lt=Y[st][0],xt=Y[st][1],Ct=Y[st+1][0],at=Y[st+1][1];if(tt>=lt&&tt<=Ct){var ve=(at-xt)/(Ct-lt),J=xt-ve*lt;return ve*tt+J}}return 0}function St(X){if(typeof parseInt(X)=="number"){var tt=parseInt(X);if(tt<360&&tt>0)return[tt,tt]}if(typeof X=="string"){if(F[X]){var Y=F[X];if(Y.hueRange)return Y.hueRange}else if(X.match(/^#?([0-9A-F]{3}|[0-9A-F]{6})$/i)){var st=Ot(X)[0];return[st,st]}}return[0,360]}function ze(X){return R(X).saturationRange}function R(X){X>=334&&X<=360&&(X-=360);for(var tt in F){var Y=F[tt];if(Y.hueRange&&X>=Y.hueRange[0]&&X<=Y.hueRange[1])return F[tt]}return"Color not found"}function ee(X){if(k===null){var tt=.618033988749895,Y=Math.random();return Y+=tt,Y%=1,Math.floor(X[0]+Y*(X[1]+1-X[0]))}else{var st=X[1]||1,lt=X[0]||0;k=(k*9301+49297)%233280;var xt=k/233280;return Math.floor(lt+xt*(st-lt))}}function ut(X){var tt=Le(X);function Y(lt){var xt=lt.toString(16);return xt.length==1?"0"+xt:xt}var st="#"+Y(tt[0])+Y(tt[1])+Y(tt[2]);return st}function ne(X,tt,Y){var st=Y[0][0],lt=Y[Y.length-1][0],xt=Y[Y.length-1][1],Ct=Y[0][1];F[X]={hueRange:tt,lowerBounds:Y,saturationRange:[st,lt],brightnessRange:[xt,Ct]}}function ft(){ne("monochrome",null,[[0,0],[100,0]]),ne("red",[-26,18],[[20,100],[30,92],[40,89],[50,85],[60,78],[70,70],[80,60],[90,55],[100,50]]),ne("orange",[18,46],[[20,100],[30,93],[40,88],[50,86],[60,85],[70,70],[100,70]]),ne("yellow",[46,62],[[25,100],[40,94],[50,89],[60,86],[70,84],[80,82],[90,80],[100,75]]),ne("green",[62,178],[[30,100],[40,90],[50,85],[60,81],[70,74],[80,64],[90,50],[100,40]]),ne("blue",[178,257],[[20,100],[30,86],[40,80],[50,74],[60,60],[70,52],[80,44],[90,39],[100,35]]),ne("purple",[257,282],[[20,100],[30,87],[40,79],[50,70],[60,65],[70,59],[80,52],[90,45],[100,42]]),ne("pink",[282,334],[[20,100],[30,90],[40,86],[60,84],[80,80],[90,75],[100,73]])}function Le(X){var tt=X[0];tt===0&&(tt=1),tt===360&&(tt=359),tt=tt/360;var Y=X[1]/100,st=X[2]/100,lt=Math.floor(tt*6),xt=tt*6-lt,Ct=st*(1-Y),at=st*(1-xt*Y),ve=st*(1-(1-xt)*Y),J=256,Xt=256,re=256;switch(lt){case 0:J=st,Xt=ve,re=Ct;break;case 1:J=at,Xt=st,re=Ct;break;case 2:J=Ct,Xt=st,re=ve;break;case 3:J=Ct,Xt=at,re=st;break;case 4:J=ve,Xt=Ct,re=st;break;case 5:J=st,Xt=Ct,re=at;break}var Pt=[Math.floor(J*255),Math.floor(Xt*255),Math.floor(re*255)];return Pt}function Ot(X){X=X.replace(/^#/,""),X=X.length===3?X.replace(/(.)/g,"$1$1"):X;var tt=parseInt(X.substr(0,2),16)/255,Y=parseInt(X.substr(2,2),16)/255,st=parseInt(X.substr(4,2),16)/255,lt=Math.max(tt,Y,st),xt=lt-Math.min(tt,Y,st),Ct=lt?xt/lt:0;switch(lt){case tt:return[60*((Y-st)/xt%6)||0,Ct,lt];case Y:return[60*((st-tt)/xt+2)||0,Ct,lt];case st:return[60*((tt-Y)/xt+4)||0,Ct,lt]}}function Bt(X){var tt=X[0],Y=X[1]/100,st=X[2]/100,lt=(2-Y)*st;return[tt,Math.round(Y*st/(lt<1?lt:2-lt)*1e4)/100,lt/2*100]}function Ne(X){for(var tt=0,Y=0;Y!==X.length&&!(tt>=Number.MAX_SAFE_INTEGER);Y++)tt+=X.charCodeAt(Y);return tt}function mt(X){if(isNaN(X)){if(typeof X=="string"){if(F[X]){var Y=F[X];if(Y.hueRange)return Y.hueRange}else if(X.match(/^#?([0-9A-F]{3}|[0-9A-F]{6})$/i)){var st=Ot(X)[0];return R(st).hueRange}}}else{var tt=parseInt(X);if(tt<360&&tt>0)return R(X).hueRange}return[0,360]}return P})}(je,je.exports)),je.exports}var Fr=Br();const qr=Sn(Fr);function mn(Z){return Z[Math.floor(Z.length*Math.random())]}const Vr=new nt.Color(.95,.95,.95),Hr=.05,wn=new nt.Color(.8,.8,.8),yn=.065;class Ur{constructor(A,k,F,q,P,pt,kt){Tt(this,"start");Tt(this,"end");Tt(this,"startColor");Tt(this,"endColor");Tt(this,"flap");Tt(this,"tip");Tt(this,"t");Tt(this,"duration");this.start=A,this.end=k,this.startColor=F,this.endColor=q,this.flap=P,this.tip=pt,this.t=0,this.duration=kt}get progress(){return this.t/this.duration}onFrame(){let A=Lr(zr(this.progress));this.tip.point=this.start.add(this.end.subtract(this.start).multiply(A)),A<.5?this.flap.fillColor=this.startColor:this.flap.fillColor=this.endColor}onDone(){}}function Zr(Z,A){return Math.floor(Math.random()*(A-Z+1))+Z}class Wr{constructor(A,k){Tt(this,"processes",[]);Tt(this,"board");Tt(this,"gameLayer");Tt(this,"lastTick",0);Tt(this,"tickInterval",1/60);Tt(this,"latticeTriangles",[]);this.board=A,this.gameLayer=k}onFrame(A){for(;this.lastTick<A.time;)this.lastTick+=this.tickInterval,this.onTick();for(let k=0;k<this.processes.length;k++){let F=this.processes[k];if(F.t+=A.delta,F.onFrame(),F.progress>1){F.onDone(),this.processes.splice(k,1),k--;continue}}}randomlyRainSomewhere(){for(let A=0;A<10;A++){let k=mn(this.board.lattice.allVertices()),F=ye.validSquareRays(k),q=k.add(mn(F).multiply(Zr(1,10))),P=zi(k,q),pt=Li(P);if(this.board.pathInBounds(pt)&&this.board.pathClear(pt)&&this.board.perimeterIsClear(pt)){this.unfold(P);return}}}onTick(){Math.random()<.01&&this.randomlyRainSomewhere()}unfold(A){let k=new nt.Color(qr({luminosity:"light"})),F=new nt.Path;F.fillColor=k,F.add(A.start),F.add(A.hinges[0]),F.add(A.hinges[1]),F.closed=!0;let q=new nt.Path;q.fillColor=new nt.Color(1,1,1),q.add(A.start),q.add(A.hinges[0]),q.add(A.hinges[1]),q.closed=!0;let P=Li(A);this.board.newShape(P);for(let pt of this.latticeTriangles)pt.remove();this.processes.push(new Ur(A.start,A.end,new nt.Color(1,1,1),k,q,q.segments[0],A.end.subtract(A.start).length))}drawGrid(A){let k=[];for(let F=0;F<=A.height;F++)k.push([new nt.Point(0,F),new nt.Point(A.width,F)]);for(let F=0;F<=A.width;F++)k.push([new nt.Point(F,0),new nt.Point(F,A.height)]);for(let F of Rr(A.width,A.height))k.push(F);for(let F of k){let q=new nt.Path;q.moveTo(F[0]),q.lineTo(F[1]),q.strokeColor=Vr,q.strokeWidth=Hr,this.gameLayer.addChild(q)}for(let F=0;F<=A.width;F++)for(let q=0;q<=A.height;q++){let P=new nt.Point(F,q),pt=new nt.Path.Circle(P,yn);pt.fillColor=wn,this.gameLayer.addChild(pt)}for(let F=0;F<A.width;F++)for(let q=0;q<A.height;q++){let P=new nt.Point(F+.5,q+.5),pt=new nt.Path.Circle(P,yn);pt.fillColor=wn,this.gameLayer.addChild(pt)}}}function bn(Z){return Z.x*Z.x+Z.y*Z.y}function Gr(Z,A){const k=Z.normalize(),F=A.dot(k);if(F<=0)return bn(A);const q=k.multiply(F),P=A.subtract(q);return bn(P)}function jr(Z,A){let k=-1,F=1/0;return Z.forEach((q,P)=>{const pt=Gr(q,A);pt<F&&(F=pt,k=P)}),k}class Xr{constructor(A,k,F,q,P,pt){Tt(this,"gridSelectionDot");Tt(this,"dragSquare");Tt(this,"lastGridDrag",null);Tt(this,"currentTool","unfold");Tt(this,"game");Tt(this,"board");Tt(this,"view");Tt(this,"latticeVisualisation",new nt.Group);Tt(this,"panButton");Tt(this,"foldButton");this.game=k,this.board=A,this.view=q,this.gridSelectionDot=new nt.Path.Circle(new nt.Point(0,0),.15),this.gridSelectionDot.strokeWidth=.05,this.gridSelectionDot.strokeColor=new nt.Color(.5,.5,.5),this.gridSelectionDot.visible=!1,F.addChild(this.gridSelectionDot),this.dragSquare=new nt.Path,this.dragSquare.fillColor=new nt.Color(.5,.5,.5),this.dragSquare.opacity=.5,this.dragSquare.strokeWidth=0,this.dragSquare.visible=!1,F.addChild(this.dragSquare),this.panButton=P,this.foldButton=pt,this.setTool("unfold")}onPanButtonClick(){this.setTool("pan")}onFoldButtonClick(){this.setTool("unfold")}setTool(A){this.currentTool=A,A=="pan"?(this.panButton.classList.add("selected"),this.foldButton.classList.remove("selected")):A=="unfold"&&(this.foldButton.classList.add("selected"),this.panButton.classList.remove("selected"))}onKeyDown(A){A.key=="1"?this.setTool("pan"):A.key=="2"&&this.setTool("unfold")}centerView(){let A=new nt.Point(this.board.width-1,this.board.height-1);this.view.center=A.multiply(.5)}hideUnfoldPreview(){this.dragSquare.visible=!1,this.dragSquare.removeSegments()}onMouseDrag(A){if(this.currentTool=="pan"){let k=A.point.subtract(A.downPoint);this.view.center=this.view.center.subtract(k)}else if(this.currentTool=="unfold"){this.dragSquare.visible=!1,this.gridSelectionDot.visible=!1;let k=ye.snapToNearestVertex(A.downPoint);if(!this.board.vertexIsInBounds(k)||!this.board.lattice.vertexIsClear(k))return;let F=ye.validSquareRays(k),q=A.point.subtract(k),P=F[jr(F,q)],pt=k.add(P);this.lastGridDrag=[k,pt];let kt=zi(k,pt);this.dragSquare.visible=!0;let jt=Li(kt);this.dragSquare.removeSegments();for(let oe of jt.segments)this.dragSquare.add(oe)}}onWheel(A){let k=this.view.zoom,F=this.view.zoom;A.deltaY>0?k=this.view.zoom*.8:k=this.view.zoom*1.2;let q=F/k,P=new nt.Point(A.offsetX,A.offsetY),kt=this.view.viewToProject(P),jt=this.view.center,oe=kt.subtract(jt),$t=kt.subtract(oe.multiply(q)).subtract(jt);this.view.zoom=k,this.view.center=this.view.center.add($t),A.preventDefault()}onMouseUp(A){if(this.currentTool=="unfold"){if(this.gridSelectionDot.visible=!0,this.lastGridDrag==null)return;let[k,F]=this.lastGridDrag,q=zi(k,F);this.dragSquare.visible=!1,this.game.unfold(q),this.latticeVisualisation.removeChildren().map(P=>{P.remove()}),this.lastGridDrag=null}}onMouseMove(A){if(this.currentTool!="unfold")return;let k=ye.snapToNearestVertex(A.point);this.gridSelectionDot.visible=!1,this.board.vertexIsInBounds(k)&&this.board.lattice.vertexIsClear(k)&&(this.gridSelectionDot.position=k,this.gridSelectionDot.visible=!0)}}const Pn=document.getElementById("canvas");nt.setup(Pn);let In=new nt.Layer;In.name="board";let Tn=new nt.Layer;Tn.name="ui";let Mn=new ye(10,10),Ni=new Wr(Mn,In),Ri=new nt.Tool,Di=document.getElementById("panButton");if(!Di)throw new Error("Pan button not found");let Bi=document.getElementById("foldButton");if(!Bi)throw new Error("Fold button not found");let ie=new Xr(Mn,Ni,Tn,nt.view,Di,Bi);Ri.onMouseDrag=ie.onMouseDrag.bind(ie);Ri.onMouseUp=ie.onMouseUp.bind(ie);Ri.onMouseMove=ie.onMouseMove.bind(ie);Di.addEventListener("click",ie.onPanButtonClick.bind(ie));Bi.addEventListener("click",ie.onFoldButtonClick.bind(ie));document.addEventListener("keydown",ie.onKeyDown.bind(ie));Pn.addEventListener("wheel",ie.onWheel.bind(ie));nt.view.zoom=50;nt.view.onFrame=Ni.onFrame.bind(Ni);ie.centerView();
